<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>虚静以宁</title>
    <!-- FIX: 添加一个默认的 favicon 防止 404 错误 -->
    <link rel="icon" href="data:image/x-icon;base64,iVBORw0KGgo=">

    <!-- 预连接到关键的CDN域，以加快后续资源加载速度 -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link rel="preconnect" href="https://cdnjs.cloudflare.com" />
    <link rel="preconnect" href="https://cdn.jsdelivr.net" />
    <link rel="preconnect" href="https://unpkg.com" />

    <!-- 引入外部字体 -->
    <link href="https://fonts.googleapis.com/css2?family=ZCOOL+KuaiLe&display=swap" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap"
        rel="stylesheet" />

    <!-- APlayer 和 KaTeX 的 CSS 样式表，这些是渲染页面必需的，保留在 head 中 -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/aplayer/1.10.1/APlayer.min.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">

    <!-- Vue.js 必须在应用脚本之前加载 -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.prod.js"></script>

    <style>
        /* --- 全局样式重置和基础设定 --- */
        :root {
            --body-bg-color: #121212;
            --glass-bg: rgba(38, 38, 38, 0.25);
            --glass-border-color: rgba(255, 255, 255, 0.1);
            --input-bg: rgba(50, 50, 50, 0.2);
            --text-color: #f0f0f0;
            --text-color-darker: #b3b3b3;
            --text-color-white: #ffffff;
            --accent-color: #61dafb;
            --accent-color-rgb: 97, 218, 251;
            --shadow-color: rgba(0, 0, 0, 0.25);
            --glow-color: rgba(var(--accent-color-rgb), 0.1);
            --subscribe-btn-bg: #3b82f6;
            --theme-switcher-bg: rgba(0, 0, 0, 0.3);
            --repo-card-bg: rgba(255, 255, 255, 0.05);
            --repo-card-hover-bg: rgba(255, 255, 255, 0.1);
            --error-color: #ef4444;
            --success-color: #22c55e;
        }

        html.light-theme {
            --body-bg-color: #f5f5f7;
            --glass-bg: rgba(242, 242, 247, 0.3);
            --glass-border-color: rgba(0, 0, 0, 0.1);
            --input-bg: rgba(255, 255, 255, 0.3);
            --text-color: #1d1d1f;
            --text-color-darker: #6e6e73;
            --text-color-white: #000000;
            --shadow-color: rgba(0, 0, 0, 0.08);
            --glow-color: rgba(var(--accent-color-rgb), 0.2);
            --repo-card-bg: rgba(0, 0, 0, 0.05);
            --repo-card-hover-bg: rgba(0, 0, 0, 0.1);
        }

        /* 隐藏所有元素的滚动条 */
        html,
        body {
            scrollbar-width: none;
            /* Firefox */
            -ms-overflow-style: none;
            /* IE and Edge */
        }

        html::-webkit-scrollbar,
        body::-webkit-scrollbar {
            display: none;
            /* WebKit */
        }

        html {
            scroll-behavior: smooth;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            background-color: var(--body-bg-color);
            font-family: "Inter", -apple-system, BlinkMacSystemFont, "Segoe UI",
                Roboto, "Helvetica Neue", Arial, sans-serif;
            color: var(--text-color);
            overflow-x: hidden;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            transition: background-color 0.4s ease, color 0.4s ease;
        }

        /* --- 动态背景Canvas --- */
        #particle-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            z-index: -1;
        }

        /* --- 主容器 --- */
        #app {
            display: flex;
            flex-direction: column;
            flex-grow: 1;
            width: 100%;
            position: relative;
        }
        
        .main-content {
            flex-grow: 1;
        }

        /* --- iOS 风格玻璃效果 --- */
        .glass-effect {
            position: relative;
            background: var(--glass-bg);
            background-clip: padding-box;
            border: 1px solid var(--glass-border-color);
            border-radius: 24px;
            box-shadow: inset 0 0 0 1px rgba(255, 255, 255, 0.15),
                0 8px 32px 0 var(--shadow-color), 0 0 15px var(--glow-color);
            overflow: hidden;
            transition: background 0.4s ease, border-color 0.4s ease,
                box-shadow 0.4s ease;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
        }

        .glass-effect::before {
            display: none;
        }
        
        /* --- 错误提示通用样式 --- */
        .error-message {
            color: var(--error-color);
            font-size: 0.9rem;
            text-align: center;
            padding: 1rem;
            background: rgba(239, 68, 68, 0.1);
            border: 1px solid rgba(239, 68, 68, 0.3);
            border-radius: 12px;
            margin-top: 1rem;
        }

        /* --- 流星滚动条 --- */
        .scroll-indicator {
            position: fixed;
            top: 0;
            right: 5px;
            width: 10px;
            height: 100vh;
            z-index: 50;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.5s ease;
        }

        .scroll-indicator.is-scrolling {
            opacity: 1;
        }

        .scroll-star {
            position: absolute;
            top: 0;
            left: 50%;
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background-color: var(--accent-color);
            box-shadow: 0 0 10px var(--accent-color), 0 0 20px var(--accent-color);
            transition: transform 0.1s linear;
        }

        /* --- 浮动顶部导航栏 --- */
        .main-header {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 20;
            display: flex;
            align-items: center;
            padding: 8px;
            border-radius: 999px;
            transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            opacity: 0;
            pointer-events: none;
        }

        .main-header.is-visible {
            opacity: 1;
            pointer-events: auto;
        }

        .header-avatar {
            width: 44px;
            height: 44px;
            border-radius: 50%;
            object-fit: cover;
            flex-shrink: 0;
            cursor: pointer;
            border: 2px solid rgba(255, 255, 255, 0.2);
        }

        .header-nav {
            display: flex;
            align-items: center;
            max-width: 0;
            opacity: 0;
            overflow: hidden;
            white-space: nowrap;
            transition: max-width 0.4s ease-in-out, opacity 0.2s 0.1s ease-in-out,
                margin-left 0.4s ease-in-out;
            margin-left: 0;
        }

        .main-header.is-expanded .header-nav {
            max-width: 800px;
            opacity: 1;
            margin-left: 12px;
        }

        .header-nav a {
            font-size: 0.95rem;
            font-weight: 500;
            color: var(--text-color-darker);
            text-decoration: none;
            padding: 0 0.8rem;
            transition: color 0.3s ease;
            cursor: pointer;
        }

        .header-nav a:hover,
        .header-nav a.active {
            color: var(--text-color-white);
        }

        /* --- 初始全屏欢迎页 --- */
        .initial-hero-section {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            padding: 2rem;
            position: relative;
            transition: padding-bottom 0.5s ease-in-out;
        }

        .hero-text-container,
        .hero-bottom-content {
            position: relative;
            z-index: 1;
        }

        .hero-text-container {
            font-weight: 800;
            font-size: clamp(2.5rem, 10vw, 5rem);
            color: var(--text-color-white);
            line-height: 1.2;
        }

        .hero-text-container p {
            min-height: 1.2em;
        }

        .typing-cursor-hero {
            display: inline-block;
            width: 0.1em;
            height: 1em;
            background-color: var(--text-color-white);
            animation: blink 0.7s infinite;
        }

        .waving-hand {
            display: inline-block;
            animation: wave 2.5s infinite;
            transform-origin: 70% 70%;
        }

        @keyframes wave {
            0% { transform: rotate(0deg); }
            10% { transform: rotate(14deg); }
            20% { transform: rotate(-8deg); }
            30% { transform: rotate(14deg); }
            40% { transform: rotate(-4deg); }
            50% { transform: rotate(10deg); }
            60% { transform: rotate(0deg); }
            100% { transform: rotate(0deg); }
        }

        .hero-bottom-content {
            opacity: 0;
            transition: opacity 0.5s ease-in-out;
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 3rem;
            margin-top: 4rem;
        }

        .hero-bottom-content.visible {
            opacity: 1;
        }

        .hero-socials {
            display: flex;
            gap: 1.5rem;
        }

        .hero-socials a,
        .play-button {
            display: flex;
            justify-content: center;
            align-items: center;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            color: var(--text-color);
            transition: all 0.3s ease;
        }

        .hero-socials a:hover,
        .play-button:hover {
            transform: translateY(-5px) scale(1.05);
            color: var(--text-color-white);
            box-shadow: 0 0 20px var(--glow-color);
        }

        .hero-socials svg,
        .play-button i {
            width: 28px;
            height: 28px;
            font-size: 28px;
        }

        /* --- 音乐播放器 --- */
        .hero-player-container {
            margin-top: 0;
            width: 100%;
            max-width: 1000px;
            padding: 0 2rem;
            min-height: 95px;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
        }

        .player-wrapper {
            transition: all 0.5s ease-in-out;
            width: 100%;
            border-radius: 16px !important;
            border: 1px solid var(--glass-border-color) !important;
            padding: 1rem;
        }

        .play-button,
        .loading-spinner {
            border: none;
            padding: 0;
            cursor: pointer;
            position: absolute;
        }

        .play-button i,
        .loading-spinner i {
            margin: 0;
        }

        #player-hidden {
            display: none;
        }

        .custom-player {
            display: flex;
            align-items: center;
            gap: 1rem;
            width: 100%;
        }

        .custom-player-cover {
            width: 60px;
            height: 60px;
            border-radius: 8px;
            object-fit: cover;
            flex-shrink: 0;
        }

        .custom-player-info-wrapper {
            flex-grow: 1;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            justify-content: center;
            gap: 8px;
        }

        .custom-player-info {
            text-align: left;
        }

        .custom-player-title {
            font-size: 1rem;
            font-weight: 600;
            color: var(--text-color-white);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .custom-player-artist {
            font-size: 0.85rem;
            color: var(--text-color-darker);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .custom-player-progress-container {
            width: 100%;
            height: 4px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 2px;
            cursor: pointer;
        }

        .custom-player-progress-bar {
            height: 100%;
            background-color: var(--accent-color);
            border-radius: 2px;
            position: relative;
        }

        .custom-player-progress-bar::after {
            content: "";
            position: absolute;
            right: -6px;
            top: -4px;
            width: 12px;
            height: 12px;
            background-color: var(--text-color-white);
            border-radius: 50%;
        }

        .custom-player-controls {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .custom-player-controls button {
            background: none;
            border: none;
            color: var(--text-color-darker);
            cursor: pointer;
            font-size: 1.75rem;
            padding: 0.5rem;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
        }
        
        .custom-player-controls .playback-rate-btn {
            font-size: 0.9rem;
            font-weight: 600;
            width: 44px;
            height: 44px;
            padding: 0;
        }

        .custom-player-controls button:hover {
            color: var(--text-color-white);
            background: rgba(255, 255, 255, 0.1);
        }

        .loading-spinner {
            width: 60px;
            height: 60px;
            border: 4px solid var(--glass-border-color);
            border-top-color: var(--accent-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        .volume-control-wrapper {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-right: 0.5rem;
        }

        .volume-control-wrapper i {
            font-size: 1.5rem;
            color: var(--text-color-darker);
        }

        input[type="range"].volume-slider {
            -webkit-appearance: none;
            appearance: none;
            width: 80px;
            background: transparent;
            cursor: pointer;
        }

        input[type="range"].volume-slider::-webkit-slider-runnable-track {
            height: 4px;
            background: linear-gradient(to right,
                    var(--accent-color) 0%,
                    var(--accent-color) var(--volume-percent, 70%),
                    rgba(255, 255, 255, 0.1) var(--volume-percent, 70%),
                    rgba(255, 255, 255, 0.1) 100%);
            border-radius: 2px;
        }

        input[type="range"].volume-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            margin-top: -4px;
            height: 12px;
            width: 12px;
            border-radius: 50%;
            background: var(--text-color-white);
        }

        input[type="range"].volume-slider::-moz-range-track {
            background-color: rgba(255, 255, 255, 0.1);
            height: 4px;
            border-radius: 2px;
        }

        input[type="range"].volume-slider::-moz-range-progress {
            background-color: var(--accent-color);
            height: 4px;
            border-radius: 2px;
        }

        input[type="range"].volume-slider::-moz-range-thumb {
            height: 12px;
            width: 12px;
            border-radius: 50%;
            background: var(--text-color-white);
            border: none;
        }

        /* --- 歌词样式 --- */
        .custom-lrc-container {
            height: 60px;
            margin-top: 1rem;
            overflow: hidden;
            text-align: center;
        }

        .aplayer-lrc {
            padding: 0 !important;
            margin: 0 !important;
            text-shadow: none !important;
            background: none !important;
            height: 100%;
        }

        .aplayer-lrc-contents {
            display: flex;
            flex-direction: column;
            transition: transform 0.4s ease-out !important;
            height: 100%;
        }

        .aplayer-lrc p {
            font-size: 1rem;
            font-weight: 500;
            color: var(--text-color-darker);
            padding: 4px 0;
            margin: 0;
            line-height: 1.5;
            transition: all 0.4s ease-in-out;
            opacity: 0.5;
            flex-shrink: 0;
        }

        .aplayer-lrc p.aplayer-lrc-current {
            color: var(--text-color-white);
            font-weight: 700;
            transform: scale(1.05);
            opacity: 1;
            margin-top: auto;
            margin-bottom: auto;
        }

        .aplayer-lrc p:first-child {
            margin-top: auto;
        }

        .aplayer-lrc p:last-child {
            margin-bottom: auto;
        }

        .playlist-container {
            max-height: 0;
            overflow-y: auto;
            transition: max-height 0.5s ease-in-out;
            border-top: 1px solid transparent;
            margin-top: 0;
            padding-top: 0;
        }

        .playlist-container.show {
            max-height: 250px;
            margin-top: 1rem;
            padding-top: 0.5rem;
            border-top-color: var(--glass-border-color);
        }

        .playlist-container::-webkit-scrollbar {
            width: 10px;
        }

        .playlist-container::-webkit-scrollbar-track {
            background: transparent;
        }

        .playlist-container::-webkit-scrollbar-thumb {
            background-color: var(--accent-color);
            border-radius: 10px;
            border: 3px solid transparent;
            background-clip: content-box;
        }

        .playlist-item {
            display: flex;
            align-items: center;
            padding: 0.5rem 1rem;
            cursor: pointer;
            border-radius: 8px;
            transition: background-color 0.2s;
        }

        .playlist-item:hover {
            background-color: var(--repo-card-hover-bg);
        }

        .playlist-item.active {
            background-color: var(--repo-card-bg);
        }

        .playlist-item .index {
            color: var(--text-color-darker);
            margin-right: 1rem;
            width: 1.5rem;
            text-align: right;
        }

        .playlist-item .info {
            text-align: left;
            overflow: hidden;
            white-space: nowrap;
        }

        .playlist-item .title {
            color: var(--text-color);
            text-overflow: ellipsis;
            overflow: hidden;
        }

        .playlist-item .artist {
            font-size: 0.8rem;
            color: var(--text-color-darker);
            text-overflow: ellipsis;
            overflow: hidden;
        }
        
        .songlist-switcher {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s ease-in-out, margin-top 0.5s ease-in-out, padding-top 0.5s ease-in-out;
            border-top: 1px solid transparent;
            margin-top: 0;
            padding-top: 0;
            text-align: left;
        }

        .songlist-switcher.show {
            max-height: 400px;
            margin-top: 1rem;
            padding-top: 1rem;
            border-top-color: var(--glass-border-color);
        }

        .songlist-switcher h4, .songlist-switcher h5 {
            padding: 0 1rem;
            margin-bottom: 0.5rem;
            color: var(--text-color-white);
        }

        .songlist-switcher h5 {
            margin-top: 1rem;
            font-size: 0.9em;
            color: var(--text-color-darker);
        }

        .songlist-switcher ul {
            list-style: none;
            padding: 0;
            margin: 0;
            max-height: 150px;
            overflow-y: auto;
        }

        .songlist-switcher ul::-webkit-scrollbar { width: 6px; }
        .songlist-switcher ul::-webkit-scrollbar-thumb { background-color: var(--accent-color); border-radius: 6px; }


        .songlist-switcher li {
            padding: 0.5rem 1rem;
            cursor: pointer;
            border-radius: 8px;
            transition: background-color 0.2s;
            font-size: 0.9rem;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .songlist-switcher li > span {
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .songlist-switcher li:hover {
            background-color: var(--repo-card-hover-bg);
        }
        
        .songlist-switcher li.active {
            background-color: var(--repo-card-bg);
            color: var(--accent-color);
            font-weight: 500;
        }

        .songlist-switcher .remove-btn {
            background: none;
            border: none;
            color: var(--text-color-darker);
            cursor: pointer;
            font-size: 1.2rem;
            padding: 0.25rem;
            line-height: 1;
            border-radius: 50%;
            margin-left: 1rem;
            flex-shrink: 0;
        }
        .songlist-switcher .remove-btn:hover {
            color: var(--error-color);
            background-color: rgba(239, 68, 68, 0.1);
        }

        .songlist-input-group {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
            padding: 1rem 1rem 0.5rem;
        }
        
        .songlist-input-row {
            display: flex;
            gap: 0.5rem;
        }

        .songlist-input-group input {
            flex-grow: 1;
            background: var(--input-bg);
            border: 1px solid var(--glass-border-color);
            border-radius: 8px;
            padding: 0.5rem 0.75rem;
            color: var(--text-color);
            font-size: 0.9rem;
        }
        
        .songlist-input-group input[name="songlist-id"] {
            flex-basis: 40%;
            flex-grow: 1;
        }
        .songlist-input-group input[name="songlist-name"] {
            flex-basis: 60%;
            flex-grow: 2;
        }

        .songlist-input-group input:focus {
            outline: none;
            border-color: var(--accent-color);
        }

        .songlist-input-group button {
            background: var(--subscribe-btn-bg);
            border: none;
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: opacity 0.2s;
            width: 100%;
        }
        .songlist-input-group button:hover {
            opacity: 0.9;
        }

        .player-fade-enter-active,
        .player-fade-leave-active {
            transition: all 0.4s ease-in-out;
        }

        .player-fade-enter-from,
        .player-fade-leave-to {
            opacity: 0;
            transform: scale(0.95);
        }

        .custom-player-controls button.active {
            color: var(--accent-color);
        }

        /* --- 登录模态框 --- */
        .login-modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 30;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }

        .login-modal-overlay.is-visible {
            opacity: 1;
            pointer-events: auto;
        }

        .login-modal-container {
            transform: scale(0.95);
            transition: transform 0.3s ease;
        }

        .login-modal-overlay.is-visible .login-modal-container {
            transform: scale(1);
        }

        .home-container {
            padding: 2rem;
            text-align: center;
            max-width: 90vw;
            width: 400px;
        }

        .info-card {
            padding: 2.5rem;
        }

        .admin-login-form h3 {
            color: var(--text-color-white);
            font-size: 1.5rem;
            margin-bottom: 2rem;
        }
        
        .login-status-message {
            min-height: 1.2em;
            font-size: 0.9em;
            margin-bottom: 1rem;
            font-weight: 500;
        }
        .login-status-message.success { color: var(--success-color); }
        .login-status-message.error { color: var(--error-color); }

        .form-group {
            margin-bottom: 1.5rem;
            text-align: left;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-size: 0.9rem;
            color: var(--text-color-darker);
        }

        .form-group input {
            width: 100%;
            padding: 0.8rem 1rem;
            border-radius: 12px;
            border: 1px solid var(--glass-border-color);
            color: var(--text-color);
            font-size: 1rem;
            transition: all 0.3s ease;
            background: var(--input-bg);
        }

        .form-group input:focus {
            outline: none;
            border-color: var(--accent-color);
            box-shadow: 0 0 0 2px var(--accent-color);
        }

        .login-button {
            width: 100%;
            padding: 0.8rem 1rem;
            border: none;
            background-color: var(--subscribe-btn-bg);
            color: white;
            font-size: 1rem;
            font-weight: 500;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .login-button:hover {
            opacity: 0.9;
            transform: translateY(-2px);
        }
        .login-button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        /* --- 内容区域 --- */
        .content-section {
            padding: 4rem 2rem;
            max-width: 1000px;
            margin: 0 auto;
        }

        .content-section:first-of-type {
            padding-top: 8rem;
        }

        .content-card {
            padding: 2rem;
            margin-bottom: 3rem;
            box-shadow: none;
        }
        
        .panel-content-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 2rem;
        }

        @media (min-width: 768px) {
            .panel-content-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }


        .content-card h2 {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--text-color-white);
            margin-bottom: 2rem;
            text-align: center;
        }
        
        .content-card h3 {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--text-color-white);
            margin-bottom: 1.5rem;
        }

        /* --- Resume Component Styles (New) --- */
        .resume-header {
            text-align: center;
            margin-bottom: 2rem;
            padding-bottom: 2rem;
            border-bottom: 1px solid var(--glass-border-color);
        }

        .resume-header h1 {
            font-size: 2.5rem;
            color: var(--text-color-white);
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        .resume-contact {
            display: flex;
            justify-content: center;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem 2rem;
            color: var(--text-color-darker);
        }

        .resume-contact-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .resume-contact-item i {
            font-size: 1.2rem;
            color: var(--accent-color);
        }

        .resume-section {
            margin-bottom: 2.5rem;
        }

        .resume-section h3 {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--text-color-white);
            padding-bottom: 0.75rem;
            margin-bottom: 1.5rem;
            border-bottom: 1px solid var(--accent-color);
            display: inline-block;
        }
        
        .education-grid, .experience-grid {
            display: grid;
            gap: 1.5rem;
        }

        .education-item, .experience-item, .project-item {
            background: var(--repo-card-bg);
            padding: 1.5rem;
            border-radius: 16px;
        }

        .item-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.75rem;
            flex-wrap: wrap;
            gap: 0.5rem;
        }
        
        .item-header h4 {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--text-color);
        }

        .item-header .date {
            font-size: 0.9rem;
            color: var(--text-color-darker);
            font-weight: 500;
        }
        
        .item-subheader {
            font-size: 1rem;
            color: var(--text-color-darker);
            margin-bottom: 1rem;
            font-weight: 500;
        }

        .item-details p, .item-details ul {
            font-size: 0.95rem;
            line-height: 1.7;
            color: var(--text-color-darker);
        }
        
        .item-details ul {
            list-style-position: inside;
            padding-left: 0.5rem;
        }
        
        .item-details strong {
            color: var(--text-color);
            font-weight: 500;
        }

        .skills-container {
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
        }
        
        .skill-category {
            flex: 1 1 300px;
        }
        
        .skill-category h4 {
            font-size: 1.1rem;
            color: var(--text-color);
            margin-bottom: 1rem;
        }

        .skill-list {
            display: flex;
            flex-wrap: wrap;
            gap: 0.75rem;
        }
        
        .skill-tag {
            background-color: var(--repo-card-bg);
            color: var(--text-color);
            padding: 0.5rem 1rem;
            border-radius: 8px;
            font-size: 0.9rem;
            transition: all 0.2s ease;
        }
        
        .skill-tag:hover {
            background-color: var(--accent-color);
            color: #121212;
            transform: translateY(-2px);
        }
        
        .honors-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 1rem;
        }
        
        .honor-item {
            background-color: var(--repo-card-bg);
            color: var(--text-color);
            padding: 1rem;
            border-radius: 12px;
            display: flex;
            align-items: center;
            gap: 1rem;
        }
        
        .honor-item i {
            font-size: 1.5rem;
            color: var(--accent-color);
        }

        /* --- END Resume --- */

        /* About Us 组件 */
        .about-us-card {
            display: flex;
            padding: 3rem;
            gap: 3rem;
        }
        
        .about-us-card h2 { text-align: left; }

        .about-sidebar {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 1.5rem;
        }

        .sidebar-line {
            width: 2px;
            height: 100%;
            background-color: var(--accent-color);
            flex-grow: 1;
        }

        .sidebar-text {
            writing-mode: vertical-rl;
            transform: rotate(180deg);
            color: var(--text-color-darker);
            font-size: 0.9rem;
            letter-spacing: 0.1em;
            white-space: nowrap;
        }

        .about-main-content {
            flex-grow: 1;
        }

        .about-main-content h2 {
            font-size: 1.1rem;
            font-weight: 500;
            color: var(--text-color-darker);
            margin-bottom: 1.5rem;
        }

        .about-main-content blockquote {
            position: relative;
            font-size: 2.5rem;
            font-weight: 700;
            line-height: 1.4;
            margin-left: 2rem;
            margin-bottom: 3rem;
            padding-left: 2rem;
            border-left: 2px solid var(--accent-color);
        }

        .about-main-content h3 {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--text-color-white);
            margin-bottom: 1rem;
        }

        .about-main-content p {
            font-size: 1rem;
            line-height: 1.8;
            color: var(--text-color-darker);
            margin-bottom: 2rem;
        }

        .about-main-content p strong {
            color: var(--accent-color);
            font-weight: 500;
        }

        .rd-philosophy {
            border-top: 1px solid var(--glass-border-color);
            padding-top: 2rem;
            margin-top: 2rem;
        }

        /* --- 交互式探索中心 --- */
        #interactive-journey {
            padding: 4rem 2rem;
            max-width: 1200px;
            margin: 0 auto;
            position: relative;
        }
        
        .hub-intro {
            text-align: center;
            max-width: 800px;
            margin: 0 auto 4rem;
        }
        
        .hub-intro h2 {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 1rem;
            color: var(--text-color-white);
        }
        
        .hub-intro blockquote {
            position: relative;
            font-size: 1.5rem;
            font-weight: 500;
            line-height: 1.6;
            margin: 0 auto 1.5rem;
            max-width: 600px;
        }
        
        .hub-intro blockquote strong {
            color: var(--accent-color);
            font-weight: 600;
        }
        
        .hub-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 1.5rem;
        }
        
        .hub-node {
            background: var(--glass-bg);
            border: 1px solid var(--glass-border-color);
            border-radius: 20px;
            padding: 2rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .hub-node:hover {
            transform: translateY(-10px) scale(1.02);
            box-shadow: 0 10px 40px var(--shadow-color), 0 0 20px var(--glow-color);
            border-color: rgba(var(--accent-color-rgb), 0.5);
        }
        
        .hub-node i {
            font-size: 3rem;
            color: var(--accent-color);
            margin-bottom: 1rem;
            display: block;
        }
        
        .hub-node h3 {
            font-size: 1.25rem;
            color: var(--text-color-white);
            margin-bottom: 0.5rem;
        }
        
        .hub-node p {
            font-size: 0.9rem;
            color: var(--text-color-darker);
            line-height: 1.5;
        }
        
        .journey-panel .content-card {
            margin-bottom: 0;
        }
        
        .close-panel-btn {
            position: absolute;
            top: 1.5rem;
            right: 1.5rem;
            background: var(--repo-card-bg);
            border: 1px solid var(--glass-border-color);
            color: var(--text-color);
            width: 44px;
            height: 44px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 1.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            z-index: 10;
        }
        
        .close-panel-btn:hover {
            background: var(--accent-color);
            color: #121212;
            transform: scale(1.1) rotate(90deg);
        }
        
        .panel-fade-enter-active, .panel-fade-leave-active {
            transition: opacity 0.4s ease-in-out;
        }
        .panel-fade-enter-from, .panel-fade-leave-to {
            opacity: 0;
        }
        .panel-fade-enter-active {
            transition-delay: 0.2s;
        }


        /* --- Resume Component Styles --- */
        .resume-header {
            text-align: center;
            margin-bottom: 2rem;
            padding-bottom: 2rem;
            border-bottom: 1px solid var(--glass-border-color);
        }

        .resume-header h1 {
            font-size: 2.5rem;
            color: var(--text-color-white);
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        .resume-contact {
            display: flex;
            justify-content: center;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem 2rem;
            color: var(--text-color-darker);
        }

        .resume-contact-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .resume-contact-item i {
            font-size: 1.2rem;
            color: var(--accent-color);
        }

        .resume-section {
            margin-bottom: 2.5rem;
        }

        .resume-section h3 {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--text-color-white);
            padding-bottom: 0.75rem;
            margin-bottom: 1.5rem;
            border-bottom: 1px solid var(--accent-color);
            display: inline-block;
        }
        
        .education-grid, .experience-grid {
            display: grid;
            gap: 1.5rem;
        }

        .education-item, .experience-item, .project-item {
            background: var(--repo-card-bg);
            padding: 1.5rem;
            border-radius: 16px;
        }

        .item-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.75rem;
            flex-wrap: wrap;
            gap: 0.5rem;
        }
        
        .item-header h4 {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--text-color);
        }

        .item-header .date {
            font-size: 0.9rem;
            color: var(--text-color-darker);
            font-weight: 500;
        }
        
        .item-subheader {
            font-size: 1rem;
            color: var(--text-color-darker);
            margin-bottom: 1rem;
            font-weight: 500;
        }

        .item-details p, .item-details ul {
            font-size: 0.95rem;
            line-height: 1.7;
            color: var(--text-color-darker);
        }
        
        .item-details ul {
            list-style-position: inside;
            padding-left: 0.5rem;
        }
        
        .item-details strong {
            color: var(--text-color);
            font-weight: 500;
        }

        .skills-container {
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
        }
        
        .skill-category {
            flex: 1 1 300px;
        }
        
        .skill-category h4 {
            font-size: 1.1rem;
            color: var(--text-color);
            margin-bottom: 1rem;
        }

        .skill-list {
            display: flex;
            flex-wrap: wrap;
            gap: 0.75rem;
        }
        
        .skill-tag {
            background-color: var(--repo-card-bg);
            color: var(--text-color);
            padding: 0.5rem 1rem;
            border-radius: 8px;
            font-size: 0.9rem;
            transition: all 0.2s ease;
        }
        
        .skill-tag:hover {
            background-color: var(--accent-color);
            color: #121212;
            transform: translateY(-2px);
        }
        
        .honors-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 1rem;
        }
        
        .honor-item {
            background-color: var(--repo-card-bg);
            color: var(--text-color);
            padding: 1rem;
            border-radius: 12px;
            display: flex;
            align-items: center;
            gap: 1rem;
        }
        
        .honor-item i {
            font-size: 1.5rem;
            color: var(--accent-color);
        }

        /* Github & Bookshelf 组件通用样式 */
        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
            gap: 1rem;
        }
        
        .card-header + h2 { margin-bottom: 1.5rem; }

        .card-header .stats {
            font-size: 0.9rem;
            color: var(--text-color-darker);
            display: flex;
            gap: 1rem;
        }

        .card-header .stats strong {
            color: var(--text-color-white);
            font-weight: 600;
        }

        .card-header a {
            color: var(--accent-color);
            text-decoration: none;
            font-weight: 500;
        }

        .github-contributions {
            width: 100%;
            border-radius: 12px;
            margin-bottom: 2rem;
        }

        .repo-grid, .book-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 1rem;
        }

        .repo-card, .book-card {
            background: var(--repo-card-bg);
            padding: 1.5rem;
            border-radius: 16px;
            text-decoration: none;
            color: var(--text-color-darker);
            transition: background-color 0.3s ease, transform 0.3s ease;
            display: flex;
            flex-direction: column;
        }
        
        .book-card {
            align-items: center;
            text-align: center;
        }

        .repo-card:hover, .book-card:hover {
            background: var(--repo-card-hover-bg);
            transform: translateY(-5px);
        }

        .repo-card h3, .book-card h3 {
            color: var(--text-color-white);
            font-size: 1.1rem;
            margin-bottom: 0.5rem;
        }
        
        .book-card h3 {
             margin-top: 1rem;
        }

        .repo-card p, .book-card p {
            font-size: 0.9rem;
            line-height: 1.6;
            margin-bottom: 1rem;
            flex-grow: 1;
        }
        
        .book-card p {
            flex-grow: 0;
        }
        
        .book-cover {
            width: 100%;
            max-width: 150px;
            height: auto;
            aspect-ratio: 2 / 3;
            object-fit: cover;
            border-radius: 8px;
            display: block;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        .repo-stats {
            display: flex;
            gap: 1rem;
            font-size: 0.85rem;
            align-items: center;
        }

        .repo-stats span {
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        .repo-stats svg {
            width: 14px;
            height: 14px;
        }

        /* --- 博客组件样式 --- */
        .blog-panel-content {
            display: flex;
            min-height: 80vh;
        }

        .blog-sidebar {
            width: 300px;
            flex-shrink: 0;
            border-right: 1px solid var(--glass-border-color);
            padding-right: 1.5rem;
            height: 80vh;
            display: flex;
            flex-direction: column;
        }
        
        .blog-category-filter {
            padding-bottom: 1rem;
            margin-bottom: 1rem;
            border-bottom: 1px solid var(--glass-border-color);
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
        }
        
        .blog-category-filter button {
            background: var(--repo-card-bg);
            border: 1px solid transparent;
            color: var(--text-color-darker);
            padding: 0.5rem 1rem;
            border-radius: 999px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.2s ease;
        }
        
        .blog-category-filter button:hover {
            background: var(--repo-card-hover-bg);
            color: var(--text-color-white);
        }
        
        .blog-category-filter button.active {
            background-color: var(--accent-color);
            color: #121212;
            font-weight: 600;
            border-color: var(--accent-color);
        }
        
        .blog-post-list-container {
            flex-grow: 1;
            overflow-y: auto;
        }

        .blog-post-list-container::-webkit-scrollbar { width: 6px; }
        .blog-post-list-container::-webkit-scrollbar-thumb { background-color: var(--accent-color); border-radius: 6px; }


        .blog-post-item {
            padding: 1rem;
            border-radius: 12px;
            cursor: pointer;
            transition: background-color 0.2s ease;
        }
        .blog-post-item:not(:last-child) {
            margin-bottom: 0.5rem;
        }

        .blog-post-item h4 {
            color: var(--text-color);
            margin-bottom: 0.5rem;
            font-size: 1.1rem;
        }

        .blog-post-item p {
            color: var(--text-color-darker);
            font-size: 0.9rem;
        }
        
        .blog-post-item.active {
            background-color: var(--repo-card-bg);
        }
        .blog-post-item:hover:not(.active) {
            background-color: var(--repo-card-hover-bg);
        }
        
        .blog-main {
            flex-grow: 1;
            padding-left: 2rem;
            height: 80vh;
            overflow-y: auto;
        }

        .blog-main::-webkit-scrollbar { width: 8px; }
        .blog-main::-webkit-scrollbar-thumb { background-color: var(--accent-color); border-radius: 8px; }
        
        .blog-post-content h2 {
            font-size: 2rem;
            color: var(--text-color-white);
            margin-bottom: 0.5rem;
            border-bottom: 1px solid var(--glass-border-color);
            padding-bottom: 1rem;
        }
        .blog-post-meta {
            color: var(--text-color-darker);
            margin-bottom: 2rem;
        }
        .blog-post-body {
            line-height: 1.8;
            font-size: 1.05rem;
        }
        .blog-post-body > *:first-child {
            margin-top: 0;
        }
        .blog-post-body p { margin-bottom: 1em; }
        .blog-post-body h3 { font-size: 1.5em; margin: 1.5em 0 1em; color: var(--text-color-white); }
        .blog-post-body h4 { font-size: 1.2em; margin: 1.2em 0 1em; color: var(--text-color-white); }
        .blog-post-body a { color: var(--accent-color); }
        .blog-post-body ul, .blog-post-body ol { padding-left: 1.5em; margin-bottom: 1em; }
        .blog-post-body blockquote {
            border-left: 4px solid var(--accent-color);
            padding-left: 1em;
            margin: 1.5em 0;
            color: var(--text-color-darker);
        }
        .blog-post-body pre {
            background-color: rgba(0, 0, 0, 0.3);
            padding: 1rem;
            border-radius: 8px;
            overflow-x: auto;
            border: 1px solid var(--glass-border-color);
            margin: 1.5em 0;
        }
        .blog-post-body code { font-family: 'Courier New', Courier, monospace; }

        /* 时间线 */
        .timeline {
            position: relative;
            padding-left: 2rem;
            --line-color: var(--accent-color);
        }

        .timeline::before {
            content: "";
            position: absolute;
            left: 0;
            top: 0;
            width: 2px;
            height: 100%;
            background-color: var(--repo-card-bg);
        }

        .timeline::after {
            content: "";
            position: absolute;
            left: 0;
            top: 0;
            width: 2px;
            height: 100%;
            background-color: var(--line-color);
            transform: scaleY(0);
            transform-origin: top;
            transition: transform 1s ease-out;
        }

        .timeline.is-visible::after {
            transform: scaleY(1);
        }

        .timeline-item {
            position: relative;
            margin-bottom: 2rem;
            opacity: 0;
            transform: translateX(20px);
            transition: opacity 0.6s ease-out, transform 0.6s ease-out;
        }

        .timeline-item.is-visible {
            opacity: 1;
            transform: translateX(0);
        }


        .timeline-item:last-child {
            margin-bottom: 0;
        }

        .timeline-item::before {
            content: "";
            position: absolute;
            left: -2.5rem;
            top: 4px;
            width: 14px;
            height: 14px;
            background-color: var(--body-bg-color);
            border-radius: 50%;
            border: 3px solid var(--line-color);
            z-index: 1;
            transform: scale(0);
            transition: transform 0.4s ease-out 0.5s;
        }

        .timeline-item.is-visible::before {
            transform: scale(1);
        }

        .timeline-date {
            font-weight: 600;
            color: var(--text-color-white);
        }

        .timeline-desc {
            margin-top: 0.5rem;
            color: var(--text-color-darker);
        }

        /* --- 目标进度组件 --- */
        .target-list {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }

        .target-item {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .target-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.95rem;
        }

        .target-name {
            color: var(--text-color);
            font-weight: 500;
        }

        .target-progress-text {
            color: var(--text-color-darker);
            font-size: 0.9rem;
        }

        .progress-bar-container {
            width: 100%;
            height: 8px;
            background-color: var(--repo-card-bg);
            border-radius: 4px;
            overflow: hidden;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--accent-color), #3b82f6);
            border-radius: 4px;
            width: 0;
            transition: width 1s cubic-bezier(0.25, 1, 0.5, 1) 0.3s;
        }
        
        /* --- AI 对话组件 --- */
        .chatbot-card {
            display: flex;
            flex-direction: column;
            min-height: 70vh;
            max-height: 120vh;
            transition: all 0.3s ease;
        }

        .chatbot-settings {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        @media (min-width: 900px) {
            .chatbot-settings {
                grid-template-columns: repeat(3, 1fr);
            }
        }

        .setting-item {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .api-key-group {
            grid-column: 1 / -1;
        }

        .setting-item label {
            font-size: 0.9rem;
            color: var(--text-color-darker);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .tooltip-icon {
            color: var(--text-color-darker);
            font-size: 1rem;
            cursor: help;
            margin-left: 0.5rem;
        }

        .setting-item input[type="password"],
        .setting-item input[type="range"] {
            width: 100%;
            padding: 0.5rem 0.75rem;
            border-radius: 12px;
            border: 1px solid var(--glass-border-color);
            background: var(--input-bg);
            color: var(--text-color);
            font-size: 0.9rem;
        }
        
        .setting-item input[type="range"]:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .setting-item input[type="password"]:focus {
            outline: none;
            border-color: var(--accent-color);
            box-shadow: 0 0 0 2px var(--accent-color);
        }

        .get-api-key-link {
            font-size: 0.8rem;
            color: var(--accent-color);
            text-decoration: none;
        }

        .get-api-key-link:hover {
            text-decoration: underline;
        }

        .chat-window {
            flex-grow: 1;
            overflow-y: auto;
            padding: 1rem;
            background-color: var(--repo-card-bg);
            border-radius: 16px;
            margin-bottom: 1rem;
        }

        .chat-window::-webkit-scrollbar {
            width: 8px;
        }

        .chat-window::-webkit-scrollbar-track {
            background: transparent;
        }

        .chat-window::-webkit-scrollbar-thumb {
            background-color: var(--accent-color);
            border-radius: 8px;
        }

        .chat-status {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.75rem;
            padding: 0.5rem;
            font-size: 0.9rem;
            color: var(--text-color-darker);
            margin-bottom: 1rem;
        }

        .animate-spin {
            animation: spin 1s linear infinite;
        }

        .message {
            margin-bottom: 1rem;
            display: flex;
            flex-direction: column;
        }

        .message.user {
            align-items: flex-end;
        }

        .message.assistant {
            align-items: flex-start;
        }
        
        .message-content {
            max-width: 90%;
            padding: 0.8rem 1.2rem;
            border-radius: 18px;
            line-height: 1.7;
            position: relative;
            word-wrap: break-word;
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .message-content> :first-child {
            margin-top: 0;
        }

        .message-content> :last-child {
            margin-bottom: 0;
        }
        
        .message-content p,
        .message-content ul,
        .message-content ol {
            margin: 0;
        }

        .message-content ul, .message-content ol {
            padding-left: 1.5rem;
        }


        .message.user .message-content {
            background-color: var(--accent-color);
            color: #121212;
            border-bottom-right-radius: 4px;
        }

        .message.assistant .message-content {
            background-color: var(--repo-card-hover-bg);
            color: var(--text-color);
            border-bottom-left-radius: 4px;
        }
        
        .message.assistant .thinking-process {
            border-bottom: 1px solid var(--glass-border-color);
            margin-bottom: 1rem;
            padding-bottom: 1rem;
            font-size: 0.9em;
            color: var(--text-color-darker);
            opacity: 0.8;
        }

        .message.assistant pre {
            background-color: rgba(0, 0, 0, 0.3);
            padding: 1rem;
            border-radius: 8px;
            overflow-x: auto;
            font-size: 0.9em;
            border: 1px solid var(--glass-border-color);
        }

        .message.assistant code {
            font-family: 'Courier New', Courier, monospace;
        }

        .message-content .katex-display {
            overflow-x: auto;
            overflow-y: hidden;
            padding: 0.5rem 0;
        }
        
        .copy-button {
            position: absolute;
            bottom: 8px;
            right: 8px;
            background: rgba(0, 0, 0, 0.1);
            border: none;
            color: var(--text-color-darker);
            cursor: pointer;
            padding: 6px;
            border-radius: 6px;
            opacity: 0;
            transition: all 0.2s;
            font-size: 1rem;
            line-height: 1;
        }

        .message-content:hover .copy-button {
            opacity: 1;
        }

        .copy-button:hover {
            background: rgba(0, 0, 0, 0.2);
            color: var(--text-color-white);
        }

        .copy-button .ph-check {
            color: var(--accent-color);
            font-weight: bold;
        }

        .thinking-process-container {
            border-bottom: 1px solid var(--glass-border-color);
            margin: -0.25rem 0 0.75rem;
            padding-bottom: 0.75rem;
        }

        .toggle-thinking-btn {
            background: none;
            border: none;
            color: var(--text-color-darker);
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0;
            margin-bottom: 0.5rem;
            font-size: 0.9em;
            font-weight: 500;
        }

        .toggle-thinking-btn:hover {
            color: var(--text-color-white);
        }
        
        .toggle-thinking-btn i {
            transition: transform 0.2s ease;
        }
        
        .thinking-process-content {
            font-size: 0.9em;
            color: var(--text-color-darker);
            opacity: 0.9;
            max-height: 200px;
            overflow-y: auto;
            padding-right: 5px;
        }

        .thinking-process-content::-webkit-scrollbar {
            width: 4px;
        }

        .thinking-process-content::-webkit-scrollbar-thumb {
            background-color: var(--accent-color);
            border-radius: 4px;
        }
        
        .chat-input-area {
            display: flex;
            gap: 1rem;
        }

        .chat-input-area textarea {
            flex-grow: 1;
            padding: 0.75rem 1rem;
            border-radius: 16px;
            border: 1px solid var(--glass-border-color);
            background: var(--input-bg);
            color: var(--text-color);
            font-size: 1rem;
            resize: none;
            height: 50px;
            transition: all 0.2s;
        }

        .chat-input-area textarea:focus {
            outline: none;
            border-color: var(--accent-color);
            box-shadow: 0 0 0 2px var(--accent-color);
            height: 80px;
        }

        .send-button {
            padding: 0.75rem 1.25rem;
            border-radius: 16px;
            border: none;
            background-color: var(--subscribe-btn-bg);
            color: white;
            cursor: pointer;
            font-size: 1rem;
            transition: background-color 0.3s;
        }

        .send-button:disabled {
            background-color: var(--text-color-darker);
            cursor: not-allowed;
        }

        .custom-toggle {
            display: flex;
            flex-direction: row !important;
            align-items: center;
            justify-content: space-between;
            padding: 0.5rem 0.75rem;
            border-radius: 12px;
            border: 1px solid var(--glass-border-color);
            background: var(--input-bg);
            height: 100%;
        }

        .custom-toggle label {
            margin: 0;
            color: var(--text-color);
        }

        .toggle-switch {
            width: 44px;
            height: 24px;
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 2px;
            cursor: pointer;
            transition: background-color 0.2s ease;
        }

        .toggle-switch.active {
            background-color: var(--accent-color);
        }

        .toggle-knob {
            width: 20px;
            height: 20px;
            background-color: white;
            border-radius: 50%;
            transition: transform 0.2s ease;
        }

        .toggle-switch.active .toggle-knob {
            transform: translateX(20px);
        }
        
        .history-controls {
            display: flex;
            gap: 0.5rem;
            align-items: center;
        }

        .chat-history-dropdown {
            position: relative;
            flex-grow: 1;
        }

        .dropdown-trigger {
            width: 100%;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.5rem 0.75rem;
            height: 38px;
            border-radius: 12px;
            border: 1px solid var(--glass-border-color);
            background: var(--input-bg);
            color: var(--text-color);
            font-size: 0.9rem;
            text-align: left;
            cursor: pointer;
        }
        .dropdown-trigger span {
             white-space: nowrap;
             overflow: hidden;
             text-overflow: ellipsis;
        }

        .dropdown-menu {
            position: absolute;
            bottom: calc(100% + 5px);
            left: 0;
            width: 100%;
            z-index: 10;
            list-style: none;
            border-radius: 12px;
            padding: 0.5rem;
            max-height: 200px;
            overflow-y: auto;
            background: var(--glass-bg);
            border: 1px solid var(--glass-border-color);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
        }
        .dropdown-menu::-webkit-scrollbar {
            width: 6px;
        }

        .dropdown-menu::-webkit-scrollbar-thumb {
            background-color: var(--accent-color);
            border-radius: 6px;
        }

        .dropdown-item {
            padding: 0.6rem 0.75rem;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.2s;
             white-space: nowrap;
             overflow: hidden;
             text-overflow: ellipsis;
        }

        .dropdown-item:hover {
            background-color: var(--repo-card-hover-bg);
        }
        .dropdown-item.active {
            background-color: var(--accent-color);
            color: #121212;
            font-weight: 500;
        }

        .history-btn {
            flex-shrink: 0;
            width: 38px;
            height: 38px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 12px;
            border: 1px solid var(--glass-border-color);
            background: var(--input-bg);
            color: var(--text-color);
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        .history-btn:hover {
            border-color: var(--accent-color);
        }

        .dropdown-fade-enter-active,
        .dropdown-fade-leave-active {
            transition: all 0.2s ease;
        }

        .dropdown-fade-enter-from,
        .dropdown-fade-leave-to {
            opacity: 0;
            transform: translateY(10px);
        }
        
        /* --- 兴趣星系组件 --- */
        .interest-galaxy-container {
            position: relative;
            width: 100%;
            height: 600px;
            margin: 2rem auto 0;
            transition: transform 0.5s cubic-bezier(0.25, 0.8, 0.25, 1);
        }

        .interest-galaxy-container.detail-view-active {
            transform: translateX(-15%);
        }

        .galaxy-lines {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 0;
            opacity: 0;
            transition: opacity 0.5s ease;
        }

        .interest-galaxy:not(.detail-view-active) .galaxy-lines {
            opacity: 0.3;
        }

        .galaxy-lines path {
            stroke: var(--accent-color);
            stroke-width: 1.5px;
            fill: none;
            stroke-dasharray: 4 4;
            transition: d 0.5s cubic-bezier(0.25, 0.8, 0.25, 1);
        }

        .interest-galaxy {
            position: relative;
            width: 100%;
            height: 100%;
        }

        .interest-node {
            position: absolute;
            width: 120px;
            height: 120px;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.5s cubic-bezier(0.25, 0.8, 0.25, 1);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            background-color: var(--repo-card-bg);
            border: 2px solid transparent;
            box-shadow: 0 4px 15px var(--shadow-color);
            animation: float 6s ease-in-out infinite, pulse 4s ease-in-out infinite;
            z-index: 2;
        }

        .interest-node.is-center {
            width: 140px;
            height: 140px;
            z-index: 3;
            border-color: rgba(var(--accent-color-rgb), 0.3);
        }
        
        .interest-node:hover {
            transform: translate(-50%, -50%) scale(1.15) !important;
            border-color: var(--accent-color);
            box-shadow: 0 0 30px var(--glow-color);
            z-index: 5 !important;
            animation-play-state: paused;
        }

        @keyframes float {
            0% { transform: translate(-50%, -50%) translateY(0px); }
            50% { transform: translate(-50%, -50%) translateY(-15px); }
            100% { transform: translate(-50%, -50%) translateY(0px); }
        }

        @keyframes pulse {
            0% { box-shadow: 0 0 15px var(--shadow-color), 0 0 20px var(--glow-color); }
            50% { box-shadow: 0 0 25px var(--shadow-color), 0 0 35px rgba(var(--accent-color-rgb), 0.4); }
            100% { box-shadow: 0 0 15px var(--shadow-color), 0 0 20px var(--glow-color); }
        }

        .interest-node i {
            font-size: 2.5rem;
            color: var(--accent-color);
            transition: all 0.3s ease;
        }

        .interest-node.is-center i {
            font-size: 3rem;
        }

        .interest-node-title {
            font-size: 0.9rem;
            font-weight: 500;
            color: var(--text-color-white);
            margin-top: 0.5rem;
            transition: all 0.3s ease;
        }
        
        .interest-node:hover i {
             transform: translateY(-5px);
        }
        
        .interest-node:hover .interest-node-title {
             transform: translateY(5px);
        }

        .interest-detail-card {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0.9);
            width: 90%;
            max-width: 500px;
            height: auto;
            max-height: 90%;
            z-index: 10;
            display: flex;
            flex-direction: column;
            border-radius: 20px;
        }
        
        .interest-detail-image {
            width: 100%;
            height: 250px;
            object-fit: cover;
            border-radius: 20px 20px 0 0;
        }

        .interest-detail-content {
            padding: 1.5rem;
            text-align: left;
        }

        .interest-detail-content h3 {
            text-align: left;
            margin-bottom: 1rem;
        }

        .interest-detail-content p {
            color: var(--text-color-darker);
            line-height: 1.7;
        }

        .close-interest-detail-btn {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: rgba(0,0,0,0.3);
            backdrop-filter: blur(5px);
            border: 1px solid var(--glass-border-color);
            color: var(--text-color-white);
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 1.2rem;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }
        
        .close-interest-detail-btn:hover {
            transform: scale(1.1);
            background-color: var(--accent-color);
            color: #121212;
        }

        .interest-detail-fade-enter-active,
        .interest-detail-fade-leave-active {
            transition: opacity 0.4s ease, transform 0.4s cubic-bezier(0.25, 0.8, 0.25, 1);
        }
        .interest-detail-fade-enter-from,
        .interest-detail-fade-leave-to {
            opacity: 0;
            transform: translate(-50%, -50%) scale(0.9);
        }

        /* 动画 (只保留页脚的) */
        .anim-fade-in-up {
            opacity: 0;
            transform: translateY(30px);
            transition: opacity 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94),
                transform 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }

        .anim-fade-in-up.is-visible {
            opacity: 1;
            transform: translateY(0);
        }

        /* --- 页脚区域 --- */
        .footer-section {
            padding: 4rem 2rem 2rem;
            text-align: center;
            color: var(--text-color-darker);
            border-radius: 24px 24px 0 0;
        }

        html.light-theme .footer-section {
            --glass-bg: rgba(247, 248, 250, 0.7);
        }

        .footer-title {
            font-size: 1.5rem;
            margin-bottom: 1rem;
            color: var(--text-color-white);
        }

        .footer-subtitle {
            margin-bottom: 2.5rem;
        }

        .icon-links-bar {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 1rem 1.5rem;
            margin-bottom: 2.5rem;
        }

        .icon-link {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--text-color-darker);
            text-decoration: none;
            transition: color 0.3s ease;
        }

        .icon-link:hover {
            color: var(--text-color-white);
        }

        .icon-link svg {
            width: 18px;
            height: 18px;
        }

        .icon-link span {
            font-size: 0.9rem;
        }

        .info-links {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 0.5rem 1.5rem;
            margin-bottom: 1.5rem;
        }

        .info-links a {
            color: var(--text-color-darker);
            text-decoration: none;
            font-size: 0.85rem;
        }

        .info-links a:hover {
            color: var(--text-color-white);
        }

        .copyright-info {
            border-top: 1px solid var(--glass-border-color);
            padding-top: 1.5rem;
            font-size: 0.85rem;
            position: relative;
            transition: border-color 0.3s ease;
        }

        .copyright-info p {
            margin-bottom: 0.5rem;
        }

        .copyright-info .site-info-item {
            display: inline-block;
            margin: 0 0.5rem;
        }

        .theme-switcher {
            position: absolute;
            right: 0;
            top: 50%;
            transform: translateY(-50%);
            display: flex;
            gap: 0.5rem;
            background: var(--theme-switcher-bg);
            padding: 0.3rem;
            border-radius: 20px;
            transition: background-color 0.3s ease;
        }

        .theme-switcher button {
            background: none;
            border: none;
            color: var(--text-color-darker);
            cursor: pointer;
            padding: 0.3rem;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .theme-switcher button.active {
            background: var(--subscribe-btn-bg);
            color: white;
        }

        .theme-switcher svg {
            width: 14px;
            height: 14px;
        }

        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0; }
        }

        /* 响应式设计 */
        @media (max-width: 900px) {
            .hub-intro h2 { font-size: 2rem; }
            .hub-intro blockquote { font-size: 1.2rem; }
            .book-grid { grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); }
            .blog-panel-content { flex-direction: column; }
            .blog-sidebar {
                width: 100%;
                border-right: none;
                border-bottom: 1px solid var(--glass-border-color);
                padding-right: 0;
                padding-bottom: 1rem;
                margin-bottom: 1.5rem;
                height: auto;
                max-height: 50vh;
            }
            .blog-main { padding-left: 0; height: 50vh; }
        }
        @media (max-width: 768px) {
            .custom-player-controls .volume-control-wrapper { display: none; }
            .resume-header h1 { font-size: 2rem; }
            .resume-contact {
                gap: 0.5rem 1rem;
                flex-direction: column;
                align-items: flex-start;
                margin: 0 auto;
                max-width: 250px;
            }
        }
        @media (max-width: 600px) {
            .main-header { padding: 4px; }
            .header-nav a { margin: 0; padding: 0 0.75rem; }
            .home-container { padding: 1rem; }
            .info-card { padding: 2rem 1.5rem; border-radius: 1rem; }
            .copyright-info { text-align: left; padding-right: 60px; }
            .theme-switcher { top: 1.5rem; transform: none; }
            .hero-player-container { max-width: calc(100% - 40px); }
            .hub-grid { grid-template-columns: 1fr; }
            .book-grid { grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); gap: 1rem; }
        }
    </style>
</head>

<body>
    <canvas id="particle-canvas"></canvas>

    <div id="app">
        <header class="main-header glass-effect"
            :class="{ 'is-expanded': isHeaderExpanded, 'is-visible': isHeaderVisible }">
            <img src="icon/128.png" alt="导航头像" class="header-avatar"
                @click="toggleLoginModal" />
            <nav class="header-nav">
                 <a v-for="link in visibleNavLinks" :key="link.id" @click="handleNavClick(link.id)" :class="{ active: activeSection === link.id }">{{ link.text }}</a>
            </nav>
        </header>

        <div class="login-modal-overlay" :class="{'is-visible': isLoginModalVisible}" @click.self="toggleLoginModal">
            <div class="login-modal-container">
                <div class="home-container">
                    <div class="info-card glass-effect">
                        <form @submit.prevent="handleLogin" class="admin-login-form">
                            <h3>管理员登录</h3>
                            <p class="login-status-message" :class="loginStatus.type">{{ loginStatus.message }}</p>
                            <div class="form-group">
                                <label for="username">用户名</label>
                                <input type="text" id="username" v-model="username" required />
                            </div>
                            <div class="form-group">
                                <label for="password">密码</label>
                                <input type="password" id="password" v-model="password" required />
                            </div>
                            <button type="submit" class="login-button" :disabled="isLoggingIn">
                                {{ isLoggingIn ? '登录中...' : '登录' }}
                            </button>
                        </form>
                    </div>
                </div>
            </div>
        </div>

        <div class="scroll-indicator" :class="{ 'is-scrolling': isScrolling }">
            <div class="scroll-star" :style="{ transform: `translateY(calc(100vh * ${scrollProgress} - 50%))` }"></div>
        </div>

        <main class="main-content">
            <section class="initial-hero-section" id="initial-hero" data-section="hero">
                <div class="hero-text-container">
                    <p>
                        {{ heroLine1 }}<span v-if="heroLine1Active" class="waving-hand">👋</span>
                    </p>
                    <p>
                        {{ heroLine2 }}<span v-if="heroLine2Active" class="typing-cursor-hero"></span>
                    </p>
                    <p>
                        {{ heroLine3 }}<span v-if="heroLine3Active" class="typing-cursor-hero"></span>
                    </p>
                    <p>
                        {{ heroLine4 }}<span v-if="heroLine4Active" class="typing-cursor-hero"></span>
                    </p>
                </div>
                <div class="hero-bottom-content" :class="{ visible: showHeroButtons }">
                    <div class="hero-socials">
                        <a :href="github.spaceUrl" target="_blank" aria-label="GitHub Profile" title="GitHub" class="glass-effect"><svg role="img"
                                viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" fill="currentColor">
                                <title>GitHub</title>
                                <path
                                    d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22v3.29c0 .316.19.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12" />
                            </svg></a>
                        <a href="https://space.bilibili.com/520237303" target="_blank" aria-label="Bilibili Profile" title="Bilibili"
                            class="glass-effect"><svg width="24" height="24" viewBox="0 0 24 24"
                                xmlns="http://www.w3.org/2000/svg" fill="currentColor">
                                <g>
                                    <path fill="none" d="M0 0h24v24H0z" />
                                    <path
                                        d="M18.223 3.086a1.25 1.25 0 0 1 0 1.768L17.08 5.996h1.17A3.75 3.75 0 0 1 22 9.747v7.5a3.75 3.75 0 0 1-3.75 3.75H5.75A3.75 3.75 0 0 1 2 17.247v-7.5a3.75 3.75 0 0 1 3.75-3.75h1.166L5.775 4.855a1.25 1.25 0 1 1 1.767-1.768l2.652 2.652c.079.079.145.165.198.257h3.213c.053-.092.12-.18.199-.258l2.651-2.652a1.25 1.25 0 0 1 1.768 0zm.027 5.42H5.75a1.25 1.25 0 0 0-1.247 1.157l-.003.094v7.5c0 .659.51 1.199 1.157 1.246l.093.004h12.5a1.25 1.25 0 0 0 1.247-1.157l.003-.093v-7.5c0-.69-.56-1.25-1.25-1.25zm-10 2.5c.69 0 1.25.56 1.25 1.25v1.25a1.25 1.25 0 1 1-2.5 0v-1.25c0-.69.56-1.25 1.25-1.25zm7.5 0c.69 0 1.25.56 1.25 1.25v1.25a1.25 1.25 0 1 1-2.5 0v-1.25c0-.69.56-1.25 1.25-1.25z" />
                                </g>
                            </svg></a>
                        <a href="https://wpa.qq.com/msgrd?v=3&uin=1723749425&site=qq&menu=yes" aria-label="Contact via QQ" title="QQ:1723749425"
                            class="glass-effect">
                            <svg viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg" fill="currentColor">
                                <path
                                    d="M29.11 26.278c-0.72 0.087-2.804-3.296-2.804-3.296 0 1.959-1.009 4.515-3.191 6.362 1.052 0.325 3.428 1.198 2.863 2.151-0.457 0.772-7.844 0.493-9.977 0.252-2.133 0.24-9.52 0.519-9.977-0.252-0.565-0.953 1.807-1.826 2.861-2.151-2.182-1.846-3.191-4.403-3.191-6.362 0 0-2.083 3.384-2.804 3.296-0.335-0.041-0.776-1.853 0.584-6.231 0.641-2.064 1.375-3.78 2.509-6.611-0.191-7.306 2.828-13.435 10.016-13.435 7.109 0.001 10.197 6.008 10.017 13.435 1.132 2.826 1.869 4.553 2.509 6.611 1.361 4.379 0.92 6.191 0.584 6.231z" />
                            </svg>
                        </a>
                        <a href="mailto:luckyshuixin@qq.com" aria-label="Send Email" title="Email:luckyshuixin@qq.com" class="glass-effect"><svg
                                xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                                <path d="M2.003 5.884L10 9.882l7.997-3.998A2 2 0 0016 4H4a2 2 0 00-1.997 1.884z" />
                                <path d="M18 8.118l-8 4-8-4V14a2 2 0 002 2h12a2 2 0 002-2V8.118z" />
                            </svg></a>
                    </div>

                    <div class="hero-player-container">
                        <transition name="player-fade">
                             <p v-if="player.error" class="error-message">{{ player.error }}</p>
                            <button v-else-if="!player.isInitialized && !player.isLoading" @click="switchSonglist(currentSongId)"
                                aria-label="播放音乐" class="play-button glass-effect">
                                <i class="ph-fill ph-play"></i>
                            </button>
                        </transition>
                        <transition name="player-fade">
                            <div v-if="player.isLoading" class="loading-spinner"></div>
                        </transition>

                        <transition name="player-fade">
                            <div class="player-wrapper glass-effect" v-if="player.isInitialized">
                                <div id="player" class="custom-player">
                                    <img :src="player.currentSong.cover" alt="Song Cover" class="custom-player-cover" />
                                    <div class="custom-player-info-wrapper">
                                        <div class="custom-player-info">
                                            <div class="custom-player-title">
                                                {{ player.currentSong.name }}
                                            </div>
                                            <div class="custom-player-artist">
                                                {{ player.currentSong.artist }}
                                            </div>
                                        </div>
                                        <div class="custom-player-progress-container" @click="seek">
                                            <div class="custom-player-progress-bar"
                                                :style="{ width: player.progress + '%' }"></div>
                                        </div>
                                    </div>
                                    <div class="custom-player-controls">
                                        <div class="volume-control-wrapper">
                                            <i class="ph-fill"
                                                :class="player.volume > 0.5 ? 'ph-speaker-high' : player.volume > 0 ? 'ph-speaker-low' : 'ph-speaker-slash'"></i>
                                            <input type="range" class="volume-slider" min="0" max="1" step="0.01"
                                                v-model="player.volume" @input="setVolume"
                                                :style="{'--volume-percent': player.volume * 100 + '%'}" aria-label="音量控制" />
                                        </div>
                                        <button @click="toggleShuffle" :class="{ 'active': player.isShuffle }" aria-label="随机播放" title="随机播放">
                                            <i class="ph-fill ph-shuffle"></i>
                                        </button>
                                        <button @click="toggleLoop" :aria-label="loopModeTooltip" :title="loopModeTooltip">
                                            <i class="ph-fill" :class="loopModeIcon"></i>
                                        </button>
                                         <button @click="cyclePlaybackRate" class="playback-rate-btn" :aria-label="'播放速度: ' + player.playbackRate.toFixed(2) + 'x'" :title="'播放速度: ' + player.playbackRate.toFixed(2) + 'x'">
                                            {{ player.playbackRate.toFixed(1) }}x
                                        </button>
                                        <button @click="player.aplayer.skipBack()" aria-label="上一首">
                                            <i class="ph-fill ph-skip-back"></i>
                                        </button>
                                        <button @click="player.aplayer.toggle()" :aria-label="player.isPlaying ? '暂停' : '播放'">
                                            <i :class="player.isPlaying ? 'ph-fill ph-pause' : 'ph-fill ph-play'"></i>
                                        </button>
                                        <button @click="player.aplayer.skipForward()" aria-label="下一首">
                                            <i class="ph-fill ph-skip-forward"></i>
                                        </button>
                                        <button @click="togglePlaylist" aria-label="播放列表">
                                            <i class="ph-fill ph-list"></i>
                                        </button>
                                        <button @click="toggleSonglistSwitcher" aria-label="切换歌单">
                                            <i class="ph-fill ph-stack"></i>
                                        </button>
                                    </div>
                                </div>
                                <div ref="lrcContainer" class="custom-lrc-container"></div>

                                <div class="playlist-container" :class="{ show: player.isPlaylistVisible }">
                                    <div v-for="(song, index) in player.playlist" :key="song.url" class="playlist-item"
                                        :class="{ active: player.currentSong.url === song.url }"
                                        @click="player.aplayer.list.switch(index)">
                                        <span class="index">{{ index + 1 }}</span>
                                        <div class="info">
                                            <div class="title">{{ song.name }}</div>
                                            <div class="artist">{{ song.artist }}</div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="songlist-switcher" :class="{ show: player.isSongSwitcherVisible }">
                                    <h4>预设歌单</h4>
                                    <ul class="songlist-presets">
                                        <li v-for="list in presetSonglists" :key="list.id" @click="switchSonglist(list.id)" :class="{active: list.id === currentSongId}">
                                            <span>{{ list.name }}</span>
                                        </li>
                                    </ul>
                                    <h5 v-if="customSonglists.length > 0">我的歌单</h5>
                                    <ul class="songlist-custom" v-if="customSonglists.length > 0">
                                        <li v-for="list in customSonglists" :key="list.id" @click="switchSonglist(list.id)" :class="{active: list.id === currentSongId}">
                                            <span>{{ list.name }}</span>
                                            <button @click.stop="removeCustomSonglist(list.id)" class="remove-btn" title="删除这个歌单">
                                                <i class="ph ph-x"></i>
                                            </button>
                                        </li>
                                    </ul>
                                    <div class="songlist-input-group">
                                        <div class="songlist-input-row">
                                            <input type="text" name="songlist-id" v-model="newSongIdInput" placeholder="歌单ID (纯数字)" @keydown.enter.prevent="addAndSwitchSonglist">
                                            <input type="text" name="songlist-name" v-model="newSongNameInput" placeholder="歌单名称 (可选)" @keydown.enter.prevent="addAndSwitchSonglist">
                                        </div>
                                        <button @click="addAndSwitchSonglist">添加并播放</button>
                                    </div>
                                </div>
                            </div>
                        </transition>
                        <div id="player-hidden"></div>
                    </div>
                </div>
            </section>

            <section id="about" class="content-section" data-section="about">
                <div class="about-us-card content-card glass-effect anim-fade-in-up">
                    <div class="about-sidebar">
                        <div class="sidebar-text">MAY YOU ALWAYS SHINE</div>
                        <div class="sidebar-line"></div>
                    </div>
                    <div class="about-main-content">
                        <h2>我的愿景</h2>
                        <blockquote>
                            「我便是世上的美好，永远闪耀。」
                        </blockquote>
                        <h3>关于我</h3>
                        <p>
                            <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;因为想做CG动画，我把Blender、虚幻引擎UE5、Unity、Maya等各种三维软件折腾了三年。最后发现我的小破笔记本根本带不动（哭），然后给老米做二创去了。也误打误撞做了up主。
                            因为想搭建个人网站，我也把前端vue3框架、three.js，后端springboot、django、flask又折腾了三年，然后做出了这个网站（小垃圾）。
                            包括神经网络transformer框架、爬虫，也多多少少折腾了一两年，然后在github开源的一个小项目（小垃圾）。
                            以及电子DIY，Arduino、树莓派、ESP32等各种电子元器件，折腾了一年。
                        </p>
                        <p>
                            <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;除了这些技术性的东西，在体育类，我爱好健身，打网球。
                            健身从大一开始，到现在。我觉得这是我大学做得最成功的一件事。不为别的，单我这每天默默宿舍健身、动不动就拉着床杆子做引体、拿着哑铃打拳、往垫子上一躺就开始鱼跃龙门、一天不练浑身难受的毅力，我自己的佩服我自己。
                            导致我每天都要洗澡（有点费钱哈哈哈哈哈哈哈哈哈哈），但身强体壮、健健康康，比什么都好。
                            网球，我不知道，反正每次选课，列表一拉，就看它顺眼。
                        </p>
                        <p>
                            <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;艺术类，音律算艺术嘛？我喜欢竹笛，因为一首曲子，<a style="color: var(--accent-color); font-weight: 500;text-shadow: 1px 1px 3px rgba(0,0,0,0.15);text-decoration: none;" href="https://c6.y.qq.com/base/fcgi-bin/u?__=izYgYCXRSjyl " target="_blank">陈致逸/HOYO-MiX《Clear Sky Over Liyue 璃月的晴空》</a>。
                            于是我买了竹笛，但被舍友嫌弃了呜呜呜。
                            除了这个，最近还在研究摄影构图，主要为了做动画找灵感。
                            还有服装设计，因为我觉得现在的服装都太丑了。
                        </p>
                        <p>
                            <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;最近在看心理学的书，主要是社会心理学。别问为什么，自从上了大学，越来越觉得人不是一个物种。
                            也在看《本草纲目》，药理是个好东西，适合养生。
                            也看言情小说，嗯，《白色橄榄树》挺不错的，某人推给我的。
                            还有新海诚的影片，喜欢画风和故事。
                            嗯，纯爱战士。
                        </p>
                        <p>
                            <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;我很喜欢一句话“<a style="color: var(--accent-color); font-weight: 500;text-shadow: 1px 1px 3px rgba(0,0,0,0.15);text-decoration: none;" href="https://www.bilibili.com/video/BV1Kj411g7Lu" target="_blank">May you,the beauty of this world,always shine.</a>”,
                            来自崩坏3的毕业旅行。
                            虽然没有那样的旅行，没有那样的经历，但在我自己的路上，我便是世界上的美好，永远闪耀。
                        </p>
                        <div class="rd-philosophy">
                            <h3>喜欢</h3>
                            <p>
                                凡人修仙传 | 新海诚风格 | HOYO-MiX | Something Out of Imagination
                            </p>
                        </div>
                    </div>
                </div>
            </section>
                        

            <section id="interactive-journey" data-section="hub">
                <transition name="panel-fade" mode="out-in">
                    <div class="journey-hub" v-if="!activeJourneyPanel" key="journey-hub">
                         <div class="hub-intro">
                            <h2>关于我</h2>
                            <blockquote>
                               「 <strong>May you, the beauty of this world, always shine.</strong> 」
                            </blockquote>
                        </div>
                        <transition-group 
                            tag="div" 
                            class="hub-grid" 
                            appear
                            @before-enter="onBeforeEnter"
                            @enter="onEnter"
                        >
                            <div 
                                class="hub-node" 
                                v-for="(node, index) in hubNodes"
                                :key="node.id"
                                :data-index="index"
                                @click="openJourneyPanel(node.id)"
                            >
                                <i :class="node.icon"></i>
                                <h3>{{ node.title }}</h3>
                                <p>{{ node.text }}</p>
                            </div>
                        </transition-group>
                    </div>

                    <div v-else key="journey-panels">
                        <div id="resume-panel" class="journey-panel" v-if="activeJourneyPanel === 'resume'">
                            <div class="content-card glass-effect">
                                <button @click="closeJourneyPanel" class="close-panel-btn" aria-label="关闭面板" title="关闭"><i class="ph ph-x"></i></button>
                                <div class="resume-header">
                                    <h1>{{ resumeData.name }}</h1>
                                    <div class="resume-contact">
                                        <span class="resume-contact-item"><i class="ph-fill ph-phone"></i> {{ resumeData.phone }}</span>
                                        <span class="resume-contact-item"><i class="ph-fill ph-envelope-simple"></i> {{ resumeData.email }}</span>
                                        <span class="resume-contact-item"><i class="ph-fill ph-map-pin"></i> {{ resumeData.location }}</span>
                                        <span class="resume-contact-item"><i class="ph-fill ph-flag"></i> {{ resumeData.politicalStatus }}</span>
                                    </div>
                                </div>
                                <div class="resume-section">
                                    <h3><i class="ph-fill ph-graduation-cap"></i> 教育背景</h3>
                                    <div class="education-grid">
                                        <div class="education-item" v-for="edu in resumeData.education">
                                            <div class="item-header">
                                                <h4>{{ edu.institution }}</h4>
                                                <span class="date">{{ edu.duration }}</span>
                                            </div>
                                            <p class="item-subheader">{{ edu.major }} | 辅修: {{ edu.minor }}</p>
                                            <div class="item-details">
                                                <ul>
                                                    <li>GPA: {{ edu.gpa }} | 专业成绩: {{ edu.majorScore }} (排名 {{ edu.ranking }})</li>
                                                    <li>主修课程: {{ edu.courses.major.join('、') }}</li>
                                                    <li>辅修课程: {{ edu.courses.minor.join('、') }}</li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="resume-section">
                                    <h3><i class="ph-fill ph-kanban"></i> 项目经历</h3>
                                    <div class="experience-grid">
                                        <div class="project-item" v-for="proj in resumeData.projects">
                                            <div class="item-header">
                                                <h4>{{ proj.name }}</h4>
                                                <span class="date">{{ proj.duration }}</span>
                                            </div>
                                            <p class="item-subheader">角色: {{ proj.role }}</p>
                                            <div class="item-details">
                                                <p><strong>任务:</strong> {{ proj.task }}</p>
                                                <p><strong>行动:</strong> {{ proj.action }}</p>
                                                <p><strong>结果:</strong> {{ proj.result }}</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="resume-section">
                                    <h3><i class="ph-fill ph-users"></i> 在校经历</h3>
                                    <div class="experience-grid">
                                         <div class="experience-item" v-for="exp in resumeData.campusExperience">
                                            <div class="item-header">
                                                <h4>{{ exp.role }}</h4>
                                                <span class="date">{{ exp.duration }}</span>
                                            </div>
                                            <div class="item-details">
                                                <p>{{ exp.description }}</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="resume-section">
                                    <h3><i class="ph-fill ph-brain"></i> 相关技能</h3>
                                    <div class="skills-container">
                                        <div class="skill-category" v-for="cat in resumeData.skills">
                                            <h4>{{ cat.category }}</h4>
                                            <div class="skill-list">
                                                <span class="skill-tag" v-for="skill in cat.items">{{ skill }}</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="resume-section">
                                    <h3><i class="ph-fill ph-trophy"></i> 荣誉证书</h3>
                                    <div class="honors-list">
                                        <div class="honor-item" v-for="honor in resumeData.honors">
                                            <i class="ph-fill ph-seal-check"></i>
                                            <span>{{ honor }}</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                         <div id="creations-panel" class="journey-panel" v-if="activeJourneyPanel === 'creations'">
                             <div class="content-card glass-effect">
                                <button @click="closeJourneyPanel" class="close-panel-btn" aria-label="关闭面板" title="关闭"><i class="ph ph-x"></i></button>
                                <h2>创造与知识</h2>
                                <div v-if="github.error" class="error-message">{{ github.error }}</div>
                                <div class="panel-content-grid">
                                    <div>
                                        <h3><i class="ph-fill ph-github-logo"></i> 我的 Github</h3>
                                        <img :src="github.contributionsUrl" alt="Github Contributions" class="github-contributions"
                                            :style="{ filter: currentTheme === 'dark' ? 'invert(1)' : 'invert(0)' }" />
                                        <div class="repo-grid" v-if="github.repos.length">
                                            <a v-for="repo in github.repos" :key="repo.id" :href="repo.html_url" target="_blank"
                                                class="repo-card">
                                                <h3>{{ repo.name }}</h3>
                                                <p>{{ repo.description || '暂无描述' }}</p>
                                                <div class="repo-stats">
                                                    <span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                                                            <path fill-rule="evenodd"
                                                                d="M10.868 2.884c.321.64.321 1.393 0 2.034a.985.985 0 01-1.737 0c.321-.64.321-1.393 0-2.034a.985.985 0 011.737 0zM12 12.5a.5.5 0 01.5.5v1a.5.5 0 01-1 0v-1a.5.5 0 01.5-.5zM10.5 6a.5.5 0 00-1 0v6a.5.5 0 001 0V6z"
                                                                clip-rule="evenodd" />
                                                            <path
                                                                d="M10 18a8 8 0 100-16 8 8 0 000 16zm0-1.5a6.5 6.5 0 110-13 6.5 6.5 0 010 13z" />
                                                        </svg>
                                                        {{ repo.language || 'Text' }}</span>
                                                    <span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                                                            <path
                                                                d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z" />
                                                        </svg>
                                                        {{ repo.stargazers_count }}</span>
                                                    <span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                                                            <path fill-rule="evenodd"
                                                                d="M15.312 5.312l-1.422 1.422L12 8.156l-1.89-1.89a.75.75 0 00-1.06 1.061l1.89 1.89-1.422 1.422-1.89-1.89a.75.75 0 10-1.06 1.06l1.89 1.89-1.422 1.422-1.89-1.89a.75.75 0 10-1.06 1.06l1.89 1.89-1.422 1.422a.75.75 0 101.06 1.06L9.89 13.94l1.422-1.422 1.89 1.89a.75.75 0 101.06-1.06l-1.89-1.89 1.422-1.422 1.89 1.89a.75.75 0 101.06-1.06l-1.89-1.89 1.422-1.422a.75.75 0 10-1.06-1.06z"
                                                                clip-rule="evenodd" />
                                                        </svg>
                                                        {{ repo.forks_count }}</span>
                                                </div>
                                            </a>
                                        </div>
                                        <p v-else-if="!github.error">正在加载Github仓库...</p>
                                    </div>
                                    <div>
                                        <h3><i class="ph-fill ph-books"></i> 我的笔记</h3>
                                        <div class="book-grid">
                                            <a v-for="book in bookshelf" :key="book.title" :href="book.url" target="_blank" class="book-card">
                                                <img :src="book.coverUrl" :alt="book.title" class="book-cover" @error="handleImgError" />
                                                <h3>{{ book.title }}</h3>
                                                <p>{{ book.author }}</p>
                                            </a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="blog-panel" class="journey-panel" v-if="activeJourneyPanel === 'blog'">
                            <div class="content-card glass-effect">
                                <button @click="closeJourneyPanel" class="close-panel-btn" aria-label="关闭面板" title="关闭"><i class="ph ph-x"></i></button>
                                <h2>我的文章</h2>
                                <div class="blog-panel-content">
                                    <div class="blog-sidebar">
                                        <div class="blog-category-filter">
                                            <button v-for="category in blogCategories" :key="category" @click="activeCategory = category" :class="{ active: activeCategory === category }">
                                                {{ category }}
                                            </button>
                                        </div>
                                        <div class="blog-post-list-container">
                                            <div v-for="post in filteredBlogPosts" :key="post.id" 
                                                 @click="activePostId = post.id"
                                                 class="blog-post-item"
                                                 :class="{ active: post.id === activePostId }">
                                                <h4>{{ post.title }}</h4>
                                                <p>{{ post.date }}</p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="blog-main">
                                        <div v-if="activePost" class="blog-post-content">
                                            <h2>{{ activePost.title }}</h2>
                                            <p class="blog-post-meta">发布于 {{ activePost.date }} | 分类: {{ activePost.category }}</p>
                                            <div class="blog-post-body" v-html="renderMarkdown(activePost.content)"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="growth-panel" class="journey-panel" v-if="activeJourneyPanel === 'growth'">
                             <div class="content-card glass-effect" ref="growthPanelRef">
                                <button @click="closeJourneyPanel" class="close-panel-btn" aria-label="关闭面板" title="关闭"><i class="ph ph-x"></i></button>
                                <h2>成长之路</h2>
                                <div class="panel-content-grid">
                                    <div>
                                        <h3><i class="ph-fill ph-calendar-blank"></i> 时光</h3>
                                        <div class="timeline">
                                            <div class="timeline-item" v-for="item in timeline" :key="item.date">
                                                <div class="timeline-date">{{ item.date }}</div>
                                                <p class="timeline-desc">{{ item.event }}</p>
                                            </div>
                                        </div>
                                    </div>
                                    <div>
                                        <h3><i class="ph-fill ph-flag-checkered"></i> 目标进度</h3>
                                        <div class="target-list">
                                            <div v-for="target in targetsWithProgress" :key="target.name" class="target-item">
                                                <div class="target-info">
                                                    <span class="target-name">{{ target.name }}</span>
                                                    <span class="target-progress-text">{{ target.animatedCurrent }} / {{ target.total }}</span>
                                                </div>
                                                <div class="progress-bar-container">
                                                    <div class="progress-bar"></div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="interests-panel" class="journey-panel" v-if="activeJourneyPanel === 'interests'">
                            <div class="content-card glass-effect">
                                <button @click="closeJourneyPanel" class="close-panel-btn" aria-label="关闭面板" title="关闭"><i class="ph ph-x"></i></button>
                                <h2>兴趣星系</h2>
                                <div class="interest-galaxy-container" :class="{ 'detail-view-active': selectedInterest }">
                                    <transition name="interest-detail-fade">
                                        <div v-if="selectedInterest" class="interest-detail-card glass-effect">
                                            <img :src="selectedInterest.image" :alt="selectedInterest.title" class="interest-detail-image" @error="handleImgError" />
                                            <div class="interest-detail-content">
                                                <h3>{{ selectedInterest.title }}</h3>
                                                <p>{{ selectedInterest.content }}</p>
                                            </div>
                                            <button @click="selectedInterest = null" class="close-interest-detail-btn" aria-label="返回兴趣星系" title="返回"><i class="ph ph-arrow-arc-left"></i></button>
                                        </div>
                                    </transition>
                                     <div class="interest-galaxy">
                                        <svg class="galaxy-lines">
                                            <path v-for="line in galaxyLines" :key="line.id" :d="line.d"></path>
                                        </svg>
                                        <div
                                            v-for="(interest, index) in interests"
                                            :key="interest.id"
                                            class="interest-node"
                                            :class="{ 'is-center': interest.isCenter }"
                                            :style="getInterestNodeStyle(interest)"
                                            @click="selectedInterest = interest"
                                        >
                                            <i :class="interest.icon"></i>
                                            <span class="interest-node-title">{{ interest.title }}</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="chatbot-panel" class="journey-panel" v-if="activeJourneyPanel === 'chatbot'">
                            <div class="content-card glass-effect chatbot-card">
                                <button @click="closeJourneyPanel" class="close-panel-btn" aria-label="关闭面板" title="关闭"><i class="ph ph-x"></i></button>
                                <h2>AI 对话</h2>
                                <div class="chatbot-settings">
                                    <div class="setting-item api-key-group">
                                        <label for="apiKey">
                                            <span>API Key</span>
                                            <a href="https://platform.deepseek.com/api_keys" target="_blank"
                                                class="get-api-key-link">获取API Key</a>
                                        </label>
                                        <input id="apiKey" type="password" v-model="chatbot.apiKey"
                                            placeholder="输入你的 DeepSeek API Key" />
                                    </div>
                                    <div class="setting-item">
                                        <label for="temperature">
                                            <span>温度: {{ chatbot.temperature }}</span>
                                            <i class="ph ph-info tooltip-icon" title="仅在关闭深度思考时有效。
代码生成/数学解题: 0.0
数据抽取/分析: 1.0
通用对话/翻译: 1.3
创意类写作: 1.5">
                                            </i>
                                        </label>
                                        <input id="temperature" type="range" v-model="chatbot.temperature" min="0" max="2"
                                            step="0.1" :disabled="chatbot.use_deep_thinking" />
                                    </div>
                                     <div class="setting-item custom-toggle">
                                        <label for="deepThinking">深度思考</label>
                                        <div class="toggle-switch" :class="{ active: chatbot.use_deep_thinking }"
                                            @click="chatbot.use_deep_thinking = !chatbot.use_deep_thinking" role="switch" :aria-checked="chatbot.use_deep_thinking">
                                            <div class="toggle-knob"></div>
                                        </div>
                                    </div>
                                     <div class="setting-item chat-history-group">
                                        <label>对话历史</label>
                                        <div class="history-controls">
                                            <div class="chat-history-dropdown" ref="dropdownRef">
                                                <button @click="isHistoryDropdownOpen = !isHistoryDropdownOpen" class="dropdown-trigger" aria-haspopup="true" :aria-expanded="isHistoryDropdownOpen">
                                                    <span>{{ activeChat ? activeChat.title : '选择对话' }}</span>
                                                    <i class="ph-fill ph-caret-down"></i>
                                                </button>
                                                <transition name="dropdown-fade">
                                                    <ul v-if="isHistoryDropdownOpen" class="dropdown-menu glass-effect" role="menu">
                                                        <li v-for="chat in chatHistories" :key="chat.id" 
                                                            @click="selectChat(chat.id)"
                                                            class="dropdown-item" 
                                                            role="menuitem"
                                                            :class="{ active: chat.id === activeChatId }">
                                                            {{ chat.title }}
                                                        </li>
                                                    </ul>
                                                </transition>
                                            </div>
                                            <button @click="createNewChat" class="history-btn" aria-label="新建对话" title="新建对话"><i class="ph ph-plus"></i></button>
                                            <button @click="deleteActiveChat" class="history-btn" aria-label="删除当前对话" title="删除当前对话"><i class="ph ph-trash"></i></button>
                                        </div>
                                    </div>
                                </div>
                                <div class="chat-window" ref="chatWindow">
                                    <div v-if="activeChat">
                                        <div v-for="message in activeChat.messages" :key="message.id" class="message"
                                            :class="message.role">
                                            <div v-if="message.role !== 'system'" class="message-content">
                                                <div v-if="message.thinking" class="thinking-process-container">
                                                    <button class="toggle-thinking-btn" @click="message.isThinkingVisible = !message.isThinkingVisible">
                                                        <i class="ph-fill" :class="message.isThinkingVisible ? 'ph-caret-down' : 'ph-caret-right'"></i>
                                                        <span>思考过程</span>
                                                    </button>
                                                    <div v-show="message.isThinkingVisible" class="thinking-process-content" v-html="renderMarkdown(message.thinking)"></div>
                                                </div>
                                                
                                                <div v-if="chatbot.isLoading && activeChat.messages[activeChat.messages.length - 1].id === message.id && !message.content && !message.thinking"
                                                    style="display: flex; align-items: center; justify-content: center; height: 1.6em;">
                                                    <span class="typing-cursor-hero"
                                                        style="height: 1.2em; background-color: var(--text-color);"></span>
                                                </div>
                                                <div v-else v-html="renderMarkdown(message.content)"></div>
                                                
                                                <button v-if="message.content"
                                                    @click="copyToClipboard(message.content, $event)" class="copy-button" aria-label="复制消息" title="复制">
                                                    <i class="ph ph-copy"></i>
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div v-if="chatbot.status" class="chat-status">
                                    <i class="ph ph-spinner-gap animate-spin"></i>
                                    <span>{{ chatbot.status }}</span>
                                </div>

                                <form @submit.prevent="sendMessage" class="chat-input-area">
                                    <textarea v-model="chatbot.currentMessage" @keydown.enter.exact.prevent="sendMessage"
                                        placeholder="输入消息..."></textarea>
                                    <button type="submit" class="send-button"
                                        :disabled="chatbot.isLoading || !chatbot.apiKey">发送</button>
                                </form>
                            </div>
                        </div>
                    </div>
                </transition>
            </section>
        </main>

        <footer class="footer-section glass-effect anim-fade-in-up" id="footer" data-section="footer">
            <h4 class="footer-title">风向标</h4>
            <p class="footer-subtitle">去到别处看看？</p>
            <div class="icon-links-bar">
                <a v-for="link in footerIconLinks" :key="link.text" :href="link.url" class="icon-link">
                    <span v-html="link.icon"></span>
                    <span>{{ link.text }}</span>
                </a>
            </div>
            <div class="info-links">
                <a href="https://www.bilibili.com/video/BV1Kj411g7Lu">May you,the beauty of this world,always
                    shine.</a>
            </div>
            <div class="copyright-info">
                <p>
                    Copyright&copy;2022-2025 虚宁
                    <span class="site-info-item" v-if="siteUptime">| 站点已运行 {{ siteUptime }}</span>
                    <span class="site-info-item" v-if="icp">|
                        <a href="https://beian.miit.gov.cn/" target="_blank">{{ icp }}</a></span>
                </p>
                <div class="theme-switcher">
                    <button @click="setTheme('dark')" :class="{ active: currentTheme === 'dark' }" aria-label="切换到深色模式" title="深色模式">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                            <path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"></path>
                        </svg>
                    </button>
                    <button @click="setTheme('light')" :class="{ active: currentTheme === 'light' }" aria-label="切换到浅色模式" title="浅色模式">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                            <path fill-rule="evenodd"
                                d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zM3 11a1 1 0 100-2H2a1 1 0 100 2h1z"
                                clip-rule="evenodd"></path>
                        </svg>
                    </button>
                </div>
            </div>
        </footer>
    </div>
    
    <!-- 将非关键的JS库移至 body 底部并使用 defer，以优化页面加载性能 -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js" defer></script>
    <script src="https://unpkg.com/@phosphor-icons/web" defer></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/aplayer/1.10.1/APlayer.min.js" defer></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fetch-jsonp/1.3.0/fetch-jsonp.min.js" defer></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js" defer></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js" defer></script>

    <script>
        // --- 粒子动画逻辑 ---
        (function () {
            const canvas = document.getElementById("particle-canvas");
            if (!canvas) return;
            const ctx = canvas.getContext("2d");
            let particles = [];
            let animationFrameId;
            function resizeCanvas() {
                canvas.width = window.innerWidth;
                canvas.height = window.innerHeight;
            }
            class Particle {
                constructor() {
                    this.x = Math.random() * canvas.width;
                    this.y = Math.random() * canvas.height;
                    this.size = Math.random() * 2 + 1;
                    this.speedX = Math.random() * 1 - 0.5;
                    this.speedY = Math.random() * 1 - 0.5;
                }
                update() {
                    const isLightTheme =
                        document.documentElement.classList.contains("light-theme");
                    if (!isLightTheme) {
                        const centerX = canvas.width / 2;
                        const centerY = canvas.height / 2;
                        const dx = this.x - centerX;
                        const dy = this.y - centerY;
                        const distance = Math.sqrt(dx * dx + dy * dy);
                        if (distance > 1) {
                            const swirlStrength = 0.01;
                            this.speedX += (-dy / distance) * swirlStrength;
                            this.speedY += (dx / distance) * swirlStrength;
                        }
                        this.speedX *= 0.99;
                        this.speedY *= 0.99;
                    }
                    this.x += this.speedX;
                    this.y += this.speedY;
                    if (
                        this.x < 0 ||
                        this.x > canvas.width ||
                        this.y < 0 ||
                        this.y > canvas.height
                    ) {
                        this.x = Math.random() * canvas.width;
                        this.y = Math.random() * canvas.height;
                        this.speedX = Math.random() * 1 - 0.5;
                        this.speedY = Math.random() * 1 - 0.5;
                    }
                }
                draw() {
                    const isLightTheme =
                        document.documentElement.classList.contains("light-theme");
                    ctx.fillStyle = isLightTheme
                        ? "rgba(0, 0, 0, 0.4)"
                        : "rgba(255, 255, 255, 0.4)";
                    ctx.beginPath();
                    ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                    ctx.fill();
                }
            }
            function initParticles() {
                const particleCount = Math.floor(
                    (canvas.width * canvas.height) / 15000
                );
                particles = [];
                for (let i = 0; i < particleCount; i++) {
                    particles.push(new Particle());
                }
            }
            function handleParticles() {
                const isLightTheme =
                    document.documentElement.classList.contains("light-theme");
                const lineBaseColor = isLightTheme ? "0, 0, 0" : "255, 255, 255";
                for (let i = 0; i < particles.length; i++) {
                    particles[i].update();
                    particles[i].draw();
                    if (isLightTheme) {
                        for (let j = i + 1; j < particles.length; j++) {
                            const dx = particles[i].x - particles[j].x;
                            const dy = particles[i].y - particles[j].y;
                            const distance = Math.sqrt(dx * dx + dy * dy);
                            if (distance < 100) {
                                ctx.beginPath();
                                ctx.strokeStyle = `rgba(${lineBaseColor}, ${1 - distance / 100
                                    })`;
                                ctx.lineWidth = 0.5;
                                ctx.moveTo(particles[i].x, particles[i].y);
                                ctx.lineTo(particles[j].x, particles[j].y);
                                ctx.stroke();
                            }
                        }
                    }
                }
            }
            function animate() {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                handleParticles();
                animationFrameId = requestAnimationFrame(animate);
            }
            function startAnimation() {
                resizeCanvas();
                initParticles();
                if (animationFrameId) cancelAnimationFrame(animationFrameId);
                animate();
            }
            window.addEventListener("resize", startAnimation);
            startAnimation();
        })();

        // --- Vue.js 应用逻辑 ---
        const { createApp, ref, onMounted, onUnmounted, nextTick, watch, computed } = Vue;
        
        // --- API服务 ---
        const apiService = {
            async getMusicPlaylist(songId) {
                // 使用CORS代理来绕过浏览器的跨域安全限制
                const corsProxy = "https://corsproxy.io/?";

                const { VITE_SONG_API, VITE_SONG_SERVER, VITE_SONG_TYPE } = {
                    VITE_SONG_API: "https://api.injahow.cn/meting/", VITE_SONG_SERVER: "tencent",
                    VITE_SONG_TYPE: "playlist"
                };
                 if (!songId) {
                    throw new Error("必须提供歌单ID。");
                }
                const cleanApiUrl = VITE_SONG_API.endsWith('/') ? VITE_SONG_API.slice(0, -1) : VITE_SONG_API;
                const apiUrl = `${cleanApiUrl}?server=${VITE_SONG_SERVER}&type=${VITE_SONG_TYPE}&id=${songId}`;
                
                // 将代理服务器地址拼接到实际API地址前面
                const proxiedApiUrl = `${corsProxy}${encodeURIComponent(apiUrl)}`;
                
                const response = await fetch(proxiedApiUrl);
                if (!response.ok) throw new Error(`API请求失败: ${response.status}`);
                const data = await response.json();

                // 修正: 确保 data 是一个非空数组再继续
                if (!Array.isArray(data) || data.length === 0) {
                    console.error("收到的API响应不是一个有效的播放列表:", data);
                    throw new Error("播放列表为空或加载失败。");
                }
                
                // 检查是否需要通过 jsonp 解析真实 URL
                if (typeof data[0].url === 'string' && data[0].url.startsWith("@")) {
                    const [, , jsonpCallbackFunction, url] = data[0].url.split("@");
                    
                    // 直接调用 fetchJsonp，不使用代理，并增加超时处理
                    const jsonpData = await fetchJsonp(url, { jsonpCallbackFunction, timeout: 10000 })
                        .then(res => res.json())
                        .catch(err => {
                             console.error("JSONP request failed:", err);
                             throw new Error("解析歌曲链接超时或失败。");
                        });
                    
                    // 检查解析结果是否有效
                    if (!jsonpData.req_0 || !jsonpData.req_0.data || !jsonpData.req_0.data.midurlinfo) {
                        throw new Error("无法解析歌曲链接。");
                    }

                    const domain = (jsonpData.req_0.data.sip.find(i => !i.startsWith("http://ws")) || jsonpData.req_0.data.sip[0]).replace("http://", "https://");
                    
                    // 映射并过滤掉无效歌曲
                    const playableSongs = data
                        .map((songInfo, index) => {
                            const mediaInfo = jsonpData.req_0.data.midurlinfo[index];
                            // 确保歌曲信息和 p-url 都存在
                            if (mediaInfo && mediaInfo.purl) {
                                return {
                                    name: songInfo.name || songInfo.title,
                                    artist: songInfo.artist || songInfo.author,
                                    url: domain + mediaInfo.purl,
                                    cover: songInfo.cover || songInfo.pic,
                                    lrc: songInfo.lrc,
                                };
                            }
                            return null; // 无效歌曲返回 null
                        })
                        .filter(Boolean); // 过滤掉所有 null

                    // 如果过滤后列表为空，则抛出更具体的错误
                    if (playableSongs.length === 0) {
                        throw new Error("歌单中的歌曲均因版权或地区限制无法播放。");
                    }
                    
                    return playableSongs;
                }

                // 对于不需要额外解析的歌单，也进行一次过滤以防万一
                return data.map(v => ({
                    name: v.name || v.title, artist: v.artist || v.author, url: v.url, cover: v.cover || v.pic, lrc: v.lrc,
                })).filter(song => song.url);
            },
            async getGithubRepos() {
                // Github API正确配置了CORS，所以不需要代理
                const response = await fetch("https://api.github.com/users/jimmyshuixin/repos?sort=updated&per_page=6");
                if (!response.ok) throw new Error(`获取 Github 仓库失败: ${response.status}`);
                return response.json();
            }
        };
        // --- 静态数据模块 ---
        const useStaticData = () => {
            const resumeData = ref({
                name: '虚宁', phone: '***********', email: '******@njust.edu.cn', location: '重庆', politicalStatus: '中共预备党员',
                education: [{ institution: '南京理工大学', major: '辐射防护与核安全', minor: '人工智能', duration: '2022.09 - 2026.06', gpa: '3.62/4.0', majorScore: '87.365', ranking: '3/30', courses: { major: ['核辐射探测基础(95)', '核电子学与核技术原理(91)', '原子核物理学(96)', 'γ能谱分析(92)', '反应堆工程(91)', '放射化学(90)', '工程制图(95)', '量子力学(92)', '线性代数(92)', '高等数学(90)', '模拟电路与数字电路(88)'], minor: ['离散数学', '计算机网络', '数据结构', '计算机组成原理', '算法设计与分析', '机器学习', '图像处理与分析'] } }],
                projects: [{ name: '液闪放射性测量系统的光收集系统改进', role: '项目负责人', duration: '2024.06 - 2025.09', task: '主导项目，负责光电倍增管（PMT）供电模块和低噪声前置放大器设计，推进测量腔室及反射层改进。', action: '使用Multisim设计并模拟PMT CH253的电荷灵敏前置放大器；使用嘉立创EDA设计供PMT CH253和M2021的5V转-5V、±12V、±24V的DC-DC电源电路并完成所有电路的PCB布局和打板；最后亲自焊接电路板并使用DT5780多道分析器、实验仪器操作系统MC2Analyzer、以及示波器完成最后电路稳定性和可行性测试。', result: '供电模块为整个液闪放射性测量系统提供稳定的电源支持；电荷灵敏前置放大器稳定放大输出；通过实验优化了探测腔室的尺寸和反光材料，显著提高了探测效率。' }, { name: '基于LSTM/Transformer的空气质量(AQI)预测系统', role: '个人项目 / 建模大赛作品', duration: '2024.03 - 2025.06', task: '设计并实现一个完整的端到端空气质量指数（AQI）预测与展示系统，作为全国大学生统计建模大赛的参赛项目。', action: '使用 Scrapy 框架爬取历史天气与AQI数据；利用 Pandas 和 Numpy 进行数据清洗与预处理；基于 PyTorch 框架构建并训练 LSTM/Transformer预测模型；使用BOA/Optuna进行超参数优化；通过 Flask 搭建后端 API 服务；并采用 Vue.js 和 ECharts 开发了动态可视化的前端界面来展示历史数据与预测结果。', result: '成功实现了从数据采集、模型训练到前后端部署的全流程。该系统能够直观地展示指定城市的历史及未来空气质量趋势，并最终荣获全国大学生统计建模大赛三等奖。' }, { name: '基于Vue.js的个人网站', role: '项目负责人', duration: '2022.05 - 2025.01', task: '设计并实现一个个人网站，展示个人信息、项目经历、技能等内容。', action: '使用 Vue.js 框架开发前端界面，结合 Element Plus 组件库实现响应式设计；使用 Node.js 搭建后端服务，提供数据接口；使用 GitHub Actions 实现自动化部署。', result: '成功上线个人网站，提供了一个展示个人能力和项目经验的平台。' }],
                campusExperience: [{ role: '学习委员', duration: '2022.09 - 2026.06', description: '负责班级的学业辅导；建立线上、线下帮扶机制，提高班级平均分；目前班级整体水平位于年级前50%并取得南京理工大学“零挂科”班级荣誉称号。' }, { role: '校级学习导师', duration: '2024.03 - 2026.06', description: '负责全校工程制图课程的学业指导；定期开展线下集体辅导和答疑；任职期间本科目学生挂科率下降80%。' }, { role: '学院行政/年级助理', duration: '2022.09 - 2026.06', description: '负责年级文书处理、信息传递以及作为学生代表参与会议，熟悉行政流程，沟通协调能力强，获得师生广泛认可。' }],
                skills: [{ category: '电路设计', items: ['嘉立创EDA', 'Multisim'] }, { category: '编程开发', items: ['Python', 'LSTM', 'Transformer', 'Web全栈', 'Linux', '服务器运维'] }, { category: '多媒体', items: ['Blender', 'Pr', '剪映', '动画制作'] }, { category: '办公软件', items: ['Office三件套', 'WPS'] }],
                honors: ['国家励志奖学金', '全国大学生统计建模大赛三等奖', '“互联网+”大学生创新创业大赛三等奖', '南京理工大学一、二等奖学金（5次）', '校级“最美笔记”二等奖', '南京理工大学“三好学生”', '“社会活动积极分子”']
            });
            const timeline = ref([ { date: "2022-05-20", event: "项目启动，学习前端知识" }, { date: "2023-07-22", event: "学会用网页放烟花，但没人看。" }, { date: "2024-05-25", event: "学习后端知识，开始搭建网站后端。" }, { date: "2025-03-01", event: "开始搭建初代网站，使用 Vue.js 和其他现代前端技术。" }, { date: "2025-04-03", event: "网站上线，正式发布。" }, { date: "2025-05-01", event: "网站进行第一次大规模更新，增加了更多功能和内容。" }, { date: "2025-06-15", event: "网站进行第二次大规模更新，优化了用户体验和界面设计。" }, ]);
            const targets = ref([ { name: "搭建个人网站：前端基本完成，后端开发中", current: 60, total: 100 }, { name: "做动画：会二创了，深入学习中", current: 25, total: 100 }, { name: "健身：第三年，八块腹肌已成，增肌减脂中", current: 60, total: 100 }, { name: "学竹笛：现在吹得太难听了，道阻且长", current: 10, total: 100 }, ]);
            const bookshelf = ref([ { title: "放射化学", author: "虚宁", coverUrl: "icon/放射化学.png", url: "https://kdocs.cn/join/g2ouzur?f=101" }, { title: "辐射环境监测", author: "虚宁", coverUrl: "icon/辐射环境检测.png", url: "https://kdocs.cn/join/g2ouzur?f=101" }, { title: "辐射探测", author: "虚宁", coverUrl: "icon/辐射探测.png", url: "https://kdocs.cn/join/g2ouzur?f=101" }, { title: "模拟电路与数字电路", author: "虚宁", coverUrl: "icon/模拟电路与数字电路.png", url: "https://kdocs.cn/join/g2ouzur?f=101" }, { title: "原子核物理", author: "虚宁", coverUrl: "icon/原子核物理.png", url: "https://kdocs.cn/join/g2ouzur?f=101" }, { title: "核燃料", author: "虚宁", coverUrl: "icon/核燃料.png", url: "https://kdocs.cn/join/g2ouzur?f=101" }, ]);
            const blogPosts = ref([ { id: 1, title: "我的个人网站搭建之旅", date: "2025-06-15", category: "技术分享", content: `\n### 前言\n从一个简单的想法到如今这个功能丰富的个人主页，整个过程充满了挑战与收获。这篇文章记录了我是如何从零开始，一步步构建起这个网站的。\n\n### 技术选型\n最初，我只是想用纯 HTML/CSS/JS 来实现。但随着功能需求的增多，我发现直接操作 DOM 变得异常繁琐。因此，我引入了 **Vue.js 3**。\n- **视图层**: 我选择了 Vue 3 的 Composition API，它让组织复杂的逻辑变得非常清晰。\n- **UI**: 所有的样式都是手写的，大量使用了 CSS 变量来实现主题切换和玻璃拟物效果（Glassmorphism）。\n- **动画**: 背景是基于 Canvas 的粒子动画，而页面元素的交互动画则主要依赖 CSS Transitions 和 Animations。\n\n### 遇到的挑战\n1.  **音乐播放器**: 对接 QQ 音乐的 API 是一个难点。由于跨域问题，我不得不使用一个公共的 CORS 代理服务，这增加了不稳定因素。此外，解析 JSONP 格式的数据也花了一些时间研究。\n2.  **AI 对话流式响应**: 实现类似 ChatGPT 的打字机效果，需要处理服务器发送的 Server-Sent Events (SSE)。这意味着要逐块读取响应流，并实时更新到界面上，这对异步编程是一个很好的锻炼。\n3.  **性能优化**: Canvas 背景动画、大量的 DOM 元素和复杂的 CSS 对性能是个考验。我通过减少重绘、合理使用 \`requestAnimationFrame\` 以及对图片进行懒加载等方式进行了一些基础的优化。\n\n### 未来的计划\n- 将项目组件化，拆分成更小的、可复用的单元。\n- 引入一个更可靠的后端服务，替代目前的一些客户端解决方案。\n- 持续优化性能和可访问性。\n` }, { id: 2, title: "关于CSS的玻璃拟物效果", date: "2025-05-10", category: "前端开发", content: `\n### 什么是玻璃拟物？\n玻璃拟物（Glassmorphism）是一种UI设计趋势，它通过模糊、透明度和边框来模拟磨砂玻璃的效果。核心的CSS属性是 \`backdrop-filter: blur(px);\`。\n\n### 实现步骤\n要实现本站的卡片效果，你需要以下几个关键步骤：\n1.  **背景层**: 需要一个有内容的背景，这样模糊效果才能显现出来。本站使用的是 Canvas 动画背景。\n2.  **元素本身**:\n    -   设置一个半透明的背景色: \`background: rgba(255, 255, 255, 0.1);\`\n    -   应用背景模糊: \`backdrop-filter: blur(10px);\`\n    -   添加一个细微的边框来增强玻璃的轮廓感: \`border: 1px solid rgba(255, 255, 255, 0.2);\`\n    -   添加圆角和阴影，使其看起来更柔和、更有层次。\n\n\`\`\`css\n.glass-effect {\n    background: rgba(38, 38, 38, 0.25);\n    border: 1px solid rgba(255, 255, 255, 0.1);\n    border-radius: 24px;\n    box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.25);\n    backdrop-filter: blur(10px);\n    -webkit-backdrop-filter: blur(10px); /* For Safari */\n}\n\`\`\`\n### 注意事项\n\`backdrop-filter\` 属性的性能开销较大，不宜在页面上大面积或高频率地使用，尤其是在复杂的动画中。\n` }, { id: 3, title: "一篇生活随笔", date: "2025-04-20", category: "生活", content: `\n### 这是一篇关于生活的文章\n这篇文章主要是为了演示和测试新添加的 **分类功能**。\n\n通过点击侧边栏的“生活”按钮，你应该就能只看到这篇文章。点击“全部分类”则会显示所有的文章。\n\n这个功能让内容组织更加清晰，方便访客快速找到他们感兴趣的话题。\n` } ]);
            const interests = ref([ 
                { id: 5, title: '代码宇宙', icon: 'ph-fill ph-code', image: 'https://images.unsplash.com/photo-1542831371-29b0f74f9713?q=80&w=2070&auto=format&fit=crop', content: '将Web开发作为我的核心星球。我享受探索前端技术，用代码和设计将想法变为现实，构建连接信息与人的桥梁。', isCenter: true },
                { id: 1, title: '动画新星', icon: 'ph-fill ph-film-strip', image: 'https://images.unsplash.com/photo-1620673435193-a1293228965f?q=80&w=1974&auto=format&fit=crop', content: '我对动画充满热情，喜欢通过 Blender 和其他工具创造出生动的角色和故事。这是一个充满创造力和技术挑战的领域。' }, 
                { id: 2, title: '电子脉冲', icon: 'ph-fill ph-cpu', image: 'https://images.unsplash.com/photo-1555529699-6df35b449b29?q=80&w=2070&auto=format&fit=crop', content: '从焊接电路板到编写微控制器代码，我享受将电子元件组合在一起，创造出实用或有趣的小工具的过程。' }, 
                { id: 3, title: '力量星座', icon: 'ph-fill ph-barbell', image: 'https://images.unsplash.com/photo-1549060279-7e168fcee0c2?q=80&w=2070&auto=format&fit=crop', content: '保持身体健康是我生活的重要组成部分。定期的力量训练和有氧运动不仅能塑造体型，还能让我保持精力充沛。' }, 
                { id: 4, title: '旋律星云', icon: 'ph-fill ph-music-notes', image: 'https://images.unsplash.com/photo-1621215102663-5bd84d1a2936?q=80&w=2070&auto=format&fit=crop', content: '竹笛清脆悠扬的声音深深吸引着我。虽然仍在学习阶段，但我享受在练习中找到内心平静的每一刻。' }
            ]);
            const hubNodes = ref([ { id: 'resume', icon: 'ph-fill ph-user-list', title: '我的简历', text: '教育背景、项目经验与专业技能' }, { id: 'creations', icon: 'ph-fill ph-brain', title: '创造与知识', text: 'GitHub仓库与技术笔记' }, { id: 'blog', icon: 'ph-fill ph-pencil-line', title: '我的文章', text: '思考、分享与技术沉淀' }, { id: 'growth', icon: 'ph-fill ph-trend-up', title: '成长之路', text: '记录我的时光足迹与目标进度' }, { id: 'interests', icon: 'ph-fill ph-game-controller', title: '个人兴趣', text: '探索我工作之外的热情所在' }, { id: 'chatbot', icon: 'ph-fill ph-robot', title: 'AI 助手', text: '与我的智能助手进行对话' }, ]);
            const footerIconLinks = ref([ { text: "Blog", icon: '<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L6.832 19.82a4.5 4.5 0 01-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 011.13-1.897L16.863 4.487zm0 0L19.5 7.125" /></svg>', url: "https://blog.xvyin.com", }, { text: "看烟花", icon: '<svg version="1.0" xmlns="http://www.w3.org/2000/svg" width="1190.000000pt" height="1280.000000pt" viewBox="0 0 1190.000000 1280.000000" preserveAspectRatio="xMidYMid meet"><g transform="translate(0.000000,1280.000000) scale(0.100000,-0.100000)" fill="currentColor" stroke="none"><path d="M6522 12711 c-488 -368 -825 -811 -986 -1298 -32 -96 -13 -89 -193 -65 l-121 17 -182 220 c-101 121 -185 219 -188 218 -2 -1 -60 -117 -127 -259 l-122 -257 -264 -105 c-145 -58 -266 -107 -269 -109 -5 -4 22 -30 270 -266 l144 -137 18 -252 c9 -139 17 -270 17 -291 l1 -39 46 27 c25 15 50 23 54 19 4 -5 19 -41 33 -80 14 -40 77 -199 140 -355 139 -343 194 -495 237 -655 29 -107 35 -121 52 -116 25 6 31 24 54 152 28 158 26 457 -5 600 -41 194 -130 392 -237 532 l-43 57 62 34 c132 74 98 72 331 12 114 -29 209 -55 211 -57 2 -2 20 -87 40 -188 61 -306 123 -517 168 -568 8 -10 31 -57 52 -107 39 -97 177 -387 181 -383 1 2 -4 55 -11 118 -30 266 -40 466 -40 840 1 439 17 658 75 1005 109 640 351 1260 678 1733 35 50 59 92 53 92 -6 0 -64 -40 -129 -89z"/><path d="M7293 12162 l-111 -116 -159 -10 c-87 -5 -159 -10 -161 -11 -1 -1 32 -67 74 -145 l77 -143 -40 -159 c-23 -87 -38 -158 -34 -158 4 0 68 11 142 24 74 14 143 26 155 28 13 2 73 -30 157 -84 110 -70 137 -83 141 -70 2 9 13 82 23 162 l18 144 128 106 128 105 -148 71 -148 71 -60 151 c-33 84 -62 151 -65 151 -3 -1 -55 -54 -117 -117z"/><path d="M1375 11221 l-60 -38 -75 8 c-41 4 -206 11 -367 15 l-292 7 -11 -28 c-6 -15 -9 -29 -8 -29 2 -1 28 -8 58 -15 83 -20 433 -121 438 -126 19 -19 -38 -15 -244 14 -129 19 -236 32 -239 30 -2 -3 25 -103 61 -223 35 -120 64 -224 64 -231 0 -6 -47 -106 -103 -221 l-104 -209 116 -6 c64 -4 170 -7 236 -8 l120 -1 176 -169 175 -169 80 225 79 224 125 66 c69 36 165 87 214 113 l89 48 -191 147 c-164 127 -191 151 -195 178 -2 18 -4 33 -2 35 8 9 444 -185 605 -271 462 -244 789 -485 1156 -851 263 -264 328 -341 934 -1106 92 -115 146 -177 148 -166 6 27 -28 283 -53 411 -186 929 -783 1626 -1722 2009 -298 122 -656 217 -1022 270 -100 15 -111 22 -111 74 0 17 -3 32 -7 32 -5 0 -35 -17 -68 -39z"/><path d="M8569 10720 c-416 -75 -789 -231 -1081 -451 -244 -184 -396 -338 -778 -789 -63 -74 -170 -197 -238 -272 l-123 -138 35 -16 35 -17 93 53 c51 29 206 123 343 208 138 86 320 199 407 253 589 365 986 526 1428 579 124 14 371 -5 568 -46 813 -167 1617 -704 2070 -1381 30 -46 59 -83 64 -83 5 0 18 5 28 10 17 9 13 20 -57 141 -606 1057 -1239 1649 -1993 1867 -291 85 -608 117 -801 82z"/><path d="M6730 10531 c-136 -48 -190 -80 -271 -161 -75 -75 -118 -154 -149 -275 -27 -107 -42 -305 -33 -440 9 -153 20 -151 136 30 136 211 245 391 287 475 81 161 161 383 144 400 -5 4 -56 -9 -114 -29z"/><path d="M9734 9533 c-114 -136 -208 -249 -209 -251 -1 -1 -148 -21 -326 -44 -178 -22 -325 -42 -327 -44 -2 -1 61 -106 141 -232 l144 -230 -301 -5 c-466 -7 -785 -61 -1152 -192 -452 -163 -870 -460 -1116 -794 l-29 -41 203 99 c404 197 757 307 1183 367 154 21 591 30 752 15 166 -16 406 -50 415 -59 4 -4 1 -35 -6 -69 -8 -36 -10 -63 -4 -63 5 0 73 16 151 36 163 42 149 43 404 -27 665 -183 1129 -438 1513 -835 250 -257 258 428 -518 614 -897 89 -180 93 -186 106 -162 17 31 8 314 -14 457 -115 740 -614 1396 -1383 1818 -95 52 -133 78 -133 91 0 10 96 109 235 240 129 122 235 225 235 228 0 3 -136 61 -302 127 l-302 122 -137 292 c-76 161 -140 295 -143 297 -2 2 -97 -107 -212 -244z"/><path d="M2262 9388 c-107 -10 -113 -11 -110 -31 2 -18 63 -49 334 -172 359 -164 525 -248 708 -358 126 -77 334 -228 440 -321 35 -32 67 -53 70 -48 13 22 -143 378 -217 492 -154 241 -305 356 -547 420 -75 20 -114 23 -325 25 -132 2 -291 -1 -353 -7z"/><path d="M7525 9286 c-115 -30 -288 -106 -374 -164 -321 -219 -498 -415 -604 -672 -38 -90 -109 -320 -100 -320 3 0 60 55 127 123 242 245 408 358 836 571 347 172 515 236 641 244 59 3 84 0 113 -13 32 -15 39 -16 47 -4 5 8 9 17 9 20 0 9 -204 141 -268 173 -75 38 -193 66 -271 66 -36 -1 -106 -12 -156 -24z"/><path d="M2405 8313 c-568 -47 -1153 -246 -1720 -585 -158 -95 -345 -218 -330 -218 6 0 39 9 75 20 778 241 1402 373 2095 442 201 20 845 17 1065 -6 173 -17 513 -62 538 -71 14 -5 62 14 62 25 0 8 -124 67 -293 139 -301 129 -663 221 -982 251 -101 9 -415 11 -510 3z"/><path d="M3293 7699 c-62 -12 -197 -78 -280 -138 -67 -47 -486 -441 -478 -449 2 -2 63 26 137 62 279 137 722 257 1131 307 95 11 376 7 442 -6 l30 -7 -25 21 c-88 72 -354 175 -529 205 -101 17 -353 20 -428 5z"/><path d="M8426 7543 c-4 -10 -41 -108 -83 -218 -41 -109 -78 -205 -82 -213 -5 -9 -22 7 -58 55 -177 235 -423 368 -708 380 -195 9 -354 -26 -540 -118 -113 -56 -159 -88 -147 -106 4 -7 63 -16 152 -23 430 -33 761 -115 1055 -263 l100 -50 -179 -89 c-98 -49 -175 -93 -170 -97 9 -8 406 -323 413 -327 1 -2 22 -122 44 -268 23 -146 45 -266 49 -266 5 0 107 66 227 146 l220 146 253 -41 c139 -23 260 -41 269 -41 13 0 3 46 -57 259 l-72 260 119 233 c66 128 121 237 122 243 1 6 -100 14 -267 21 l-268 12 -193 192 c-160 159 -193 189 -199 173z"/><path d="M824 7203 c-47 -93 -112 -217 -144 -278 l-57 -109 -291 -106 -290 -106 218 -225 218 -225 10 -303 c6 -167 13 -305 16 -308 2 -3 127 58 278 135 l273 140 294 -84 c161 -47 296 -82 299 -79 3 3 -15 141 -41 306 l-46 301 175 259 c97 142 173 259 170 259 -7 0 -557 90 -587 96 -18 3 -46 31 -90 87 -35 45 -120 155 -190 245 l-128 162 -87 -167z"/><path d="M4320 7134 c-807 -83 -1501 -358 -2047 -811 -119 -99 -354 -337 -447 -453 -90 -113 -241 -341 -308 -465 -224 -412 -343 -823 -379 -1305 -6 -85 -12 -156 -13 -157 -1 -1 -68 1 -149 5 -81 4 -147 5 -147 2 0 -3 63 -160 140 -349 77 -189 140 -350 140 -357 0 -7 -57 -163 -126 -346 -69 -183 -128 -341 -131 -350 -7 -24 -4 -23 414 7 l342 25 258 -207 c142 -114 277 -222 299 -240 l42 -33 93 373 93 373 318 208 c175 115 316 211 314 215 -3 4 -148 96 -324 205 l-319 198 -98 362 c-54 198 -101 364 -104 368 -3 4 -136 -103 -296 -238 l-290 -244 -160 6 c-88 3 -170 7 -182 10 -20 4 -11 23 119 257 538 967 878 1443 1307 1831 420 380 922 692 1616 1006 131 59 185 92 185 112 0 4 -6 7 -12 7 -7 -1 -74 -8 -148 -15z"/><path d="M6725 7028 c570 -467 1006 -1239 1213 -2148 33 -141 113 -582 108 -587 -2 -2 -34 81 -71 184 -37 104 -74 204 -82 223 l-14 34 -187 -186 -187 -187 -123 -3 c-67 -2 -122 -3 -122 -2 0 0 18 48 40 107 214 568 154 1112 -179 1614 -102 153 -210 281 -358 423 -107 104 -328 289 -354 299 -6 1 19 -33 54 -76 515 -639 695 -1558 496 -2538 -29 -141 -94 -395 -119 -459 -6 -16 -9 -31 -6 -33 6 -6 172 217 231 310 27 42 52 74 56 70 3 -5 28 -50 54 -102 l48 -93 -70 -247 c-47 -166 -66 -247 -58 -249 6 -1 114 13 240 33 125 19 237 35 249 35 12 0 112 -61 223 -135 112 -74 208 -136 214 -137 8 -2 25 80 53 251 23 142 46 256 52 258 7 2 14 -17 18 -49 101 -817 167 -1606 197 -2368 14 -362 22 -386 65 -188 127 582 178 1060 178 1653 -1 422 -21 762 -69 1135 -9 71 -11 118 -6 123 6 6 5 14 -3 22 -7 7 -18 57 -25 111 -35 275 -124 756 -182 989 -203 808 -574 1364 -1149 1719 -130 81 -424 226 -457 226 -4 0 10 -15 32 -32z"/><path d="M4710 6643 c-179 -13 -381 -68 -540 -148 -114 -57 -159 -92 -217 -170 -125 -166 -173 -349 -204 -762 -11 -160 -8 -206 12 -186 5 5 76 138 158 294 218 420 260 477 460 631 217 168 405 280 494 295 31 5 37 10 37 29 0 23 -2 24 -77 22 -43 -1 -98 -3 -123 -5z"/><path d="M5410 6424 c-387 -284 -616 -734 -681 -1344 -16 -152 -16 -520 0 -693 7 -76 11 -140 9 -142 -2 -3 -23 9 -47 26 -23 17 -43 30 -45 28 -1 -2 -22 -112 -45 -244 -23 -132 -44 -247 -47 -255 -2 -8 -96 -84 -209 -169 -113 -85 -203 -156 -200 -160 3 -3 105 -60 227 -126 l222 -120 23 -65 c12 -36 51 -147 86 -247 l62 -182 187 178 186 178 158 6 c88 4 205 7 262 7 56 0 102 3 102 6 0 3 -50 110 -110 236 l-111 230 76 246 c41 135 73 247 71 249 -3 3 -409 -48 -486 -61 -14 -3 -35 3 -48 12 l-22 17 30 240 c91 744 192 1284 361 1944 33 129 58 239 56 244 -1 5 -32 -13 -67 -39z"/><path d="M5997 6452 c-15 -16 -19 -65 -28 -328 -17 -458 -3 -787 42 -1003 l11 -54 45 69 c201 308 242 618 127 964 -34 102 -160 370 -174 370 -4 0 -14 -8 -23 -18z"/><path d="M7835 1059 c-170 -36 -226 -64 -240 -121 -14 -53 67 -108 205 -139 69 -16 349 -16 410 0 120 30 166 52 197 91 17 21 16 52 -2 76 -13 17 -14 17 -15 2 0 -23 -36 -24 -44 -2 -3 9 -6 27 -6 41 0 15 -3 24 -6 21 -3 -4 -20 -2 -37 4 -109 34 -360 49 -462 27z"/></g></svg>', url: "https://fireworks.xvyin.com/", } ]);
            const allNavLinks = ref([ { id: 'hub', text: '主页', priority: 1 }, { id: 'resume', text: '简历', priority: 2 }, { id: 'creations', text: '创造', priority: 3 }, { id: 'blog', text: '文章', priority: 4 }, { id: 'growth', text: '成长', priority: 5 }, { id: 'interests', text: '兴趣', priority: 6 }, { id: 'chatbot', text: 'AI', priority: 7 }, { id: 'footer', text: '更多', priority: 99 }, ]);
            return { resumeData, timeline, targets, bookshelf, blogPosts, interests, hubNodes, footerIconLinks, allNavLinks };
        };

        // --- 模块化函数 (Composables) ---
        
        /**
         * @description 管理主题切换逻辑
         */
        const useTheme = () => {
            const currentTheme = ref("dark");
            const setTheme = (theme) => {
                currentTheme.value = theme;
                document.documentElement.classList.toggle("light-theme", theme === "light");
                localStorage.setItem("user-theme", theme);
            };
            const initTheme = () => {
                const savedTheme = localStorage.getItem("user-theme");
                const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
                if (savedTheme) {
                    setTheme(savedTheme);
                } else {
                    setTheme(prefersDark ? 'dark' : 'light');
                }
            };
            return { currentTheme, setTheme, initTheme };
        };

        /**
         * @description 管理页面滚动相关状态和事件
         */
        const useScroll = () => {
            const isScrolling = ref(false);
            const scrollProgress = ref(0);
            const isHeaderVisible = ref(false);
            const isHeaderExpanded = ref(false);
            const lastScrollY = ref(0);
            let scrollTimeout = null;
            
            const handleScroll = () => {
                const scrollTop = window.scrollY;
                const docHeight = document.documentElement.scrollHeight - window.innerHeight;
                scrollProgress.value = docHeight > 0 ? scrollTop / docHeight : 0;
                
                isScrolling.value = true;
                if (scrollTimeout) clearTimeout(scrollTimeout);
                scrollTimeout = setTimeout(() => { isScrolling.value = false; }, 1500);
                
                isHeaderVisible.value = scrollTop > 100;
                isHeaderExpanded.value = scrollTop > lastScrollY.value && scrollTop > 100;
                lastScrollY.value = scrollTop <= 0 ? 0 : scrollTop;
            };

            return { isScrolling, scrollProgress, isHeaderVisible, isHeaderExpanded, handleScroll };
        };

        /**
         * @description 管理欢迎页打字机动画
         */
        const useHeroTypewriter = () => {
            const heroLine1 = ref("");
            const heroLine2 = ref("");
            const heroLine3 = ref("");
            const heroLine4 = ref("");
            const heroLine1Active = ref(false);
            const heroLine2Active = ref(false);
            const heroLine3Active = ref(false);
            const heroLine4Active = ref(false);
            const showHeroButtons = ref(false);

            function typeLine(targetRef, text, speed = 120) {
                return new Promise((resolve) => {
                    let index = 0;
                    targetRef.value = "";
                    const interval = setInterval(() => {
                        if (index < text.length) {
                            targetRef.value += text[index];
                            index++;
                        } else {
                            clearInterval(interval);
                            resolve();
                        }
                    }, speed);
                });
            }

            async function start() {
                const lines = [
                    { ref: heroLine1, text: "Hi! ", activeRef: heroLine1Active },
                    { ref: heroLine2, text: "I'm 虚宁", activeRef: heroLine2Active },
                    { ref: heroLine3, text: "A Developer", activeRef: heroLine3Active },
                    { ref: heroLine4, text: "For Anything!", activeRef: heroLine4Active },
                ];
                for (const line of lines) {
                    line.activeRef.value = true;
                    await typeLine(line.ref, line.text);
                    line.activeRef.value = false;
                    if (line.ref === heroLine1) heroLine1Active.value = true;
                }
                showHeroButtons.value = true;
            }
            
            return {
                heroLine1, heroLine2, heroLine3, heroLine4,
                heroLine1Active, heroLine2Active, heroLine3Active, heroLine4Active,
                showHeroButtons, start
            };
        };

        /**
         * @description 管理音乐播放器
         */
        const useMusicPlayer = (configs) => {
            const player = ref({
                aplayer: null, playlist: [], isInitialized: false, isLoading: false, isPlaying: false,
                isPlaylistVisible: false, isSongSwitcherVisible: false, currentSong: {}, progress: 0,
                volume: 0.7, error: null, loopMode: 'all', isShuffle: false, playbackRate: 1.0,
            });
            const lrcContainer = ref(null);
            const originalPlaylist = ref([]);

            const switchPlaylist = async (songId) => {
                if (player.value.isLoading) return;
                player.value.isLoading = true;
                player.value.error = null;

                try {
                    const audioList = await configs.apiService.getMusicPlaylist(songId);
                    originalPlaylist.value = [...audioList];
                    player.value.isShuffle = false;

                    if (!player.value.aplayer) {
                        await nextTick();
                        const ap = new APlayer({
                            container: document.getElementById("player-hidden"),
                            audio: audioList,
                            lrcType: 3,
                            loop: player.value.loopMode,
                        });
                        player.value.aplayer = ap;
                        player.value.isInitialized = true;
                        
                        ap.on("play", () => player.value.isPlaying = true);
                        ap.on("pause", () => player.value.isPlaying = false);
                        ap.on("volumechange", () => player.value.volume = ap.audio.volume);
                        ap.on("timeupdate", () => {
                            if (!ap.audio) return;
                            player.value.progress = ap.audio.duration ? (ap.audio.currentTime / ap.audio.duration) * 100 : 0;
                            const lrcContents = lrcContainer.value?.querySelector(".aplayer-lrc-contents");
                            const currentLrc = lrcContainer.value?.querySelector(".aplayer-lrc-current");
                            if (lrcContents && currentLrc) {
                                lrcContents.style.transform = `translateY(-${currentLrc.offsetTop}px)`;
                            }
                        });
                        ap.on("listswitch", (data) => {
                            player.value.currentSong = player.value.playlist[data.index];
                            moveLrcElement();
                        });
                    } else {
                        player.value.aplayer.list.clear();
                        player.value.aplayer.list.add(audioList);
                        player.value.aplayer.list.switch(0); // 确保切换到新列表的第一首歌
                    }
                    
                    player.value.playlist = audioList;
                    player.value.currentSong = audioList[0];
                    player.value.aplayer.volume(player.value.volume, true);
                    player.value.aplayer.audio.playbackRate = player.value.playbackRate;
                    player.value.aplayer.play();
                    moveLrcElement();

                } catch (error) {
                    console.error("音乐播放器操作失败:", error);
                    player.value.error = "音乐加载失败，请刷新或切换歌单。";
                    if (player.value.aplayer) {
                        player.value.aplayer.destroy();
                        player.value.aplayer = null;
                        player.value.isInitialized = false;
                    }
                } finally {
                    player.value.isLoading = false;
                }
            };
            
            const moveLrcElement = () => {
                nextTick(() => {
                    const lrcElement = document.querySelector("#player-hidden .aplayer-lrc");
                    if (lrcElement && lrcContainer.value) {
                        lrcContainer.value.innerHTML = "";
                        lrcContainer.value.appendChild(lrcElement);
                    }
                });
            };
            
            const toggleLoop = () => {
                const modes = ['all', 'one', 'none'];
                const currentIndex = modes.indexOf(player.value.loopMode);
                const nextIndex = (currentIndex + 1) % modes.length;
                player.value.loopMode = modes[nextIndex];
                if (player.value.aplayer) {
                    player.value.aplayer.loop = player.value.loopMode;
                }
            };

            const loopModeIcon = computed(() => {
                switch (player.value.loopMode) {
                    case 'one': return 'ph-repeat-once-fill';
                    case 'all': return 'ph-repeat-fill';
                    default: return 'ph-arrow-right';
                }
            });
            
            const loopModeTooltip = computed(() => {
                switch (player.value.loopMode) {
                    case 'one': return '单曲循环';
                    case 'all': return '列表循环';
                    default: return '顺序播放';
                }
            });

            const toggleShuffle = () => {
                const ap = player.value.aplayer;
                if (!ap || originalPlaylist.value.length <= 1) return;

                player.value.isShuffle = !player.value.isShuffle;

                const currentAudio = ap.list.audios[ap.list.index];
                if (!currentAudio) {
                    console.error("无法确定当前歌曲。");
                    player.value.isShuffle = !player.value.isShuffle; // Revert state
                    return;
                }

                const wasPlaying = player.value.isPlaying;
                let newPlaylist;

                if (player.value.isShuffle) {
                    // Shuffle logic
                    const otherSongs = originalPlaylist.value.filter(s => s.url !== currentAudio.url);
                    for (let i = otherSongs.length - 1; i > 0; i--) {
                        const j = Math.floor(Math.random() * (i + 1));
                        [otherSongs[i], otherSongs[j]] = [otherSongs[j], otherSongs[i]];
                    }
                    newPlaylist = [currentAudio, ...otherSongs];
                } else {
                    // Unshuffle logic
                    newPlaylist = [...originalPlaylist.value];
                }
                
                player.value.playlist = newPlaylist;
                ap.list.clear();
                ap.list.add(newPlaylist);

                const newIndex = newPlaylist.findIndex(s => s.url === currentAudio.url);
                if (newIndex !== -1) {
                    ap.list.switch(newIndex);
                }
                
                if (wasPlaying) {
                    ap.play();
                } else {
                    ap.pause();
                }
            };
            
            const cyclePlaybackRate = () => {
                if (!player.value.aplayer) return;
                const rates = [1.0, 1.25, 1.5, 2.0, 0.5, 0.75];
                const currentRate = player.value.playbackRate;
                const currentIndex = rates.indexOf(currentRate);
                const nextIndex = (currentIndex + 1) % rates.length;
                const newRate = rates[nextIndex];
                
                player.value.playbackRate = newRate;
                player.value.aplayer.audio.playbackRate = newRate;
            };

            const seek = (event) => {
                if (!player.value.aplayer) return;
                const progressContainer = event.currentTarget;
                const clickX = event.clientX - progressContainer.getBoundingClientRect().left;
                const percentage = clickX / progressContainer.offsetWidth;
                const newTime = player.value.aplayer.audio.duration * percentage;
                player.value.aplayer.seek(newTime);
            };

            const setVolume = (event) => {
                if (!player.value.aplayer) return;
                const volume = parseFloat(event.target.value);
                player.value.volume = volume;
                player.value.aplayer.volume(volume, true);
                event.target.style.setProperty("--volume-percent", `${volume * 100}%`);
            };
            
            const togglePlaylist = () => player.value.isPlaylistVisible = !player.value.isPlaylistVisible;
            
            const toggleSonglistSwitcher = () => player.value.isSongSwitcherVisible = !player.value.isSongSwitcherVisible;

            return { player, lrcContainer, switchPlaylist, seek, setVolume, togglePlaylist, toggleSonglistSwitcher, toggleLoop, loopModeIcon, loopModeTooltip, toggleShuffle, cyclePlaybackRate };
        };
        
        /**
         * @description 管理全局键盘快捷键
         */
        const useKeyboardShortcuts = (playerRef) => {
            const handleKeyDown = (event) => {
                const { value: player } = playerRef;
                
                if (!player.aplayer || ['INPUT', 'TEXTAREA'].includes(event.target.tagName) || event.target.isContentEditable) {
                    return;
                }

                switch (event.code) {
                    case 'Space':
                        event.preventDefault();
                        player.aplayer.toggle();
                        break;
                    case 'ArrowRight':
                        event.preventDefault();
                        player.aplayer.skipForward();
                        break;
                    case 'ArrowLeft':
                        event.preventDefault();
                        player.aplayer.skipBack();
                        break;
                    case 'ArrowUp':
                        event.preventDefault();
                         if (player.aplayer.audio.volume < 1) {
                             const newVolume = Math.min(1, player.aplayer.audio.volume + 0.1);
                             player.aplayer.volume(newVolume, true);
                        }
                        break;
                    case 'ArrowDown':
                        event.preventDefault();
                        if (player.aplayer.audio.volume > 0) {
                            const newVolume = Math.max(0, player.aplayer.audio.volume - 0.1);
                            player.aplayer.volume(newVolume, true);
                        }
                        break;
                }
            };

            onMounted(() => window.addEventListener('keydown', handleKeyDown));
            onUnmounted(() => window.removeEventListener('keydown', handleKeyDown));
        };


        /**
         * @description 管理AI聊天机器人
         */
        const useChatbot = (utils) => {
            const chatbot = ref({ apiKey: '', temperature: 1.3, use_deep_thinking: false, status: '', currentMessage: '', isLoading: false });
            const chatHistories = ref([]);
            const activeChatId = ref(null);
            const isHistoryDropdownOpen = ref(false);
            const dropdownRef = ref(null);
            const chatWindow = ref(null);

            const activeChat = computed(() => {
                if (!activeChatId.value || chatHistories.value.length === 0) return null;
                return chatHistories.value.find(c => c.id === activeChatId.value);
            });

            const sendMessage = async () => {
                 if (!activeChat.value) { console.error("No active chat selected."); return; }
                const messageText = chatbot.value.currentMessage.trim();
                if (!messageText || chatbot.value.isLoading || !chatbot.value.apiKey) return;

                chatbot.value.isLoading = true;
                chatbot.value.status = '正在准备请求...';
                
                activeChat.value.messages.push({ id: `user-${Date.now()}`, role: 'user', content: messageText });
                if (activeChat.value.messages.length === 2) {
                    activeChat.value.title = messageText.substring(0, 30) + (messageText.length > 30 ? '...' : '');
                }
                chatbot.value.currentMessage = '';
                activeChat.value.messages.push({
                    id: `assistant-${Date.now()}`, role: 'assistant', content: '', thinking: '', isThinkingVisible: false,
                });
                
                await nextTick();
                if (chatWindow.value) chatWindow.value.scrollTop = chatWindow.value.scrollHeight;
                
                const messagesForApi = activeChat.value.messages.slice(0, -1).map(({ role, content }) => ({ role, content }));
                
                try {
                    chatbot.value.status = '正在与 DeepSeek 通信...';
                    const payload = {
                        messages: messagesForApi,
                        stream: true,
                        model: chatbot.value.use_deep_thinking ? "deepseek-reasoner" : "deepseek-chat",
                        max_tokens: chatbot.value.use_deep_thinking ? 65536 : 8192,
                    };
                    if (!chatbot.value.use_deep_thinking) {
                        payload.temperature = parseFloat(chatbot.value.temperature);
                    }

                    const response = await fetch("https://api.deepseek.com/chat/completions", {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${chatbot.value.apiKey}` },
                        body: JSON.stringify(payload),
                    });

                    if (!response.ok) {
                        const errorData = await response.json();
                        throw new Error(errorData.error?.message || `API 请求失败: ${response.status}`);
                    }

                    const reader = response.body.getReader();
                    const decoder = new TextDecoder();
                    let buffer = '';
                    const assistantMessageIndex = activeChat.value.messages.length - 1;

                    while (true) {
                        const { value, done } = await reader.read();
                        if (done) break;
                        
                        buffer += decoder.decode(value, { stream: true });
                        const lines = buffer.split('\n');
                        buffer = lines.pop(); 

                        for (const line of lines) {
                            if (line.startsWith('data: ')) {
                                const jsonStr = line.substring(6);
                                if (jsonStr === '[DONE]') break;
                                try {
                                    const chunk = JSON.parse(jsonStr);
                                    const delta = chunk.choices[0]?.delta;
                                    if (delta) {
                                        const message = activeChat.value.messages[assistantMessageIndex];
                                        if (delta.reasoning_content) message.thinking += delta.reasoning_content;
                                        if (delta.content) message.content += delta.content;
                                    }
                                } catch (e) { console.error('解析流JSON错误:', e, jsonStr); }
                            }
                        }
                    }
                } catch (error) {
                     const message = activeChat.value.messages[activeChat.value.messages.length - 1];
                     message.content = `**错误:** ${error.message}`;
                } finally {
                    chatbot.value.isLoading = false;
                    chatbot.value.status = '';
                }
            };
            
            const saveChats = () => {
                localStorage.setItem('deepseek_chat_histories', JSON.stringify(chatHistories.value));
                localStorage.setItem('deepseek_active_chat_id', activeChatId.value);
            };

            const loadChats = () => {
                const savedChats = localStorage.getItem('deepseek_chat_histories');
                const savedActiveId = localStorage.getItem('deepseek_active_chat_id');
                if (savedChats) {
                    chatHistories.value = JSON.parse(savedChats);
                    activeChatId.value = savedActiveId ? parseInt(savedActiveId) : null;
                    if (!activeChat.value && chatHistories.value.length > 0) {
                        activeChatId.value = chatHistories.value[0].id;
                    }
                }
                if (chatHistories.value.length === 0) createNewChat();
            };

            const createNewChat = () => {
                const newChat = {
                    id: Date.now(), title: '新的对话',
                    messages: [{ id: 'initial-message', role: 'assistant', content: '你好！有什么可以帮助你的吗？' }]
                };
                chatHistories.value.push(newChat);
                activeChatId.value = newChat.id;
            };

            const deleteActiveChat = () => {
                if (!activeChat.value) return;
                const activeIndex = chatHistories.value.findIndex(c => c.id === activeChatId.value);
                if (chatHistories.value.length <= 1) {
                    const firstChat = chatHistories.value[0];
                    firstChat.messages = [{ id: 'initial-message', role: 'assistant', content: '你好！有什么可以帮助你的吗？' }];
                    firstChat.title = '新的对话';
                    return;
                }
                chatHistories.value.splice(activeIndex, 1);
                activeChatId.value = chatHistories.value[activeIndex > 0 ? activeIndex - 1 : 0].id;
            };
            
            const selectChat = (chatId) => {
                activeChatId.value = chatId;
                isHistoryDropdownOpen.value = false;
            };
            
            const handleClickOutside = (event) => {
                if (dropdownRef.value && !dropdownRef.value.contains(event.target)) {
                    isHistoryDropdownOpen.value = false;
                }
            };

            watch(chatHistories, saveChats, { deep: true });
            watch(activeChatId, saveChats);
            watch(() => chatbot.value.apiKey, (newKey) => localStorage.setItem('deepseek_api_key', newKey));
            watch(() => activeChat.value?.messages, () => utils.triggerMathRendering('.message:last-child .message-content'), { deep: true });

            return {
                chatbot, chatWindow, dropdownRef, chatHistories, activeChatId, activeChat,
                isHistoryDropdownOpen, sendMessage, createNewChat, deleteActiveChat, selectChat,
                loadChats, handleClickOutside
            };
        };

        createApp({
            setup() {
                // --- 配置信息 ---
                const VITE_SITE_START = "2024-03-02";
                const VITE_SITE_ICP = "渝ICP备2025053763号-1";
                
                // --- 静态数据 ---
                const { resumeData, timeline, targets, bookshelf, blogPosts, interests, hubNodes, footerIconLinks, allNavLinks } = useStaticData();

                // --- 响应式状态与逻辑 ---
                const { currentTheme, setTheme, initTheme } = useTheme();
                const { isScrolling, scrollProgress, isHeaderVisible, isHeaderExpanded, handleScroll } = useScroll();
                const hero = useHeroTypewriter();
                const { player, lrcContainer, switchPlaylist, seek, setVolume, togglePlaylist, toggleSonglistSwitcher, toggleLoop, loopModeIcon, loopModeTooltip, toggleShuffle, cyclePlaybackRate } = useMusicPlayer({
                    apiService
                });
                useKeyboardShortcuts(player);
                const {
                    chatbot, chatWindow, dropdownRef, chatHistories, activeChatId, activeChat,
                    isHistoryDropdownOpen, sendMessage, createNewChat, deleteActiveChat, selectChat,
                    loadChats, handleClickOutside
                } = useChatbot({ triggerMathRendering });

                const github = ref({ repos: [], contributionsUrl: "https://ghchart.rshah.org/jimmyshuixin", spaceUrl: "https://github.com/jimmyshuixin", error: null });
                const siteUptime = ref("");
                const icp = ref(VITE_SITE_ICP);
                const isLoginModalVisible = ref(false);
                const username = ref("");
                const password = ref("");
                const loginStatus = ref({ message: '', type: ''});
                const isLoggingIn = ref(false);
                const activeSection = ref("hero");
                const activeJourneyPanel = ref(null);
                const selectedInterest = ref(null);
                const growthPanelRef = ref(null);
                const targetsWithProgress = ref([]);
                
                // 歌单管理
                const currentSongId = ref("9518431060");
                const newSongIdInput = ref("");
                const newSongNameInput = ref("");
                const presetSonglists = ref([
                    { id: "9206816111", name: "「 BGM 」净尘拂人心" },
                    { id: "8886500589", name: "『纯音乐』美到窒息的旋律" },
                    { id: "9215562671", name: "『纯音乐』人间忽晚，山河已秋" },
                ]);
                const customSonglists = ref([]);
                
                const activePostId = ref(blogPosts.value.length > 0 ? blogPosts.value[0].id : null);
                const activePost = computed(() => blogPosts.value.find(p => p.id === activePostId.value));
                
                const activeCategory = ref('全部分类');
                const blogCategories = computed(() => ['全部分类', ...new Set(blogPosts.value.map(p => p.category))]);
                const filteredBlogPosts = computed(() => {
                    if (activeCategory.value === '全部分类') return blogPosts.value;
                    return blogPosts.value.filter(p => p.category === activeCategory.value);
                });

                // --- 导航栏动态显示 ---
                const windowWidth = ref(window.innerWidth);
                const visibleNavLinks = computed(() => {
                    const width = windowWidth.value;
                    let count = width > 1024 ? 7 : width > 900 ? 6 : width > 768 ? 5 : width > 640 ? 4 : width > 500 ? 3 : 2;
                    const sorted = [...allNavLinks.value].sort((a, b) => a.priority - b.priority);
                    if (count >= allNavLinks.value.length) return sorted;
                    const visible = sorted.slice(0, count - 1);
                    const moreLink = allNavLinks.value.find(l => l.id === 'footer');
                    if(moreLink && !visible.some(l => l.id === 'footer')) visible.push(moreLink);
                    return visible;
                });
                const handleResize = () => windowWidth.value = window.innerWidth;

                // --- 兴趣星系 ---
                const orbitingNodes = computed(() => interests.value.filter(i => !i.isCenter));
                const galaxyLines = computed(() => {
                    if (selectedInterest.value) return [];
                    const centerPos = { x: 50, y: 50 }; // in %
                    return orbitingNodes.value.map((node, index) => {
                        const angle = (index / orbitingNodes.value.length) * 2 * Math.PI - (Math.PI / 2);
                        const radius = 38; // in %
                        const x = centerPos.x + radius * Math.cos(angle);
                        const y = centerPos.y + radius * Math.sin(angle);
                        return {
                            id: node.id,
                            d: `M ${centerPos.x}% ${centerPos.y}% L ${x}% ${y}%`
                        };
                    });
                });

                const getInterestNodeStyle = (interest) => {
                    const style = { animationDelay: `${Math.random()*5}s`, animationDuration: `${Math.random()*4+6}s`};
                    
                    if (selectedInterest.value) {
                         const allNodes = interests.value;
                         const selectedIdx = allNodes.findIndex(i => i.id === selectedInterest.value.id);
                         const currentIdx = allNodes.findIndex(i => i.id === interest.id);
                         
                         style.left = '85%';
                         style.top = `${15 + currentIdx * 18}%`;
                         style.transform = `translate(-50%, -50%) scale(0.6)`;
                         style.opacity = '0.4';
                         style.animation = 'none';

                         if (interest.id === selectedInterest.value.id) {
                            style.opacity = '0';
                            style.transform = `translate(-50%, -50%) scale(0)`;
                         }
                    } else {
                        if (interest.isCenter) {
                            style.left = '50%';
                            style.top = '50%';
                            style.transform = 'translate(-50%, -50%)';
                        } else {
                            const orbitIndex = orbitingNodes.value.findIndex(n => n.id === interest.id);
                            const totalOrbiting = orbitingNodes.value.length;
                            const angle = (orbitIndex / totalOrbiting) * 2 * Math.PI - (Math.PI / 2);
                            const radius = 38; 
                            style.left = `${50 + radius * Math.cos(angle)}%`;
                            style.top = `${50 + radius * Math.sin(angle)}%`;
                            style.transform = 'translate(-50%, -50%)';
                        }
                    }
                    return style;
                };

                // --- 动效逻辑 ---
                const useAnimatedCounter = (targetValueRef) => {
                    const animatedValue = ref(0);
                    let frameId;

                    const animate = (start, end, startTime, duration) => {
                        const now = performance.now();
                        const progress = Math.min((now - startTime) / duration, 1);
                        animatedValue.value = Math.floor(start + (end - start) * progress);
                        if (progress < 1) {
                            frameId = requestAnimationFrame(() => animate(start, end, startTime, duration));
                        }
                    };

                    const startAnimation = (options = {}) => {
                        const { duration = 1000, delay = 0 } = options;
                        cancelAnimationFrame(frameId);

                        setTimeout(() => {
                            const startValue = 0;
                            const endValue = targetValueRef.value;
                            const startTime = performance.now();
                            animate(startValue, endValue, startTime, duration);
                        }, delay);
                    };

                    onUnmounted(() => {
                        cancelAnimationFrame(frameId);
                    });

                    return { animatedValue, startAnimation };
                };
                
                watch(() => targets.value, (newTargets) => {
                    targetsWithProgress.value = newTargets.map(target => {
                        const { animatedValue, startAnimation } = useAnimatedCounter(ref(target.current));
                        return {
                            ...target,
                            animatedCurrent: animatedValue,
                            startAnimation
                        };
                    });
                }, { immediate: true });
                
                const triggerGrowthAnimations = (panel) => {
                    if (!panel) return;
                    const timelineEl = panel.querySelector('.timeline');
                    if (timelineEl) timelineEl.classList.add('is-visible');

                    const timelineItems = panel.querySelectorAll('.timeline-item');
                    timelineItems.forEach((item, index) => {
                        setTimeout(() => {
                            item.classList.add('is-visible');
                        }, index * 150 + 200);
                    });

                    const progressBars = panel.querySelectorAll('.progress-bar');
                    progressBars.forEach((bar, index) => {
                        const target = targetsWithProgress.value[index];
                        if (target) {
                            bar.style.width = `${(target.current / target.total) * 100}%`;
                            target.startAnimation({ duration: 1000, delay: 300 });
                        }
                    });
                };

                const resetGrowthAnimations = (panel) => {
                    if (!panel) return;
                    const timelineEl = panel.querySelector('.timeline');
                    if (timelineEl) timelineEl.classList.remove('is-visible');

                    const timelineItems = panel.querySelectorAll('.timeline-item');
                    timelineItems.forEach(item => item.classList.remove('is-visible'));

                    const progressBars = panel.querySelectorAll('.progress-bar');
                    progressBars.forEach(bar => {
                        // Temporarily remove transition for an instant reset
                        bar.style.transition = 'none';
                        bar.style.width = '0%';
                        // Force the browser to apply the style change
                        void bar.offsetWidth; 
                        // Re-add the transition so it's ready for the next trigger
                        bar.style.transition = 'width 1s cubic-bezier(0.25, 1, 0.5, 1) 0.3s';
                    });
                    
                    targetsWithProgress.value.forEach(target => {
                        target.animatedCurrent.value = 0; 
                    });
                };

                // --- 通用工具函数 ---
                const handleImgError = (event) => {
                    event.target.src = 'https://placehold.co/400x600/1a1a1a/ffffff?text=Image+Failed';
                };

                const copyToClipboard = (text, event) => {
                    navigator.clipboard.writeText(text).then(() => {
                        if (event) {
                            const icon = event.currentTarget.querySelector('i');
                            if (icon && !icon.classList.contains('ph-check')) {
                                icon.classList.remove('ph-copy');
                                icon.classList.add('ph-check');
                                setTimeout(() => {
                                    icon.classList.remove('ph-check');
                                    icon.classList.add('ph-copy');
                                }, 2000);
                            }
                        }
                    }).catch(err => console.error('复制失败:', err));
                };

                function triggerMathRendering(selector) {
                    nextTick(() => {
                        if (window.renderMathInElement) {
                            const element = document.querySelector(selector);
                            if (element) {
                                try {
                                    window.renderMathInElement(element, {
                                        delimiters: [
                                            {left: '$$', right: '$$', display: true}, {left: '$', right: '$', display: false},
                                            {left: '\\(', right: '\\)', display: false}, {left: '\\[', right: '\\]', display: true}
                                        ],
                                        throwOnError: false
                                    });
                                } catch (e) { console.error("KaTeX渲染错误", e); }
                            }
                        }
                    });
                }
                
                const renderMarkdown = (content) => {
                    if (!window.marked) return (content || '').replace(/\n/g, '<br>');
                    const mathPlaceholders = [];
                    let i = 0;
                    const textWithPlaceholders = (content || '').replace(/(\$\$[\s\S]*?\$\$|\$[^$]*?\$|\\\[[\s\S]*?\\\]|\\\(.*?\\\))/g, (match) => {
                        const placeholder = `<!-- MATH_PLACEHOLDER_${i++} -->`;
                        mathPlaceholders.push(match);
                        return placeholder;
                    });
                    let html = window.marked.parse(textWithPlaceholders, { gfm: true, breaks: true });
                    return html.replace(/<!-- MATH_PLACEHOLDER_(\d+) -->/g, (match, index) => mathPlaceholders[parseInt(index)]);
                };

                // --- 交互逻辑 ---
                const toggleLoginModal = () => {
                    isLoginModalVisible.value = !isLoginModalVisible.value;
                    loginStatus.value = { message: '', type: '' };
                };
                 const handleLogin = () => {
                    if (isLoggingIn.value) return;
                    isLoggingIn.value = true;
                    loginStatus.value = { message: '', type: '' };
                    setTimeout(() => {
                        if (username.value === "admin" && password.value === "password") {
                            loginStatus.value = { message: '登录成功!', type: 'success' };
                            setTimeout(() => {
                                toggleLoginModal();
                                username.value = "";
                                password.value = "";
                            }, 1000);
                        } else {
                            loginStatus.value = { message: '用户名或密码错误。', type: 'error' };
                        }
                        isLoggingIn.value = false;
                    }, 1500);
                };
                
                const onBeforeEnter = (el) => {
                    el.style.opacity = 0;
                    el.style.transform = 'translateY(30px)';
                };
                const onEnter = (el, done) => {
                    const delay = (el.dataset.index || 0) * 100;
                    setTimeout(() => {
                        el.style.transition = 'opacity 0.6s ease, transform 0.6s ease';
                        el.style.opacity = 1;
                        el.style.transform = 'translateY(0)';
                        el.addEventListener('transitionend', done, { once: true });
                    }, delay);
                };
                
                const openJourneyPanel = (panelId) => {
                    if (activeJourneyPanel.value === panelId) return;
                    activeJourneyPanel.value = panelId;
                    activeSection.value = panelId;
                    nextTick(() => {
                        const hubElement = document.getElementById('interactive-journey');
                        if (hubElement) {
                             const headerOffset = 80;
                             const elementPosition = hubElement.getBoundingClientRect().top;
                             const offsetPosition = elementPosition + window.pageYOffset - headerOffset;
                             window.scrollTo({ top: offsetPosition, behavior: "smooth" });
                        }
                    }); 
                };

                const closeJourneyPanel = () => {
                    document.getElementById('interactive-journey')?.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    activeJourneyPanel.value = null;
                    activeSection.value = 'hub';
                };
                
                const handleNavClick = (sectionId) => {
                    if (sectionId === 'hub' || sectionId === 'footer') {
                        closeJourneyPanel();
                        const elementId = sectionId === 'hub' ? 'interactive-journey' : 'footer';
                        document.getElementById(elementId)?.scrollIntoView({ behavior: 'smooth' });
                    } else {
                        openJourneyPanel(sectionId);
                    }
                };

                // --- 歌单管理逻辑 ---
                const switchSonglist = async (id) => {
                    if (player.value.isLoading || !id) return;
                    if (id === currentSongId.value && player.value.isInitialized) {
                        player.value.isSongSwitcherVisible = false;
                        return;
                    }
                    currentSongId.value = id;
                    player.value.isSongSwitcherVisible = false;
                    await switchPlaylist(id);
                };

                const addAndSwitchSonglist = () => {
                    const newId = newSongIdInput.value.trim();
                    if (!newId || !/^\d+$/.test(newId)) {
                        alert("请输入纯数字的歌单ID。");
                        return;
                    }
                    const newName = newSongNameInput.value.trim() || `歌单 ${newId}`;
                    if (!customSonglists.value.some(list => list.id === newId)) {
                        customSonglists.value.unshift({ id: newId, name: newName });
                        localStorage.setItem('custom_songlists_v2', JSON.stringify(customSonglists.value));
                    }
                    newSongIdInput.value = "";
                    newSongNameInput.value = "";
                    switchSonglist(newId);
                };
                
                const removeCustomSonglist = (id) => {
                     customSonglists.value = customSonglists.value.filter(list => list.id !== id);
                     localStorage.setItem('custom_songlists_v2', JSON.stringify(customSonglists.value));
                };
                
                const loadCustomSonglists = () => {
                    const saved = localStorage.getItem('custom_songlists_v2');
                    if (saved) {
                        try {
                            customSonglists.value = JSON.parse(saved);
                            return;
                        } catch (e) { console.error("解析自定义歌单失败", e); }
                    }
                    
                    const oldSaved = localStorage.getItem('custom_songlists');
                    if (oldSaved) {
                         try {
                            const oldList = JSON.parse(oldSaved);
                            if(Array.isArray(oldList)) {
                                customSonglists.value = oldList.map(id => ({ id: String(id), name: `歌单 ${id}` }));
                                localStorage.setItem('custom_songlists_v2', JSON.stringify(customSonglists.value));
                                localStorage.removeItem('custom_songlists');
                            }
                        } catch (e) { console.error("迁移旧格式歌单失败", e); }
                    }
                };

                // --- 监听与副作用 ---
                watch(activeJourneyPanel, (newPanel, oldPanel) => {
                     if (oldPanel === 'growth' && growthPanelRef.value) {
                        resetGrowthAnimations(growthPanelRef.value);
                    }
                });

                watch(growthPanelRef, (newEl) => {
                    if (newEl && activeJourneyPanel.value === 'growth') {
                        // 当 "成长之路" 面板的 DOM 元素被挂载时，直接触发动画
                        triggerGrowthAnimations(newEl);
                    }
                });

                watch(activePostId, () => triggerMathRendering('.blog-post-body'));
                watch(activeCategory, () => {
                    if (!filteredBlogPosts.value.some(p => p.id === activePostId.value)) {
                        activePostId.value = filteredBlogPosts.value.length ? filteredBlogPosts.value[0].id : null;
                    }
                });

                // --- 初始化与生命周期 ---
                onMounted(async () => {
                    initTheme();
                    hero.start();
                    calculateSiteUptime();
                    loadChats();
                    loadCustomSonglists();
                    
                    try {
                        github.value.repos = await apiService.getGithubRepos();
                    } catch (error) {
                        console.error(error);
                        github.value.error = error.message;
                    }
                    
                    interests.value.forEach(i => i.animation = { animationDelay: `${Math.random()*5}s`, animationDuration: `${Math.random()*4+4}s`});
                    
                    setupIntersectionObserver();

                    document.addEventListener('click', handleClickOutside);
                    window.addEventListener('resize', handleResize);
                    window.addEventListener("scroll", handleScroll);
                    const savedApiKey = localStorage.getItem('deepseek_api_key');
                    if (savedApiKey) chatbot.value.apiKey = savedApiKey;
                });

                onUnmounted(() => {
                    window.removeEventListener("scroll", handleScroll);
                    window.removeEventListener('resize', handleResize);
                    document.removeEventListener('click', handleClickOutside);
                    if (player.value.aplayer) player.value.aplayer.destroy();
                });

                // --- 辅助函数 ---
                function calculateSiteUptime() {
                    const diffDays = Math.ceil(Math.abs(new Date() - new Date(VITE_SITE_START)) / (1000 * 60 * 60 * 24));
                    siteUptime.value = `${diffDays} 天`;
                }
                
                function setupIntersectionObserver() {
                    const options = { root: null, rootMargin: "0px", threshold: 0.1 };
                    const observer = new IntersectionObserver((entries) => {
                        entries.forEach((entry) => {
                            if (entry.isIntersecting && !activeJourneyPanel.value) {
                                activeSection.value = entry.target.getAttribute("data-section");
                            }
                        });
                    }, options);
                    document.querySelectorAll("[data-section]").forEach((el) => observer.observe(el));
                    
                    const animObserver = new IntersectionObserver((entries, obs) => {
                        entries.forEach(entry => {
                            if (entry.isIntersecting) {
                                entry.target.classList.add("is-visible");
                                obs.unobserve(entry.target);
                            }
                        });
                    }, { threshold: 0.1 });
                    document.querySelectorAll(".anim-fade-in-up").forEach(el => animObserver.observe(el));
                }

                return {
                    // Data
                    resumeData, timeline, targets, bookshelf, blogPosts, interests, hubNodes, footerIconLinks,
                    github, icp, siteUptime,
                    // State
                    currentTheme, isScrolling, scrollProgress, isHeaderVisible, isHeaderExpanded,
                    isLoginModalVisible, username, password, loginStatus, isLoggingIn,
                    activeSection, activeJourneyPanel, selectedInterest,
                    activePostId, activePost, activeCategory, blogCategories, filteredBlogPosts,
                    visibleNavLinks,
                    // Hero
                    ...hero,
                    // Player
                    player, lrcContainer, loopModeIcon, loopModeTooltip,
                    // Songlists
                    currentSongId, presetSonglists, customSonglists, newSongIdInput, newSongNameInput,
                    // Chatbot
                    chatbot, chatWindow, dropdownRef, chatHistories, activeChatId, activeChat, isHistoryDropdownOpen,
                    // Interests
                    galaxyLines,
                    // Growth
                    growthPanelRef, targetsWithProgress,
                    // Methods
                    setTheme, toggleLoginModal, handleLogin,
                    switchPlaylist, seek, setVolume, togglePlaylist, toggleSonglistSwitcher,
                    switchSonglist, addAndSwitchSonglist, removeCustomSonglist,
                    sendMessage, createNewChat, deleteActiveChat, selectChat,
                    onBeforeEnter, onEnter, openJourneyPanel, closeJourneyPanel, handleNavClick,
                    getInterestNodeStyle, handleImgError, renderMarkdown, copyToClipboard, toggleLoop, toggleShuffle, cyclePlaybackRate
                };
            },
        }).mount("#app");
    </script>
</body>

</html>
