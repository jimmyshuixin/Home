<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>虚静以宁</title>
    <link rel="icon" href="./content/icon/32.png" />

    <link rel="preconnect" href="https://source.xvyin.com" />
    <link rel="preconnect" href="https://github.xvyin.com" />

    <link
      href="https://source.xvyin.com/?target=https%3A%2F%2Ffonts.loli.net%2Fcss2%3Ffamily%3DZCOOL%2BKuaiLe%26display%3Dswap"
      rel="stylesheet"
    />
    <link
      href="https://source.xvyin.com/?target=https%3A%2F%2Ffonts.loli.net%2Fcss2%3Ffamily%3DInter%3Awght%40400%3B500%3B600%3B700%3B800%26display%3Dswap"
      rel="stylesheet"
    />

    <link
      rel="stylesheet"
      href="https://source.xvyin.com/?target=https%3A%2F%2Fcdn.bootcdn.net%2Fajax%2Flibs%2Faplayer%2F1.10.1%2FAPlayer.min.css"
    />
    <link
      rel="stylesheet"
      href="https://source.xvyin.com/?target=https%3A%2F%2Fcdn.bootcdn.net%2Fajax%2Flibs%2FKaTeX%2F0.16.9%2Fkatex.min.css"
    />

    <style>
      /* --- 1. :root 变量定义 --- */
      :root {
        --body-bg-color: #121212;
        --glass-bg: rgba(38, 38, 38, 0.25);
        --glass-bg-optimized: rgba(38, 38, 38, 0.65);
        --glass-border-color: rgba(255, 255, 255, 0.1);
        --input-bg: rgba(50, 50, 50, 0.2);
        --text-color: #f0f0f0;
        --text-color-darker: #b3b3b3;
        --text-color-white: #ffffff;
        --accent-color: #61dafb;
        --accent-color-rgb: 97, 218, 251;
        --shadow-color: rgba(0, 0, 0, 0.25);
        --glow-color: rgba(var(--accent-color-rgb), 0.1);
        --subscribe-btn-bg: #3b82f6;
        --theme-switcher-bg: rgba(0, 0, 0, 0.3);
        --repo-card-bg: rgba(255, 255, 255, 0.05);
        --repo-card-hover-bg: rgba(255, 255, 255, 0.1);
        --error-color: #ef4444;
        --success-color: #22c55e;
      }

      html.light-theme {
        --body-bg-color: #f5f5f7;
        --glass-bg: rgba(242, 242, 247, 0.3);
        --glass-bg-optimized: rgba(242, 242, 247, 0.7);
        --glass-border-color: rgba(0, 0, 0, 0.1);
        --input-bg: rgba(255, 255, 255, 0.3);
        --text-color: #1d1d1f;
        --text-color-darker: #6e6e73;
        --text-color-white: #000000;
        --shadow-color: rgba(0, 0, 0, 0.08);
        --glow-color: rgba(var(--accent-color-rgb), 0.2);
        --repo-card-bg: rgba(0, 0, 0, 0.05);
        --repo-card-hover-bg: rgba(0, 0, 0, 0.1);
      }

      /* --- 2. 全局样式重置和基础设定 --- */
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }
      html,
      body {
        scrollbar-width: none;
        -ms-overflow-style: none;
      }
      html::-webkit-scrollbar,
      body::-webkit-scrollbar {
        display: none;
      }
      html {
        scroll-behavior: smooth;
      }
      body {
        display: flex;
        flex-direction: column;
        min-height: 100vh;
        background-color: var(--body-bg-color);
        font-family: "Inter", -apple-system, BlinkMacSystemFont, "Segoe UI",
          Roboto, "Helvetica Neue", Arial, sans-serif;
        color: var(--text-color);
        overflow-x: hidden;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
        transition: background-color 0.4s ease, color 0.4s ease;
      }

      /* --- 3. 通用工具类 与 页面加载动画 --- */
      .glass-effect {
        position: relative;
        background: var(--glass-bg-optimized);
        background-clip: padding-box;
        border: 1px solid var(--glass-border-color);
        border-radius: 24px;
        box-shadow: inset 0 0 0 1px rgba(255, 255, 255, 0.15),
          0 8px 32px 0 var(--shadow-color), 0 0 15px var(--glow-color);
        overflow: hidden;
        transition: background 0.4s ease, border-color 0.4s ease,
          box-shadow 0.4s ease;
      }
      .glass-effect::before {
        display: none;
      }
      .error-message {
        color: var(--error-color);
        font-size: 0.9rem;
        text-align: center;
        padding: 1rem;
        background: rgba(239, 68, 68, 0.1);
        border: 1px solid rgba(239, 68, 68, 0.3);
        border-radius: 12px;
        margin-top: 1rem;
      }
      #loader-wrapper {
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        z-index: 9999;
        background-color: var(--body-bg-color);
        display: flex;
        justify-content: center;
        align-items: center;
        transition: opacity 0.8s ease-out, visibility 0.8s ease-out;
        opacity: 1;
        visibility: visible;
      }
      #loader-wrapper.is-hidden {
        opacity: 0;
        visibility: hidden;
        pointer-events: none;
      }
      .loader-container {
        position: relative;
        width: 100px;
        height: 100px;
      }
      .loader-core {
        position: absolute;
        top: 50%;
        left: 50%;
        width: 20px;
        height: 20px;
        background-color: var(--accent-color);
        border-radius: 50%;
        transform: translate(-50%, -50%);
        box-shadow: 0 0 15px var(--accent-color), 0 0 30px var(--accent-color);
        animation: pulse-core 2s infinite ease-in-out;
      }
      .loader-electron {
        position: absolute;
        top: 50%;
        left: 50%;
        width: 8px;
        height: 8px;
        margin: -4px;
        background-color: var(--text-color-white);
        border-radius: 50%;
        box-shadow: 0 0 5px var(--text-color-white);
        animation-name: orbit;
        animation-duration: 4s;
        animation-timing-function: linear;
        animation-iteration-count: infinite;
      }
      .loader-electron:nth-child(2) {
        animation-delay: -1.33s;
        animation-name: orbit-reverse;
      }
      .loader-electron:nth-child(3) {
        animation-delay: -2.66s;
        animation-name: orbit-vertical;
      }

      /* --- 4. 布局与主要容器样式 --- */
      #particle-canvas {
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        z-index: -1;
      }
      #app {
        display: flex;
        flex-direction: column;
        flex-grow: 1;
        width: 100%;
        position: relative;
      }
      .main-content {
        flex-grow: 1;
      }
      .content-section {
        padding: 4rem 2rem;
        max-width: 1000px;
        margin: 0 auto;
      }
      .content-section:first-of-type {
        padding-top: 8rem;
      }
      .content-card {
        padding: 2rem;
        margin-bottom: 3rem;
        box-shadow: none;
      }
      .content-card h2 {
        font-size: 1.5rem;
        font-weight: 700;
        color: var(--text-color-white);
        margin-bottom: 2rem;
        text-align: center;
      }
      .content-card h3 {
        font-size: 1.25rem;
        font-weight: 600;
        color: var(--text-color-white);
        margin-bottom: 1.5rem;
      }

      /* --- 5. 组件样式 --- */
      .scroll-indicator {
        position: fixed;
        top: 0;
        right: 5px;
        width: 10px;
        height: 100vh;
        z-index: 50;
        pointer-events: none;
        opacity: 0;
        transition: opacity 0.5s ease;
      }
      .scroll-indicator.is-scrolling {
        opacity: 1;
      }
      .scroll-star {
        position: absolute;
        top: 0;
        left: 50%;
        width: 6px;
        height: 6px;
        border-radius: 50%;
        background-color: var(--accent-color);
        box-shadow: 0 0 10px var(--accent-color), 0 0 20px var(--accent-color);
        transition: transform 0.1s linear;
      }
      .main-header {
        position: fixed;
        top: 20px;
        left: 50%;
        transform: translateX(-50%);
        z-index: 20;
        display: flex;
        align-items: center;
        padding: 8px;
        border-radius: 999px;
        transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        opacity: 0;
        pointer-events: none;
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
      }
      .main-header.is-visible {
        opacity: 1;
        pointer-events: auto;
      }
      .header-avatar {
        width: 44px;
        height: 44px;
        border-radius: 50%;
        object-fit: cover;
        flex-shrink: 0;
        cursor: pointer;
        border: 2px solid rgba(255, 255, 255, 0.2);
      }
      .header-nav {
        display: flex;
        align-items: center;
        max-width: 0;
        opacity: 0;
        overflow: hidden;
        white-space: nowrap;
        transition: max-width 0.4s ease-in-out, opacity 0.2s 0.1s ease-in-out,
          margin-left 0.4s ease-in-out;
        margin-left: 0;
      }
      .main-header.is-expanded .header-nav {
        max-width: 800px;
        opacity: 1;
        margin-left: 12px;
      }
      .header-nav button {
        background: none;
        border: none;
        font-family: inherit;
        font-size: 0.95rem;
        font-weight: 500;
        color: var(--text-color-darker);
        text-decoration: none;
        padding: 0 0.8rem;
        transition: color 0.3s ease;
        cursor: pointer;
      }
      .header-nav button:hover,
      .header-nav button.active {
        color: var(--text-color-white);
      }
      .initial-hero-section {
        min-height: 100vh;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        text-align: center;
        padding: 2rem;
        position: relative;
        transition: padding-bottom 0.5s ease-in-out;
        overflow: hidden;
      }
      .danmaku-container {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 70%;
        pointer-events: none;
        z-index: 2;
      }
      .danmaku-item {
        position: absolute;
        right: 0;
        transform: translateX(100%);
        white-space: nowrap;
        font-size: clamp(1rem, 2vw, 1.5rem);
        font-weight: 500;
        padding: 5px 15px;
        border-radius: 15px;
        background-color: rgba(0, 0, 0, 0.2);
        color: var(--text-color-white);
        text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.5);
        animation-name: danmaku-scroll;
        animation-timing-function: linear;
        animation-iteration-count: 1;
      }
      .hero-text-container,
      .hero-bottom-content {
        position: relative;
        z-index: 1;
      }
      .hero-text-container {
        font-weight: 800;
        font-size: clamp(2.5rem, 10vw, 5rem);
        color: var(--text-color-white);
        line-height: 1.2;
        z-index: 3;
      }
      .hero-text-container p {
        min-height: 1.2em;
      }
      .typing-cursor-hero {
        display: inline-block;
        width: 0.1em;
        height: 1em;
        background-color: var(--text-color-white);
        animation: blink 0.7s infinite;
      }
      .waving-hand {
        display: inline-block;
        animation: wave 2.5s infinite;
        transform-origin: 70% 70%;
      }
      .hero-bottom-content {
        opacity: 0;
        transition: opacity 0.5s ease-in-out;
        width: 100%;
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 3rem;
        margin-top: 4rem;
        z-index: 3;
      }
      .hero-bottom-content.visible {
        opacity: 1;
      }
      .play-button {
        display: flex;
        justify-content: center;
        align-items: center;
        width: 60px;
        height: 60px;
        border-radius: 50%;
        color: var(--text-color);
        transition: all 0.3s ease;
      }
      .play-button:hover {
        transform: translateY(-5px) scale(1.05);
        color: var(--text-color-white);
        box-shadow: 0 0 20px var(--glow-color);
      }
      .play-button i {
        width: 28px;
        height: 28px;
        font-size: 28px;
      }
      .hero-player-container {
        margin-top: 0;
        width: 100%;
        max-width: 1000px;
        padding: 0 2rem;
        min-height: 95px;
        display: flex;
        justify-content: center;
        align-items: center;
        position: relative;
      }
      .player-wrapper {
        transition: all 0.5s ease-in-out;
        width: 100%;
        border-radius: 16px !important;
        border: 1px solid var(--glass-border-color) !important;
        padding: 1rem;
      }
      .play-button,
      .loading-spinner {
        border: none;
        padding: 0;
        cursor: pointer;
        position: absolute;
      }
      .play-button i,
      .loading-spinner i {
        margin: 0;
      }
      #player-hidden {
        display: none;
      }
      .custom-player {
        display: flex;
        align-items: center;
        gap: 1rem;
        width: 100%;
      }
      .custom-player-cover {
        width: 60px;
        height: 60px;
        border-radius: 8px;
        object-fit: cover;
        flex-shrink: 0;
      }
      .custom-player-info-wrapper {
        flex-grow: 1;
        overflow: hidden;
        display: flex;
        flex-direction: column;
        justify-content: center;
        gap: 8px;
      }
      .custom-player-info {
        text-align: left;
      }
      .custom-player-title {
        font-size: 1rem;
        font-weight: 600;
        color: var(--text-color-white);
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
      }
      .custom-player-artist {
        font-size: 0.85rem;
        color: var(--text-color-darker);
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
      }
      .custom-player-progress-container {
        width: 100%;
        height: 4px;
        background: rgba(255, 255, 255, 0.1);
        border-radius: 2px;
        cursor: pointer;
      }
      .custom-player-progress-bar {
        height: 100%;
        background-color: var(--accent-color);
        border-radius: 2px;
        position: relative;
      }
      .custom-player-progress-bar::after {
        content: "";
        position: absolute;
        right: -6px;
        top: -4px;
        width: 12px;
        height: 12px;
        background-color: var(--text-color-white);
        border-radius: 50%;
      }
      .custom-player-controls {
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }
      .custom-player-controls button {
        background: none;
        border: none;
        color: var(--text-color-darker);
        cursor: pointer;
        font-size: 1.75rem;
        padding: 0.5rem;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.2s ease;
      }
      .custom-player-controls .playback-rate-btn {
        font-size: 0.9rem;
        font-weight: 600;
        width: 44px;
        height: 44px;
        padding: 0;
      }
      .custom-player-controls button:hover {
        color: var(--text-color-white);
        background: rgba(255, 255, 255, 0.1);
      }
      .custom-player-controls button.active {
        color: var(--accent-color);
      }
      .loading-spinner {
        width: 60px;
        height: 60px;
        border: 4px solid var(--glass-border-color);
        border-top-color: var(--accent-color);
        border-radius: 50%;
        animation: spin 1s linear infinite;
      }
      .volume-control-wrapper {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        margin-right: 0.5rem;
      }
      .volume-control-wrapper i {
        font-size: 1.5rem;
        color: var(--text-color-darker);
      }
      input[type="range"].volume-slider {
        -webkit-appearance: none;
        appearance: none;
        width: 80px;
        background: transparent;
        cursor: pointer;
      }
      input[type="range"].volume-slider::-webkit-slider-runnable-track {
        height: 4px;
        background: linear-gradient(
          to right,
          var(--accent-color) 0%,
          var(--accent-color) var(--volume-percent, 70%),
          rgba(255, 255, 255, 0.1) var(--volume-percent, 70%),
          rgba(255, 255, 255, 0.1) 100%
        );
        border-radius: 2px;
      }
      input[type="range"].volume-slider::-webkit-slider-thumb {
        -webkit-appearance: none;
        appearance: none;
        margin-top: -4px;
        height: 12px;
        width: 12px;
        border-radius: 50%;
        background: var(--text-color-white);
      }
      input[type="range"].volume-slider::-moz-range-track {
        background-color: rgba(255, 255, 255, 0.1);
        height: 4px;
        border-radius: 2px;
      }
      input[type="range"].volume-slider::-moz-range-progress {
        background-color: var(--accent-color);
        height: 4px;
        border-radius: 2px;
      }
      input[type="range"].volume-slider::-moz-range-thumb {
        height: 12px;
        width: 12px;
        border-radius: 50%;
        background: var(--text-color-white);
        border: none;
      }
      .custom-lrc-container {
        height: 60px;
        margin-top: 1rem;
        overflow: hidden;
        text-align: center;
      }
      .aplayer-lrc {
        padding: 0 !important;
        margin: 0 !important;
        text-shadow: none !important;
        background: none !important;
        height: 100%;
      }
      .aplayer-lrc-contents {
        display: flex;
        flex-direction: column;
        height: 100%;
        padding-top: 25px;
        padding-bottom: 25px;
      }
      .aplayer-lrc p {
        font-size: 1rem;
        font-weight: 700;
        color: var(--text-color-darker);
        padding: 4px 0;
        margin: 0;
        line-height: 1.5;
        transition: color 0.4s ease-in-out, opacity 0.4s ease-in-out;
        opacity: 0.5;
        flex-shrink: 0;
      }
      .aplayer-lrc p.aplayer-lrc-current {
        color: var(--text-color-white);
        opacity: 1;
      }
      .playlist-container,
      .songlist-switcher {
        max-height: 0;
        overflow-y: auto;
        transition: max-height 0.5s ease-in-out, margin-top 0.5s ease-in-out,
          padding-top 0.5s ease-in-out;
        border-top: 1px solid transparent;
        margin-top: 0;
        padding-top: 0;
      }
      .playlist-container.show,
      .songlist-switcher.show {
        max-height: 250px;
        margin-top: 1rem;
        padding-top: 0.5rem;
        border-top-color: var(--glass-border-color);
      }
      .playlist-container::-webkit-scrollbar,
      .songlist-switcher ul::-webkit-scrollbar {
        width: 10px;
      }
      .playlist-container::-webkit-scrollbar-track {
        background: transparent;
      }
      .playlist-container::-webkit-scrollbar-thumb,
      .songlist-switcher ul::-webkit-scrollbar-thumb {
        background-color: var(--accent-color);
        border-radius: 10px;
        border: 3px solid transparent;
        background-clip: content-box;
      }
      .playlist-item {
        display: flex;
        align-items: center;
        padding: 0.5rem 1rem;
        cursor: pointer;
        border-radius: 8px;
        transition: background-color 0.2s;
      }
      .playlist-item:hover {
        background-color: var(--repo-card-hover-bg);
      }
      .playlist-item.active {
        background-color: var(--repo-card-bg);
      }
      .playlist-item .index {
        color: var(--text-color-darker);
        margin-right: 1rem;
        width: 1.5rem;
        text-align: right;
      }
      .playlist-item .info {
        text-align: left;
        overflow: hidden;
        white-space: nowrap;
      }
      .playlist-item .title {
        color: var(--text-color);
        text-overflow: ellipsis;
        overflow: hidden;
      }
      .playlist-item .artist {
        font-size: 0.8rem;
        color: var(--text-color-darker);
        text-overflow: ellipsis;
        overflow: hidden;
      }
      .songlist-switcher.show {
        max-height: 400px;
      }
      .songlist-switcher h4,
      .songlist-switcher h5 {
        padding: 0 1rem;
        margin-bottom: 0.5rem;
        color: var(--text-color-white);
      }
      .songlist-switcher h5 {
        margin-top: 1rem;
        font-size: 0.9em;
        color: var(--text-color-darker);
      }
      .songlist-switcher ul {
        list-style: none;
        padding: 0;
        margin: 0;
        max-height: 150px;
        overflow-y: auto;
      }
      .songlist-switcher li {
        padding: 0.5rem 1rem;
        cursor: pointer;
        border-radius: 8px;
        transition: background-color 0.2s;
        font-size: 0.9rem;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }
      .songlist-switcher li > span {
        overflow: hidden;
        text-overflow: ellipsis;
      }
      .songlist-switcher li:hover {
        background-color: var(--repo-card-hover-bg);
      }
      .songlist-switcher li.active {
        background-color: var(--repo-card-bg);
        color: var(--accent-color);
        font-weight: 500;
      }
      .songlist-switcher .remove-btn {
        background: none;
        border: none;
        color: var(--text-color-darker);
        cursor: pointer;
        font-size: 1.2rem;
        padding: 0.25rem;
        line-height: 1;
        border-radius: 50%;
        margin-left: 1rem;
        flex-shrink: 0;
      }
      .songlist-switcher .remove-btn:hover {
        color: var(--error-color);
        background-color: rgba(239, 68, 68, 0.1);
      }
      .songlist-input-group {
        display: flex;
        flex-direction: column;
        gap: 0.75rem;
        padding: 1rem 1rem 0.5rem;
      }
      .songlist-input-row {
        display: flex;
        gap: 0.5rem;
      }
      .songlist-input-group input {
        flex-grow: 1;
        background: var(--input-bg);
        border: 1px solid var(--glass-border-color);
        border-radius: 8px;
        padding: 0.5rem 0.75rem;
        color: var(--text-color);
        font-size: 0.9rem;
      }
      .songlist-input-group input:focus {
        outline: none;
        border-color: var(--accent-color);
      }
      .songlist-input-group button {
        background: var(--subscribe-btn-bg);
        border: none;
        color: white;
        padding: 0.5rem 1rem;
        border-radius: 8px;
        cursor: pointer;
        font-size: 0.9rem;
        transition: opacity 0.2s;
        width: 100%;
      }
      .songlist-input-group button:hover {
        opacity: 0.9;
      }
      .modal-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.5);
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 30;
        opacity: 0;
        pointer-events: none;
        transition: opacity 0.3s ease;
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
      }
      .modal-overlay.is-visible {
        opacity: 1;
        pointer-events: auto;
      }
      .modal-container {
        transform: scale(0.95);
        transition: transform 0.3s ease;
      }
      .modal-overlay.is-visible .modal-container {
        transform: scale(1);
      }
      .modal-card-container {
        padding: 1rem;
        max-width: 90vw;
        display: flex;
        justify-content: center;
        align-items: center;
      }
      .modal-card {
        padding: 2.5rem;
      }
      .modal-card:not(.book-modal-card) {
        width: 400px;
        max-width: 100%;
        text-align: center;
      }
      .modal-card h3 {
        color: var(--text-color-white);
        font-size: 1.5rem;
        margin-bottom: 2rem;
      }
      .modal-status-message {
        min-height: 1.2em;
        font-size: 0.9em;
        margin-bottom: 1rem;
        font-weight: 500;
      }
      .modal-status-message.success {
        color: var(--success-color);
      }
      .modal-status-message.error {
        color: var(--error-color);
      }
      .form-group {
        margin-bottom: 1.5rem;
        text-align: left;
      }
      .form-group label {
        display: block;
        margin-bottom: 0.5rem;
        font-size: 0.9rem;
        color: var(--text-color-darker);
      }
      .form-group input,
      .form-group textarea {
        width: 100%;
        padding: 0.8rem 1rem;
        border-radius: 12px;
        border: 1px solid var(--glass-border-color);
        color: var(--text-color);
        font-size: 1rem;
        transition: all 0.3s ease;
        background: var(--input-bg);
        font-family: inherit;
      }
      .form-group textarea {
        resize: vertical;
        min-height: 100px;
      }
      .form-group input:focus,
      .form-group textarea:focus {
        outline: none;
        border-color: var(--accent-color);
        box-shadow: 0 0 0 2px var(--accent-color);
      }
      .form-submit-button {
        width: 100%;
        padding: 0.8rem 1rem;
        border: none;
        background-color: var(--subscribe-btn-bg);
        color: white;
        font-size: 1rem;
        font-weight: 500;
        border-radius: 12px;
        cursor: pointer;
        transition: all 0.3s ease;
        position: relative;
      }
      .form-submit-button .ph-spinner-gap {
        animation: spin 1s linear infinite;
        position: absolute;
        left: 20%;
      }
      .form-submit-button:hover {
        opacity: 0.9;
        transform: translateY(-2px);
      }
      .form-submit-button:disabled {
        opacity: 0.6;
        cursor: not-allowed;
      }
      .about-us-card {
        display: flex;
        padding: 3rem;
        gap: 3rem;
      }
      .about-us-card h2 {
        text-align: left;
      }
      .about-sidebar {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 1.5rem;
      }
      .sidebar-line {
        width: 2px;
        height: 100%;
        background-color: var(--accent-color);
        flex-grow: 1;
      }
      .sidebar-text {
        writing-mode: vertical-rl;
        transform: rotate(180deg);
        color: var(--text-color-darker);
        font-size: 0.9rem;
        letter-spacing: 0.1em;
        white-space: nowrap;
      }
      .about-main-content {
        flex-grow: 1;
      }
      .about-main-content h2 {
        font-size: 1.1rem;
        font-weight: 500;
        color: var(--text-color-darker);
        margin-bottom: 1.5rem;
      }
      .about-main-content blockquote {
        position: relative;
        font-size: 2.5rem;
        font-weight: 700;
        line-height: 1.4;
        margin-left: 2rem;
        margin-bottom: 3rem;
        padding-left: 2rem;
        border-left: 2px solid var(--accent-color);
      }
      .about-main-content h3 {
        font-size: 1.25rem;
        font-weight: 600;
        color: var(--text-color-white);
        margin-bottom: 1rem;
      }
      .about-main-content p {
        font-size: 1rem;
        line-height: 1.8;
        color: var(--text-color-darker);
        margin-bottom: 2rem;
      }
      .about-main-content p strong {
        color: var(--accent-color);
        font-weight: 500;
      }
      .rd-philosophy {
        border-top: 1px solid var(--glass-border-color);
        padding-top: 2rem;
        margin-top: 2rem;
      }
      #interactive-journey {
        padding: 4rem 2rem;
        max-width: 1200px;
        margin: 0 auto;
        position: relative;
      }
      .hub-intro {
        text-align: center;
        max-width: 800px;
        margin: 0 auto 4rem;
      }
      .hub-intro h2 {
        font-size: 2.5rem;
        font-weight: 700;
        margin-bottom: 1rem;
        color: var(--text-color-white);
      }
      .hub-intro blockquote {
        position: relative;
        font-size: 1.5rem;
        font-weight: 500;
        line-height: 1.6;
        margin: 0 auto 1.5rem;
        max-width: 650px;
      }
      .hub-intro blockquote strong {
        color: var(--accent-color);
        font-weight: 600;
      }
      .hub-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
        gap: 1.5rem;
      }
      .hub-node {
        background: var(--glass-bg);
        border: 1px solid var(--glass-border-color);
        border-radius: 20px;
        padding: 2rem;
        text-align: center;
        cursor: pointer;
        transition: transform 0.5s cubic-bezier(0.25, 0.8, 0.25, 1),
          box-shadow 0.5s cubic-bezier(0.25, 0.8, 0.25, 1),
          border-color 0.5s cubic-bezier(0.25, 0.8, 0.25, 1);
        box-shadow: 0 0 0 transparent, 0 0 0 transparent;
        position: relative;
        overflow: hidden;
      }
      .hub-node:hover {
        transform: translateY(-10px) scale(1.05);
        box-shadow: 0 10px 40px var(--shadow-color), 0 0 20px var(--glow-color);
        border-color: rgba(var(--accent-color-rgb), 0.5);
      }
      .hub-node i {
        font-size: 3rem;
        color: var(--accent-color);
        margin-bottom: 1rem;
        display: block;
        transition: transform 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
      }
      .hub-node:hover i {
        transform: scale(1.1);
      }
      .hub-node h3 {
        font-size: 1.25rem;
        color: var(--text-color-white);
        margin-bottom: 0.5rem;
        transition: color 0.3s ease-in-out;
      }
      .hub-node:hover h3 {
        color: var(--accent-color);
      }
      .hub-node p {
        font-size: 0.9rem;
        color: var(--text-color-darker);
        line-height: 1.5;
      }
      .journey-panel .content-card {
        margin-bottom: 0;
      }
      .close-panel-btn {
        position: absolute;
        top: 1.5rem;
        right: 1.5rem;
        background: var(--repo-card-bg);
        border: 1px solid var(--glass-border-color);
        color: var(--text-color);
        width: 44px;
        height: 44px;
        border-radius: 50%;
        cursor: pointer;
        font-size: 1.5rem;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.3s ease;
        z-index: 10;
      }
      .close-panel-btn:hover {
        background: var(--accent-color);
        color: #121212;
        transform: scale(1.1) rotate(90deg);
      }
      .panel-content-grid {
        display: grid;
        grid-template-columns: 1fr;
        gap: 2rem;
      }
      @media (min-width: 768px) {
        .panel-content-grid {
          grid-template-columns: repeat(2, 1fr);
        }
      }
      .resume-header {
        text-align: center;
        margin-bottom: 2rem;
        padding-bottom: 2rem;
        border-bottom: 1px solid var(--glass-border-color);
      }
      .resume-header h1 {
        font-size: 2.5rem;
        color: var(--text-color-white);
        font-weight: 700;
        margin-bottom: 0.5rem;
      }
      .resume-contact {
        display: flex;
        justify-content: center;
        align-items: center;
        flex-wrap: wrap;
        gap: 1rem 2rem;
        color: var(--text-color-darker);
      }
      .resume-contact-item {
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }
      .resume-contact-item i {
        font-size: 1.2rem;
        color: var(--accent-color);
      }
      .resume-section {
        margin-bottom: 2.5rem;
      }
      .resume-section h3 {
        font-size: 1.25rem;
        font-weight: 600;
        color: var(--text-color-white);
        padding-bottom: 0.75rem;
        margin-bottom: 1.5rem;
        border-bottom: 1px solid var(--accent-color);
        display: inline-block;
      }
      .education-grid,
      .experience-grid {
        display: grid;
        gap: 1.5rem;
      }
      .education-item,
      .experience-item,
      .project-item {
        background: var(--repo-card-bg);
        padding: 1.5rem;
        border-radius: 16px;
      }
      .item-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 0.75rem;
        flex-wrap: wrap;
        gap: 0.5rem;
      }
      .item-header h4 {
        font-size: 1.1rem;
        font-weight: 600;
        color: var(--text-color);
      }
      .item-header .date {
        font-size: 0.9rem;
        color: var(--text-color-darker);
        font-weight: 500;
      }
      .item-subheader {
        font-size: 1rem;
        color: var(--text-color-darker);
        margin-bottom: 1rem;
        font-weight: 500;
      }
      .item-details p,
      .item-details ul {
        font-size: 0.95rem;
        line-height: 1.7;
        color: var(--text-color-darker);
      }
      .item-details ul {
        list-style-position: inside;
        padding-left: 0.5rem;
      }
      .item-details strong {
        color: var(--text-color);
        font-weight: 500;
      }
      .skills-container {
        display: flex;
        flex-wrap: wrap;
        gap: 1rem;
      }
      .skill-category {
        flex: 1 1 300px;
      }
      .skill-category h4 {
        font-size: 1.1rem;
        color: var(--text-color);
        margin-bottom: 1rem;
      }
      .skill-list {
        display: flex;
        flex-wrap: wrap;
        gap: 0.75rem;
      }
      .skill-tag {
        background-color: var(--repo-card-bg);
        color: var(--text-color);
        padding: 0.5rem 1rem;
        border-radius: 8px;
        font-size: 0.9rem;
        transition: all 0.2s ease;
      }
      .skill-tag:hover {
        background-color: var(--accent-color);
        color: #121212;
        transform: translateY(-2px);
      }
      .honors-list {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
        gap: 1rem;
      }
      .honor-item {
        background-color: var(--repo-card-bg);
        color: var(--text-color);
        padding: 1rem;
        border-radius: 12px;
        display: flex;
        align-items: center;
        gap: 1rem;
      }
      .honor-item i {
        font-size: 1.5rem;
        color: var(--accent-color);
      }

      /* 组件: 创造与知识面板 (Github & 书架) */
      .creations-tabs {
        display: flex;
        gap: 0.5rem;
        margin-bottom: 1.5rem;
        border-bottom: 1px solid var(--glass-border-color);
        padding: 0 1rem;
      }
      .tab-button {
        background: none;
        border: none;
        color: var(--text-color-darker);
        padding: 1rem;
        cursor: pointer;
        font-size: 1.05rem;
        font-weight: 500;
        position: relative;
        transition: color 0.3s ease;
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }
      .tab-button::after {
        content: "";
        position: absolute;
        bottom: -1px;
        left: 0;
        width: 100%;
        height: 2px;
        background-color: var(--accent-color);
        transform: scaleX(0);
        transition: transform 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
      }
      .tab-button.active {
        color: var(--text-color-white);
      }
      .tab-button.active::after {
        transform: scaleX(1);
      }
      .tab-content {
        padding: 0.5rem 1rem;
      }
      .filters-container {
        display: flex;
        flex-wrap: wrap;
        gap: 1rem;
        margin-bottom: 2rem;
        align-items: center;
      }
      .filters-container .filter-group {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        background-color: var(--repo-card-bg);
        padding: 0.5rem 1rem;
        border-radius: 12px;
      }
      .filters-container label {
        font-size: 0.9rem;
        color: var(--text-color-darker);
        font-weight: 500;
      }
      .filters-container select,
      .filters-container input {
        background: transparent;
        border: none;
        color: var(--text-color);
        font-family: inherit;
        font-size: 0.9rem;
      }
      .filters-container select:focus,
      .filters-container input:focus {
        outline: none;
      }
      .filters-container input {
        padding: 0.25rem;
        width: 120px;
      }
      .book-category-pills {
        display: flex;
        flex-wrap: wrap;
        gap: 0.75rem;
      }
      .book-category-pills button {
        background: var(--repo-card-bg);
        border: 1px solid transparent;
        color: var(--text-color-darker);
        padding: 0.5rem 1.25rem;
        border-radius: 999px;
        cursor: pointer;
        font-size: 0.9rem;
        transition: all 0.2s ease;
      }
      .book-category-pills button:hover {
        background: var(--repo-card-hover-bg);
        color: var(--text-color-white);
      }
      .book-category-pills button.active {
        background-color: var(--accent-color);
        color: #121212;
        font-weight: 600;
      }
      .repo-grid,
      .book-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
        gap: 1.5rem;
      }
      .repo-card,
      .book-card {
        background: var(--repo-card-bg);
        padding: 1.5rem;
        border-radius: 16px;
        text-decoration: none;
        color: var(--text-color-darker);
        transition: all 0.3s ease;
        display: flex;
        flex-direction: column;
        position: relative;
        border: 1px solid transparent;
        overflow: hidden; /* 添加此行以裁剪缎带 */
      }
      .book-card {
        align-items: center;
        text-align: center;
        cursor: pointer;
      }
      .repo-card:hover,
      .book-card:hover {
        background: var(--repo-card-hover-bg);
        transform: translateY(-5px);
        border-color: var(--glass-border-color);
      }
      .repo-card h3,
      .book-card h3 {
        color: var(--text-color-white);
        font-size: 1.1rem;
        margin-bottom: 0.5rem;
        word-break: break-all;
      }
      .book-card h3 {
        margin-top: 1rem;
      }
      .repo-card p,
      .book-card p {
        font-size: 0.9rem;
        line-height: 1.6;
        margin-bottom: 1rem;
        flex-grow: 1;
      }
      .book-card p {
        flex-grow: 0;
      }
      .book-cover {
        width: 100%;
        max-width: 150px;
        height: auto;
        aspect-ratio: 2 / 3;
        object-fit: cover;
        border-radius: 8px;
        display: block;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
      }
      .book-status-tag {
        position: absolute;
        top: 1rem;
        right: 1rem;
        font-size: 0.75rem;
        font-weight: 600;
        padding: 0.25rem 0.6rem;
        border-radius: 999px;
        text-transform: uppercase;
      }
      .book-status-tag.reading {
        background-color: rgba(59, 130, 246, 0.2);
        color: #60a5fa;
      }
      .book-status-tag.read {
        background-color: rgba(34, 197, 94, 0.2);
        color: #4ade80;
      }
      .repo-stats {
        display: flex;
        flex-wrap: wrap;
        gap: 1rem;
        font-size: 0.85rem;
        align-items: center;
      }
      .repo-stats span {
        display: flex;
        align-items: center;
        gap: 0.25rem;
      }
      .repo-stats svg {
        width: 14px;
        height: 14px;
      }
      .skeleton-card {
        background: var(--repo-card-bg);
        padding: 1.5rem;
        border-radius: 16px;
      }
      .skeleton-line {
        background: var(--repo-card-hover-bg);
        border-radius: 8px;
        animation: pulse-bg 1.5s infinite ease-in-out;
      }
      .skeleton-line.h-6 {
        height: 1.5rem;
        width: 60%;
        margin-bottom: 1rem;
      }
      .skeleton-line.h-4 {
        height: 1rem;
      }
      .skeleton-line.w-full {
        width: 100%;
        margin-bottom: 0.75rem;
      }
      .skeleton-line.w-80 {
        width: 80%;
        margin-bottom: 1.25rem;
      }
      .skeleton-line.w-40 {
        width: 40%;
      }
      .skeleton-footer {
        display: flex;
        gap: 1rem;
      }
      .github-overview {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 1.5rem;
        margin-bottom: 2rem;
      }
      .stat-card {
        background-color: var(--repo-card-bg);
        padding: 1.5rem;
        border-radius: 16px;
        text-align: center;
      }
      .stat-card .stat-value {
        font-size: 2rem;
        font-weight: 700;
        color: var(--accent-color);
      }
      .stat-card .stat-label {
        font-size: 0.9rem;
        color: var(--text-color-darker);
        margin-top: 0.5rem;
      }
      .pinned-repo-card {
        border: 1px solid rgba(var(--accent-color-rgb), 0.3);
      }
      .pinned-repo-card::before {
        content: "置顶";
        position: absolute;
        top: 15px;
        right: -35px;
        background: var(--accent-color);
        color: #121212;
        width: 120px;
        text-align: center;
        padding: 4px 0;
        font-size: 0.8rem;
        font-weight: 600;
        transform: rotate(45deg);
        z-index: 2;
      }
      .load-more-btn {
        width: 100%;
        padding: 0.8rem 1rem;
        margin-top: 1.5rem;
        border: none;
        background-color: var(--repo-card-bg);
        color: var(--text-color);
        font-size: 1rem;
        font-weight: 500;
        border-radius: 12px;
        cursor: pointer;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 0.5rem;
      }
      .load-more-btn:hover {
        background-color: var(--repo-card-hover-bg);
      }
      .load-more-btn:disabled {
        opacity: 0.6;
        cursor: not-allowed;
      }
      .book-modal-card {
        width: 600px;
        padding: 0;
        max-height: 90vh;
        display: flex;
        flex-direction: column;
      }
      .book-modal-content {
        display: flex;
        gap: 2rem;
        padding: 2.5rem;
      }
      .book-modal-cover {
        width: 180px;
        flex-shrink: 0;
      }
      .book-modal-cover img {
        width: 100%;
        height: auto;
        border-radius: 12px;
      }
      .book-modal-details {
        text-align: left;
      }
      .book-modal-details h3 {
        margin: 0 0 0.5rem;
        font-size: 1.8rem;
      }
      .book-modal-details .author {
        color: var(--text-color-darker);
        font-size: 1.1rem;
        margin-bottom: 1.5rem;
      }
      .rating-stars {
        color: #facc15;
        font-size: 1.2rem;
        margin-bottom: 1.5rem;
      }
      .book-modal-details .review {
        font-size: 1rem;
        line-height: 1.7;
        color: var(--text-color);
        font-style: italic;
        border-left: 2px solid var(--accent-color);
        padding-left: 1rem;
      }
      .book-modal-footer {
        margin-top: auto;
        background: var(--repo-card-bg);
        padding: 1rem 2.5rem;
        border-top: 1px solid var(--glass-border-color);
        display: flex;
        justify-content: flex-end;
      }
      .book-modal-link {
        background: var(--subscribe-btn-bg);
        color: white;
        text-decoration: none;
        padding: 0.6rem 1.2rem;
        border-radius: 8px;
        transition: opacity 0.2s;
      }
      .book-modal-link:hover {
        opacity: 0.9;
      }
      .activity-feed {
        max-height: 600px;
        overflow-y: auto;
        padding-right: 1rem;
      }
      .activity-feed::-webkit-scrollbar {
        width: 6px;
      }
      .activity-feed::-webkit-scrollbar-thumb {
        background-color: var(--accent-color);
        border-radius: 6px;
      }
      .activity-item {
        display: flex;
        gap: 1.5rem;
        position: relative;
        padding-bottom: 2rem;
      }
      .activity-item:last-child {
        padding-bottom: 0.5rem;
      }
      .activity-item:last-child::before {
        display: none;
      }
      .activity-item::before {
        content: "";
        position: absolute;
        left: 1.125rem;
        top: 2.25rem;
        width: 2px;
        height: 100%;
        background-color: var(--repo-card-bg);
      }
      .activity-icon {
        width: 2.25rem;
        height: 2.25rem;
        border-radius: 50%;
        background: var(--repo-card-bg);
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.25rem;
        flex-shrink: 0;
        z-index: 1;
      }
      .activity-content {
        padding-top: 0.25rem;
      }
      .activity-text {
        line-height: 1.6;
      }
      .activity-text strong {
        color: var(--text-color-white);
        font-weight: 500;
      }
      .activity-date {
        font-size: 0.85rem;
        color: var(--text-color-darker);
        margin-top: 0.25rem;
      }

      .blog-panel-content {
        display: flex;
        min-height: 80vh;
      }
      .blog-sidebar {
        width: 300px;
        flex-shrink: 0;
        border-right: 1px solid var(--glass-border-color);
        padding-right: 1.5rem;
        height: 80vh;
        display: flex;
        flex-direction: column;
      }
      .blog-category-filter {
        padding-bottom: 1rem;
        margin-bottom: 1rem;
        border-bottom: 1px solid var(--glass-border-color);
        display: flex;
        flex-wrap: wrap;
        gap: 0.5rem;
      }
      .blog-category-filter button {
        background: var(--repo-card-bg);
        border: 1px solid transparent;
        color: var(--text-color-darker);
        padding: 0.5rem 1rem;
        border-radius: 999px;
        cursor: pointer;
        font-size: 0.9rem;
        transition: all 0.2s ease;
      }
      .blog-category-filter button:hover {
        background: var(--repo-card-hover-bg);
        color: var(--text-color-white);
      }
      .blog-category-filter button.active {
        background-color: var(--accent-color);
        color: #121212;
        font-weight: 600;
        border-color: var(--accent-color);
      }
      .blog-post-list-container {
        flex-grow: 1;
        overflow-y: auto;
      }
      .blog-post-list-container::-webkit-scrollbar {
        width: 6px;
      }
      .blog-post-list-container::-webkit-scrollbar-thumb {
        background-color: var(--accent-color);
        border-radius: 6px;
      }
      .blog-post-item {
        padding: 1rem;
        border-radius: 12px;
        cursor: pointer;
        transition: all 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94);
      }
      .blog-post-item:not(:last-child) {
        margin-bottom: 0.5rem;
      }
      .blog-post-item h4 {
        color: var(--text-color);
        margin-bottom: 0.5rem;
        font-size: 1.1rem;
      }
      .blog-post-item p {
        color: var(--text-color-darker);
        font-size: 0.9rem;
      }
      .blog-post-item.active {
        background-color: var(--repo-card-bg);
      }
      .blog-post-item:hover:not(.active) {
        background-color: var(--repo-card-hover-bg);
        transform: translateX(5px) scale(1.02);
      }
      .blog-main {
        flex-grow: 1;
        padding-left: 2rem;
        height: 80vh;
        overflow-y: auto;
      }
      .blog-main::-webkit-scrollbar {
        width: 8px;
      }
      .blog-main::-webkit-scrollbar-thumb {
        background-color: var(--accent-color);
        border-radius: 8px;
      }
      .blog-post-content h2 {
        font-size: 2rem;
        color: var(--text-color-white);
        margin-bottom: 0.5rem;
        border-bottom: 1px solid var(--glass-border-color);
        padding-bottom: 1rem;
      }
      .blog-post-meta {
        color: var(--text-color-darker);
        margin-bottom: 2rem;
      }
      .blog-post-body {
        line-height: 1.8;
        font-size: 1.05rem;
      }
      .blog-post-body > *:first-child {
        margin-top: 0;
      }
      .blog-post-body p {
        margin-bottom: 1em;
      }
      .blog-post-body h3 {
        font-size: 1.5em;
        margin: 1.5em 0 1em;
        color: var(--text-color-white);
      }
      .blog-post-body h4 {
        font-size: 1.2em;
        margin: 1.2em 0 1em;
        color: var(--text-color-white);
      }
      .blog-post-body a {
        color: var(--accent-color);
      }
      .blog-post-body ul,
      .blog-post-body ol {
        padding-left: 1.5em;
        margin-bottom: 1em;
      }
      .blog-post-body blockquote {
        border-left: 4px solid var(--accent-color);
        padding-left: 1em;
        margin: 1.5em 0;
        color: var(--text-color-darker);
      }
      .blog-post-body pre {
        background-color: rgba(0, 0, 0, 0.3);
        padding: 1rem;
        border-radius: 8px;
        overflow-x: auto;
        border: 1px solid var(--glass-border-color);
        margin: 1.5em 0;
      }
      .blog-post-body code {
        font-family: "Courier New", Courier, monospace;
      }
      .timeline {
        position: relative;
        padding-left: 2rem;
        --line-color: var(--accent-color);
      }
      .timeline::before {
        content: "";
        position: absolute;
        left: 0;
        top: 0;
        width: 2px;
        height: 100%;
        background-color: var(--repo-card-bg);
      }
      .timeline::after {
        content: "";
        position: absolute;
        left: 0;
        top: 0;
        width: 2px;
        height: 100%;
        background-color: var(--line-color);
        transform: scaleY(0);
        transform-origin: top;
        transition: transform 1s ease-out;
      }
      .timeline.is-visible::after {
        transform: scaleY(1);
      }
      .timeline-item {
        position: relative;
        margin-bottom: 2rem;
        opacity: 0;
        transform: translateX(20px);
        transition: opacity 0.6s ease-out, transform 0.6s ease-out;
      }
      .timeline-item.is-visible {
        opacity: 1;
        transform: translateX(0);
      }
      .timeline-item:last-child {
        margin-bottom: 0;
      }
      .timeline-item::before {
        content: "";
        position: absolute;
        left: -2.5rem;
        top: 4px;
        width: 14px;
        height: 14px;
        background-color: var(--body-bg-color);
        border-radius: 50%;
        border: 3px solid var(--line-color);
        z-index: 1;
        transform: scale(0);
        transition: transform 0.4s ease-out 0.5s;
      }
      .timeline-item.is-visible::before {
        transform: scale(1);
      }
      .timeline-date {
        font-weight: 600;
        color: var(--text-color-white);
      }
      .timeline-desc {
        margin-top: 0.5rem;
        color: var(--text-color-darker);
      }
      .target-list {
        display: flex;
        flex-direction: column;
        gap: 1.5rem;
      }
      .target-item {
        display: flex;
        flex-direction: column;
        gap: 0.75rem;
      }
      .target-info {
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-size: 0.95rem;
      }
      .target-name {
        color: var(--text-color);
        font-weight: 500;
      }
      .target-progress-text {
        color: var(--text-color-darker);
        font-size: 0.9rem;
      }
      .progress-bar-container {
        width: 100%;
        height: 8px;
        background-color: var(--repo-card-bg);
        border-radius: 4px;
        overflow: hidden;
      }
      .progress-bar {
        height: 100%;
        background: linear-gradient(90deg, var(--accent-color), #3b82f6);
        border-radius: 4px;
        width: 0;
        transition: width 1s cubic-bezier(0.25, 1, 0.5, 1) 0.3s;
      }
      .interest-pills-container {
        display: flex;
        gap: 1rem;
        overflow-x: auto;
        padding: 0.5rem 0 1.5rem 0;
        margin-bottom: 2rem;
        -webkit-overflow-scrolling: touch;
        scrollbar-width: none;
        -ms-overflow-style: none;
      }
      .interest-pills-container::-webkit-scrollbar {
        display: none;
      }
      .interest-pill {
        display: flex;
        align-items: center;
        gap: 0.75rem;
        background-color: var(--repo-card-bg);
        border: 1px solid var(--glass-border-color);
        color: var(--text-color-darker);
        padding: 0.75rem 1.5rem;
        border-radius: 999px;
        cursor: pointer;
        font-size: 1rem;
        font-weight: 500;
        white-space: nowrap;
        transition: all 0.3s ease;
        flex-shrink: 0;
      }
      .interest-pill:hover {
        background-color: var(--repo-card-hover-bg);
        color: var(--text-color-white);
        transform: translateY(-2px);
      }
      .interest-pill.is-active {
        background-color: var(--accent-color);
        color: #121212;
        border-color: var(--accent-color);
        box-shadow: 0 0 15px var(--glow-color);
      }
      .interest-pill i {
        font-size: 1.25rem;
      }
      .interest-details-container {
        min-height: 400px;
        background-color: var(--repo-card-bg);
        border-radius: 16px;
        padding: 2rem;
      }
      .interest-details-content .video-container {
        position: relative;
        padding-bottom: 56.25%;
        height: 0;
        overflow: hidden;
        max-width: 100%;
        background: #000;
        border-radius: 12px;
        margin-bottom: 2rem;
      }
      .interest-details-content .video-container iframe {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        border: 0;
      }
      .interest-markdown-content {
        line-height: 1.8;
      }
      .interest-markdown-content > *:first-child {
        margin-top: 0;
      }
      .interest-markdown-content p {
        margin-bottom: 1em;
      }
      .interest-markdown-content h3 {
        font-size: 1.5em;
        margin: 1.5em 0 1em;
        color: var(--text-color-white);
      }
      .interest-markdown-content h4 {
        font-size: 1.2em;
        margin: 1.2em 0 1em;
        color: var(--text-color-white);
      }
      .interest-markdown-content a {
        color: var(--accent-color);
      }
      .interest-markdown-content ul,
      .interest-markdown-content ol {
        padding-left: 1.5em;
        margin-bottom: 1em;
      }
      .interest-markdown-content blockquote {
        border-left: 4px solid var(--accent-color);
        padding-left: 1em;
        margin: 1.5em 0;
        color: var(--text-color-darker);
      }
      .interest-markdown-content pre {
        background-color: rgba(0, 0, 0, 0.3);
        padding: 1rem;
        border-radius: 8px;
        overflow-x: auto;
        border: 1px solid var(--glass-border-color);
        margin: 1.5em 0;
      }
      .interest-markdown-content code {
        font-family: "Courier New", Courier, monospace;
      }
      .chatbot-card {
        display: flex;
        flex-direction: column;
        min-height: 70vh;
        max-height: 120vh;
        transition: all 0.3s ease;
      }
      .chatbot-settings {
        display: grid;
        grid-template-columns: 1fr;
        gap: 1rem;
        margin-bottom: 1.5rem;
      }
      @media (min-width: 900px) {
        .chatbot-settings {
          grid-template-columns: repeat(3, 1fr);
        }
      }
      .setting-item {
        display: flex;
        flex-direction: column;
        gap: 0.5rem;
      }
      .api-key-group {
        grid-column: 1 / -1;
      }
      .setting-item label {
        font-size: 0.9rem;
        color: var(--text-color-darker);
        display: flex;
        justify-content: space-between;
        align-items: center;
      }
      .tooltip-icon {
        color: var(--text-color-darker);
        font-size: 1rem;
        cursor: help;
        margin-left: 0.5rem;
      }
      .setting-item input[type="password"],
      .setting-item input[type="range"] {
        width: 100%;
        padding: 0.5rem 0.75rem;
        border-radius: 12px;
        border: 1px solid var(--glass-border-color);
        background: var(--input-bg);
        color: var(--text-color);
        font-size: 0.9rem;
      }
      .setting-item input[type="range"]:disabled {
        opacity: 0.5;
        cursor: not-allowed;
      }
      .setting-item input[type="password"]:focus {
        outline: none;
        border-color: var(--accent-color);
        box-shadow: 0 0 0 2px var(--accent-color);
      }
      .get-api-key-link {
        font-size: 0.8rem;
        color: var(--accent-color);
        text-decoration: none;
      }
      .get-api-key-link:hover {
        text-decoration: underline;
      }
      .chat-window {
        flex-grow: 1;
        overflow-y: auto;
        padding: 1rem;
        background-color: var(--repo-card-bg);
        border-radius: 16px;
        margin-bottom: 1rem;
      }
      .chat-window::-webkit-scrollbar {
        width: 8px;
      }
      .chat-window::-webkit-scrollbar-track {
        background: transparent;
      }
      .chat-window::-webkit-scrollbar-thumb {
        background-color: var(--accent-color);
        border-radius: 8px;
      }
      .chat-status {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 0.75rem;
        padding: 0.5rem;
        font-size: 0.9rem;
        color: var(--text-color-darker);
        margin-bottom: 1rem;
      }
      .animate-spin {
        animation: spin 1s linear infinite;
      }
      .message {
        margin-bottom: 1rem;
        display: flex;
        flex-direction: column;
      }
      .message.user {
        align-items: flex-end;
      }
      .message.assistant {
        align-items: flex-start;
      }
      .message-content {
        max-width: 90%;
        padding: 0.8rem 1.2rem;
        border-radius: 18px;
        line-height: 1.7;
        position: relative;
        word-wrap: break-word;
        display: flex;
        flex-direction: column;
        gap: 0.75rem;
      }
      .message-content > :first-child {
        margin-top: 0;
      }
      .message-content > :last-child {
        margin-bottom: 0;
      }
      .message-content p,
      .message-content ul,
      .message-content ol {
        margin: 0;
      }
      .message-content ul,
      .message-content ol {
        padding-left: 1.5rem;
      }
      .message.user .message-content {
        background-color: var(--accent-color);
        color: #121212;
        border-bottom-right-radius: 4px;
      }
      .message.assistant .message-content {
        background-color: var(--repo-card-hover-bg);
        color: var(--text-color);
        border-bottom-left-radius: 4px;
      }
      .message.assistant .thinking-process {
        border-bottom: 1px solid var(--glass-border-color);
        margin-bottom: 1rem;
        padding-bottom: 1rem;
        font-size: 0.9em;
        color: var(--text-color-darker);
        opacity: 0.8;
      }
      .message.assistant pre {
        background-color: rgba(0, 0, 0, 0.3);
        padding: 1rem;
        border-radius: 8px;
        overflow-x: auto;
        font-size: 0.9em;
        border: 1px solid var(--glass-border-color);
      }
      .message.assistant code {
        font-family: "Courier New", Courier, monospace;
      }
      .message-content .katex-display {
        overflow-x: auto;
        overflow-y: hidden;
        padding: 0.5rem 0;
      }
      .copy-button {
        position: absolute;
        bottom: 8px;
        right: 8px;
        background: rgba(0, 0, 0, 0.1);
        border: none;
        color: var(--text-color-darker);
        cursor: pointer;
        padding: 6px;
        border-radius: 6px;
        opacity: 0;
        transition: all 0.2s;
        font-size: 1rem;
        line-height: 1;
      }
      .message-content:hover .copy-button {
        opacity: 1;
      }
      .copy-button:hover {
        background: rgba(0, 0, 0, 0.2);
        color: var(--text-color-white);
      }
      .copy-button .ph-check {
        color: var(--accent-color);
        font-weight: bold;
      }
      .thinking-process-container {
        border-bottom: 1px solid var(--glass-border-color);
        margin: -0.25rem 0 0.75rem;
        padding-bottom: 0.75rem;
      }
      .toggle-thinking-btn {
        background: none;
        border: none;
        color: var(--text-color-darker);
        cursor: pointer;
        display: flex;
        align-items: center;
        gap: 0.5rem;
        padding: 0;
        margin-bottom: 0.5rem;
        font-size: 0.9em;
        font-weight: 500;
      }
      .toggle-thinking-btn:hover {
        color: var(--text-color-white);
      }
      .toggle-thinking-btn i {
        transition: transform 0.2s ease;
      }
      .thinking-process-content {
        font-size: 0.9em;
        color: var(--text-color-darker);
        opacity: 0.9;
        max-height: 200px;
        overflow-y: auto;
        padding-right: 5px;
      }
      .thinking-process-content::-webkit-scrollbar {
        width: 4px;
      }
      .thinking-process-content::-webkit-scrollbar-thumb {
        background-color: var(--accent-color);
        border-radius: 4px;
      }
      .chat-input-area {
        display: flex;
        gap: 1rem;
      }
      .chat-input-area textarea {
        flex-grow: 1;
        padding: 0.75rem 1rem;
        border-radius: 16px;
        border: 1px solid var(--glass-border-color);
        background: var(--input-bg);
        color: var(--text-color);
        font-size: 1rem;
        resize: none;
        height: 50px;
        transition: all 0.2s;
      }
      .chat-input-area textarea:focus {
        outline: none;
        border-color: var(--accent-color);
        box-shadow: 0 0 0 2px var(--accent-color);
        height: 80px;
      }
      .send-button {
        padding: 0.75rem 1.25rem;
        border-radius: 16px;
        border: none;
        background-color: var(--subscribe-btn-bg);
        color: white;
        cursor: pointer;
        font-size: 1rem;
        transition: background-color 0.3s;
      }
      .send-button:disabled {
        background-color: var(--text-color-darker);
        cursor: not-allowed;
      }
      .custom-toggle {
        display: flex;
        flex-direction: row !important;
        align-items: center;
        justify-content: space-between;
        padding: 0.5rem 0.75rem;
        border-radius: 12px;
        border: 1px solid var(--glass-border-color);
        background: var(--input-bg);
        height: 100%;
      }
      .custom-toggle label {
        margin: 0;
        color: var(--text-color);
      }
      .toggle-switch {
        width: 44px;
        height: 24px;
        background-color: rgba(255, 255, 255, 0.1);
        border-radius: 12px;
        padding: 2px;
        cursor: pointer;
        transition: background-color 0.2s ease;
      }
      .toggle-switch.active {
        background-color: var(--accent-color);
      }
      .toggle-knob {
        width: 20px;
        height: 20px;
        background-color: white;
        border-radius: 50%;
        transition: transform 0.2s ease;
      }
      .toggle-switch.active .toggle-knob {
        transform: translateX(20px);
      }
      .history-controls {
        display: flex;
        gap: 0.5rem;
        align-items: center;
      }
      .chat-history-dropdown {
        position: relative;
        flex-grow: 1;
      }
      .dropdown-trigger {
        width: 100%;
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 0.5rem 0.75rem;
        height: 38px;
        border-radius: 12px;
        border: 1px solid var(--glass-border-color);
        background: var(--input-bg);
        color: var(--text-color);
        font-size: 0.9rem;
        text-align: left;
        cursor: pointer;
      }
      .dropdown-trigger span {
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
      }
      .dropdown-menu {
        position: absolute;
        bottom: calc(100% + 5px);
        left: 0;
        width: 100%;
        z-index: 10;
        list-style: none;
        border-radius: 12px;
        padding: 0.5rem;
        max-height: 200px;
        overflow-y: auto;
        background: var(--glass-bg);
        border: 1px solid var(--glass-border-color);
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
      }
      .dropdown-menu::-webkit-scrollbar {
        width: 6px;
      }
      .dropdown-menu::-webkit-scrollbar-thumb {
        background-color: var(--accent-color);
        border-radius: 6px;
      }
      .dropdown-item {
        padding: 0.6rem 0.75rem;
        border-radius: 8px;
        cursor: pointer;
        transition: background-color 0.2s;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
      }
      .dropdown-item:hover {
        background-color: var(--repo-card-hover-bg);
      }
      .dropdown-item.active {
        background-color: var(--accent-color);
        color: #121212;
        font-weight: 500;
      }
      .history-btn {
        flex-shrink: 0;
        width: 38px;
        height: 38px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 12px;
        border: 1px solid var(--glass-border-color);
        background: var(--input-bg);
        color: var(--text-color);
        font-size: 1.1rem;
        cursor: pointer;
        transition: all 0.2s ease;
      }
      .history-btn:hover {
        border-color: var(--accent-color);
      }
      .fab-form-title {
        text-align: center;
        color: var(--text-color-white);
        font-size: 1.1rem;
        font-weight: 600;
        margin-bottom: 0.5rem;
      }
      .fab-container {
        position: fixed;
        bottom: 30px;
        left: 30px;
        z-index: 15;
        transition: width 0.6s cubic-bezier(0.65, 0, 0.35, 1),
          height 0.6s cubic-bezier(0.65, 0, 0.35, 1),
          border-radius 0.6s cubic-bezier(0.65, 0, 0.35, 1);
        width: 60px;
        height: 60px;
        border-radius: 30px;
      }
      .fab-container.expanded {
        width: min(400px, 90vw);
        height: 320px;
        border-radius: 24px;
      }
      .fab-toggle {
        position: absolute;
        top: 0;
        right: 0;
        z-index: 17;
        background-color: var(--accent-color);
        color: #121212;
        width: 60px;
        height: 60px;
        border-radius: 50%;
        border: none;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.8rem;
        cursor: pointer;
        box-shadow: 0 4px 12px var(--shadow-color);
        transition: all 0.4s cubic-bezier(0.65, 0, 0.35, 1);
      }
      .fab-toggle:hover {
        transform: scale(1.1) rotate(15deg);
      }
      .fab-container.expanded .fab-toggle {
        background-color: transparent;
        color: var(--text-color);
        box-shadow: none;
        transform: rotate(180deg);
      }
      .fab-container.expanded .fab-toggle:hover {
        transform: scale(1.1) rotate(180deg);
      }
      .fab-form {
        width: 100%;
        height: 100%;
        padding: 1.5rem;
        box-sizing: border-box;
        opacity: 0;
        pointer-events: none;
        transform: translateY(10px);
        transition: opacity 0.4s ease 0.2s, transform 0.4s ease 0.2s;
        display: flex;
        flex-direction: column;
      }
      .fab-container.expanded .fab-form {
        opacity: 1;
        pointer-events: auto;
        transform: translateY(0);
      }
      .fab-form .form-group {
        margin-bottom: 1rem;
      }
      .fab-form .form-group input,
      .fab-form .form-group textarea {
        width: 100%;
        padding: 0.6rem 0.8rem;
        border-radius: 12px;
        border: 1px solid var(--glass-border-color);
        color: var(--text-color);
        font-size: 0.9rem;
        background: var(--input-bg);
      }
      .fab-form .form-group textarea {
        resize: none;
        height: 80px;
      }
      .fab-form .form-group input:focus,
      .fab-form .form-group textarea:focus {
        outline: none;
        border-color: var(--accent-color);
      }
      .fab-form .form-submit-button {
        margin-top: auto;
      }
      .footer-section {
        padding: 4rem 2rem 2rem;
        text-align: center;
        color: var(--text-color-darker);
        border-radius: 24px 24px 0 0;
      }
      html.light-theme .footer-section {
        --glass-bg: rgba(247, 248, 250, 0.7);
      }
      .footer-title {
        font-size: 1.5rem;
        margin-bottom: 1rem;
        color: var(--text-color-white);
      }
      .footer-subtitle {
        margin-bottom: 2.5rem;
      }
      .icon-links-bar {
        display: flex;
        justify-content: center;
        flex-wrap: wrap;
        gap: 1rem 1.5rem;
        margin-bottom: 2.5rem;
      }
      .icon-link {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        color: var(--text-color-darker);
        text-decoration: none;
        transition: color 0.3s ease;
      }
      .icon-link:hover {
        color: var(--text-color-white);
      }
      .icon-link svg {
        width: 18px;
        height: 18px;
      }
      .icon-link span {
        font-size: 0.9rem;
      }
      .info-links {
        display: flex;
        justify-content: center;
        flex-wrap: wrap;
        gap: 0.5rem 1.5rem;
        margin-bottom: 1.5rem;
      }
      .info-links a {
        color: var(--text-color-darker);
        text-decoration: none;
        font-size: 0.85rem;
      }
      .info-links a:hover {
        color: var(--text-color-white);
      }
      .copyright-info {
        border-top: 1px solid var(--glass-border-color);
        padding-top: 1.5rem;
        font-size: 0.85rem;
        position: relative;
        transition: border-color 0.3s ease;
      }
      .copyright-info p {
        margin-bottom: 0.5rem;
      }
      .copyright-info .site-info-item {
        display: inline-block;
        margin: 0 0.5rem;
      }
      .theme-switcher {
        position: absolute;
        right: 0;
        top: 50%;
        transform: translateY(-50%);
        display: flex;
        gap: 0.5rem;
        background: var(--theme-switcher-bg);
        padding: 0.3rem;
        border-radius: 20px;
        transition: background-color 0.3s ease;
      }
      .theme-switcher button {
        background: none;
        border: none;
        color: var(--text-color-darker);
        cursor: pointer;
        padding: 0.3rem;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .theme-switcher button.active {
        background: var(--subscribe-btn-bg);
        color: white;
      }
      .theme-switcher svg {
        width: 14px;
        height: 14px;
      }

      /* 组件: 创造与知识面板 (Github & 书架) - '成长与动态' Tab 优化布局 */
      .growth-grid {
        display: grid;
        grid-template-columns: 1fr;
        gap: 1.5rem;
      }
      @media (min-width: 900px) {
        .growth-grid {
          grid-template-columns: minmax(0, 1fr) minmax(0, 1fr);
          align-items: stretch; /* Stretch cards to be same height */
        }
      }
      .growth-right-column {
        display: flex;
        flex-direction: column;
        gap: 1.5rem;
      }
      .growth-card {
        background: var(--repo-card-bg);
        padding: 1.5rem;
        border-radius: 16px;
        display: flex;
        flex-direction: column;
      }
      .growth-card h3 {
        font-size: 1.25rem;
        font-weight: 600;
        color: var(--text-color-white);
        margin: 0 0 1.5rem 0;
        padding-bottom: 1rem;
        border-bottom: 1px solid var(--glass-border-color);
        display: flex;
        align-items: center;
        gap: 0.75rem;
        flex-shrink: 0;
      }
      /* Make right-column cards share space, with activity feed being flexible */
      .growth-right-column .growth-card:last-child {
        flex-grow: 1;
      }
      .growth-card .activity-feed {
        flex-grow: 1;
        min-height: 200px; /* Ensure it has some height even if content is short */
        max-height: 350px;
      }

      /* --- 6. 动画效果 --- */
      @keyframes wave {
        0% {
          transform: rotate(0deg);
        }
        10% {
          transform: rotate(14deg);
        }
        20% {
          transform: rotate(-8deg);
        }
        30% {
          transform: rotate(14deg);
        }
        40% {
          transform: rotate(-4deg);
        }
        50% {
          transform: rotate(10deg);
        }
        60% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(0deg);
        }
      }
      @keyframes spin {
        to {
          transform: rotate(360deg);
        }
      }
      @keyframes blink {
        0%,
        100% {
          opacity: 1;
        }
        50% {
          opacity: 0;
        }
      }
      @keyframes danmaku-scroll {
        from {
          transform: translateX(100vw);
        }
        to {
          transform: translateX(-100vw);
        }
      }
      @keyframes pulse-core {
        0%,
        100% {
          transform: translate(-50%, -50%) scale(1);
          box-shadow: 0 0 15px var(--accent-color), 0 0 30px var(--accent-color);
        }
        50% {
          transform: translate(-50%, -50%) scale(1.2);
          box-shadow: 0 0 25px var(--accent-color), 0 0 50px var(--accent-color);
        }
      }
      @keyframes orbit {
        from {
          transform: rotate(0deg) translateX(45px) rotate(0deg);
        }
        to {
          transform: rotate(360deg) translateX(45px) rotate(-360deg);
        }
      }
      @keyframes orbit-reverse {
        from {
          transform: rotate(0deg) translateX(35px) rotate(0deg) scale(0.8);
        }
        to {
          transform: rotate(-360deg) translateX(35px) rotate(360deg) scale(0.8);
        }
      }
      @keyframes orbit-vertical {
        0% {
          transform: rotate(90deg) translateX(55px) rotate(-90deg) scale(1.1);
        }
        100% {
          transform: rotate(450deg) translateX(55px) rotate(-450deg) scale(1.1);
        }
      }
      @keyframes pulse-bg {
        0%,
        100% {
          opacity: 1;
        }
        50% {
          opacity: 0.5;
        }
      }
      .player-fade-enter-active,
      .player-fade-leave-active {
        transition: all 0.4s ease-in-out;
      }
      .player-fade-enter-from,
      .player-fade-leave-to {
        opacity: 0;
        transform: scale(0.95);
      }
      .panel-fade-enter-active,
      .panel-fade-leave-active {
        transition: opacity 0.4s ease-in-out;
      }
      .panel-fade-enter-from,
      .panel-fade-leave-to {
        opacity: 0;
      }
      .panel-fade-enter-active {
        transition-delay: 0.2s;
      }
      .post-fade-enter-active,
      .post-fade-leave-active {
        transition: opacity 0.4s ease, transform 0.4s ease;
      }
      .post-fade-enter-from,
      .post-fade-leave-to {
        opacity: 0;
        transform: translateY(15px);
      }
      .list-fade-enter-active,
      .list-fade-leave-active,
      .list-fade-move {
        transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
      }
      .list-fade-enter-from,
      .list-fade-leave-to {
        opacity: 0;
        transform: translateX(20px);
      }
      .list-fade-leave-active {
        position: absolute;
        width: calc(100% - 2rem);
      }
      @keyframes slide-up-fade-in {
        from {
          opacity: 0;
          transform: translateY(20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }
      .panel-fade-enter-active .blog-sidebar {
        animation: slide-up-fade-in 0.6s 0.3s backwards;
      }
      .panel-fade-enter-active .blog-main {
        animation: slide-up-fade-in 0.6s 0.4s backwards;
      }
      .dropdown-fade-enter-active,
      .dropdown-fade-leave-active {
        transition: all 0.2s ease;
      }
      .dropdown-fade-enter-from,
      .dropdown-fade-leave-to {
        opacity: 0;
        transform: translateY(10px);
      }
      .content-fade-enter-active,
      .content-fade-leave-active {
        transition: opacity 0.4s ease, transform 0.4s ease;
      }
      .content-fade-enter-from,
      .content-fade-leave-to {
        opacity: 0;
        transform: translateY(15px);
      }
      .anim-fade-in-up {
        opacity: 0;
        transform: translateY(30px);
        transition: opacity 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94),
          transform 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94);
      }
      .anim-fade-in-up.is-visible {
        opacity: 1;
        transform: translateY(0);
      }

      /* --- 7. 响应式设计 --- */
      @media (max-width: 900px) {
        .hub-intro h2 {
          font-size: 2rem;
        }
        .hub-intro blockquote {
          font-size: 1.2rem;
        }
        .book-grid {
          grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
        }
        .blog-panel-content {
          flex-direction: column;
        }
        .blog-sidebar {
          width: 100%;
          border-right: none;
          border-bottom: 1px solid var(--glass-border-color);
          padding-right: 0;
          padding-bottom: 1rem;
          margin-bottom: 1.5rem;
          height: auto;
          max-height: 50vh;
        }
        .blog-main {
          padding-left: 0;
          height: 50vh;
        }
        .book-modal-content {
          flex-direction: column;
          align-items: center;
          text-align: center;
        }
        .book-modal-details {
          text-align: center;
        }
        .book-modal-details .review {
          text-align: left;
        }
      }
      @media (max-width: 768px) {
        .custom-player-controls .volume-control-wrapper {
          display: none;
        }
        .resume-header h1 {
          font-size: 2rem;
        }
        .resume-contact {
          gap: 0.5rem 1rem;
          flex-direction: column;
          align-items: flex-start;
          margin: 0 auto;
          max-width: 250px;
        }
        .custom-player {
          flex-direction: column;
          gap: 1.5rem;
        }
        .custom-player-info-wrapper {
          width: 100%;
        }
        .custom-player-controls {
          flex-wrap: wrap;
          justify-content: center;
        }
      }
      @media (max-width: 600px) {
        .main-header {
          padding: 4px;
        }
        .header-nav a {
          margin: 0;
          padding: 0 0.75rem;
        }
        .modal-card-container {
          padding: 1rem;
        }
        .modal-card {
          padding: 2rem 1.5rem;
          border-radius: 1rem;
        }
        .modal-card:not(.book-modal-card) {
          width: 100%;
        }
        .book-modal-card {
          width: 90vw;
        }
        .copyright-info {
          text-align: left;
          padding-right: 60px;
        }
        .theme-switcher {
          top: 1.5rem;
          transform: none;
        }
        .hero-player-container {
          padding: 0;
          width: calc(100% - 40px);
          max-width: calc(100% - 40px);
        }
        .hub-grid {
          grid-template-columns: 1fr;
        }
        .book-grid {
          grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
          gap: 1rem;
        }
        .fab-container {
          bottom: 20px;
          left: 20px;
          width: 50px;
          height: 50px;
          border-radius: 25px;
        }
        .fab-toggle {
          width: 50px;
          height: 50px;
          font-size: 1.5rem;
        }
        .fab-container.expanded {
          width: min(350px, 90vw);
          height: 270px;
        }
        .play-button {
          width: 50px;
          height: 50px;
        }
        .play-button i {
          width: 24px;
          height: 24px;
          font-size: 24px;
        }
      }
    </style>
  </head>

  <body>
    <div id="loader-wrapper">
      <div class="loader-container">
        <div class="loader-core"></div>
        <div class="loader-electron"></div>
        <div class="loader-electron"></div>
        <div class="loader-electron"></div>
      </div>
    </div>
    <canvas id="particle-canvas"></canvas>
    <div id="app">
      <header
        class="main-header glass-effect"
        :class="{ 'is-expanded': isHeaderExpanded, 'is-visible': isHeaderVisible }"
      >
        <img
          src="./content/icon/128.png"
          alt="导航头像，点击可登录"
          class="header-avatar"
          @click="toggleLoginModal"
        />
        <nav class="header-nav" aria-label="主导航">
          <button
            v-for="link in visibleNavLinks"
            :key="link.id"
            @click="handleNavClick(link.id)"
            :class="{ active: activeSection === link.id }"
            :aria-current="activeSection === link.id ? 'page' : false"
          >
            {{ link.text }}
          </button>
        </nav>
      </header>

      <div
        class="modal-overlay"
        :class="{'is-visible': isLoginModalVisible}"
        @click.self="toggleLoginModal"
      >
        <div
          role="dialog"
          aria-modal="true"
          aria-labelledby="login-title"
          class="modal-container"
        >
          <div class="modal-card-container">
            <div class="modal-card glass-effect">
              <form @submit.prevent="handleLogin">
                <h3 id="login-title">管理员登录</h3>
                <p
                  class="modal-status-message"
                  :class="loginStatus.type"
                  aria-live="polite"
                >
                  {{ loginStatus.message }}
                </p>
                <div class="form-group">
                  <label for="username">用户名</label
                  ><input
                    type="text"
                    id="username"
                    v-model="username"
                    required
                    autocomplete="username"
                  />
                </div>
                <div class="form-group">
                  <label for="password">密码</label
                  ><input
                    type="password"
                    id="password"
                    v-model="password"
                    required
                    autocomplete="current-password"
                  />
                </div>
                <button
                  type="submit"
                  class="form-submit-button"
                  :disabled="isLoggingIn"
                >
                  <i v-if="isLoggingIn" class="ph ph-spinner-gap"></i
                  ><span>{{ isLoggingIn ? '登录中...' : '登录' }}</span>
                </button>
              </form>
            </div>
          </div>
        </div>
      </div>

      <div
        class="modal-overlay"
        :class="{'is-visible': isBookModalVisible}"
        @click.self="closeBookModal"
      >
        <div
          role="dialog"
          aria-modal="true"
          aria-labelledby="book-title"
          class="modal-container"
          v-if="selectedBook"
        >
          <div class="modal-card-container">
            <div class="modal-card glass-effect book-modal-card">
              <div class="book-modal-content">
                <div class="book-modal-cover">
                  <img
                    :src="selectedBook.coverUrl"
                    :alt="selectedBook.title"
                    @error="handleImgError"
                  />
                </div>
                <div class="book-modal-details">
                  <h3 id="book-title">{{ selectedBook.title }}</h3>
                  <p class="author">{{ selectedBook.author }}</p>
                  <div
                    class="rating-stars"
                    :aria-label="selectedBook.rating + ' 星评价'"
                  >
                    <span v-for="n in 5" :key="n"
                      >{{ n <= selectedBook.rating ? '★' : '☆' }}</span
                    >
                  </div>
                  <p class="review">“{{ selectedBook.review }}”</p>
                </div>
              </div>
              <div class="book-modal-footer">
                <a
                  :href="selectedBook.url"
                  target="_blank"
                  class="book-modal-link"
                  >查看详情</a
                >
              </div>
            </div>
          </div>
        </div>
      </div>

      <div
        class="scroll-indicator"
        :class="{ 'is-scrolling': isScrolling }"
        aria-hidden="true"
      >
        <div
          class="scroll-star"
          :style="{ transform: `translateY(calc(100vh * ${scrollProgress} - 50%))` }"
        ></div>
      </div>
      <main class="main-content">
        <section
          class="initial-hero-section"
          id="initial-hero"
          data-section="hero"
          aria-labelledby="hero-main-title"
        >
          <div class="danmaku-container" aria-hidden="true">
            <transition-group name="danmaku-fade"
              ><div
                v-for="item in activeDanmaku"
                :key="item.id"
                class="danmaku-item"
                :style="item.style"
              >
                {{ item.name }}: {{ item.message }}
              </div></transition-group
            >
          </div>
          <div class="hero-text-container">
            <p>
              {{ heroLine1 }}<span v-if="heroLine1Active" class="waving-hand"
                >👋</span
              >
            </p>
            <p>
              {{ heroLine2 }}<span
                v-if="heroLine2Active"
                class="typing-cursor-hero"
              ></span>
            </p>
            <p>
              {{ heroLine3 }}<span
                v-if="heroLine3Active"
                class="typing-cursor-hero"
              ></span>
            </p>
            <p>
              {{ heroLine4 }}<span
                v-if="heroLine4Active"
                class="typing-cursor-hero"
              ></span>
            </p>
          </div>
          <div
            class="hero-bottom-content"
            :class="{ visible: showHeroButtons }"
          >
            <div class="hero-player-container">
              <transition name="player-fade"
                ><p v-if="player.error" class="error-message">
                  {{ player.error }}
                </p>
                <button
                  v-else-if="!player.isInitialized && !player.isLoading"
                  @click="switchSonglist(currentSongId)"
                  aria-label="播放音乐"
                  class="play-button glass-effect"
                >
                  <i class="ph-fill ph-play"></i></button></transition
              ><transition name="player-fade"
                ><div
                  v-if="player.isLoading"
                  class="loading-spinner"
                  aria-label="音乐加载中"
                ></div></transition
              ><transition name="player-fade"
                ><div
                  class="player-wrapper glass-effect"
                  v-if="player.isInitialized"
                >
                  <div id="player" class="custom-player">
                    <img
                      :src="player.currentSong.cover"
                      :alt="`${player.currentSong.name} 的封面`"
                      class="custom-player-cover"
                    />
                    <div class="custom-player-info-wrapper">
                      <div class="custom-player-info">
                        <div class="custom-player-title">
                          {{ player.currentSong.name }}
                        </div>
                        <div class="custom-player-artist">
                          {{ player.currentSong.artist }}
                        </div>
                      </div>
                      <div
                        class="custom-player-progress-container"
                        @click="seek"
                      >
                        <div
                          class="custom-player-progress-bar"
                          :style="{ width: player.progress + '%' }"
                        ></div>
                      </div>
                    </div>
                    <div class="custom-player-controls">
                      <div class="volume-control-wrapper">
                        <i
                          class="ph-fill"
                          :class="player.volume > 0.5 ? 'ph-speaker-high' : player.volume > 0 ? 'ph-speaker-low' : 'ph-speaker-slash'"
                        ></i
                        ><input
                          type="range"
                          class="volume-slider"
                          min="0"
                          max="1"
                          step="0.01"
                          v-model="player.volume"
                          @input="setVolume"
                          :style="{'--volume-percent': player.volume * 100 + '%'}"
                          aria-label="音量控制"
                        />
                      </div>
                      <button
                        @click="toggleShuffle"
                        :class="{ 'active': player.isShuffle }"
                        aria-label="随机播放"
                        title="随机播放"
                      >
                        <i class="ph-fill ph-shuffle"></i></button
                      ><button
                        @click="cyclePlaybackRate"
                        class="playback-rate-btn"
                        :aria-label="'播放速度: ' + player.playbackRate.toFixed(2) + 'x'"
                        :title="'播放速度: ' + player.playbackRate.toFixed(2) + 'x'"
                      >
                        {{ player.playbackRate.toFixed(1) }}x</button
                      ><button
                        @click="player.aplayer.skipBack()"
                        aria-label="上一首"
                      >
                        <i class="ph-fill ph-skip-back"></i></button
                      ><button
                        @click="player.aplayer.toggle()"
                        :aria-label="player.isPlaying ? '暂停' : '播放'"
                      >
                        <i
                          :class="player.isPlaying ? 'ph-fill ph-pause' : 'ph-fill ph-play'"
                        ></i></button
                      ><button
                        @click="player.aplayer.skipForward()"
                        aria-label="下一首"
                      >
                        <i class="ph-fill ph-skip-forward"></i></button
                      ><button @click="togglePlaylist" aria-label="播放列表">
                        <i class="ph-fill ph-list"></i></button
                      ><button
                        @click="toggleSonglistSwitcher"
                        aria-label="切换歌单"
                      >
                        <i class="ph-fill ph-stack"></i>
                      </button>
                    </div>
                  </div>
                  <div ref="lrcContainer" class="custom-lrc-container"></div>
                  <div
                    class="playlist-container"
                    :class="{ show: player.isPlaylistVisible }"
                  >
                    <div
                      v-for="(song, index) in player.playlist"
                      :key="song.url"
                      class="playlist-item"
                      :class="{ active: player.currentSong.url === song.url }"
                      @click="player.aplayer.list.switch(index)"
                    >
                      <span class="index">{{ index + 1 }}</span>
                      <div class="info">
                        <div class="title">{{ song.name }}</div>
                        <div class="artist">{{ song.artist }}</div>
                      </div>
                    </div>
                  </div>
                  <div
                    class="songlist-switcher"
                    :class="{ show: player.isSongSwitcherVisible }"
                  >
                    <h4>预设歌单</h4>
                    <ul class="songlist-presets">
                      <li
                        v-for="list in presetSonglists"
                        :key="list.id"
                        @click="switchSonglist(list.id)"
                        :class="{ active: list.id === currentSongId || (list.id === 'local_folder_picker' && currentSongId === 'local_folder') }"
                      >
                        <span>{{ list.name }}</span>
                      </li>
                    </ul>
                    <h5 v-if="customSonglists.length > 0">我的歌单</h5>
                    <ul
                      class="songlist-custom"
                      v-if="customSonglists.length > 0"
                    >
                      <li
                        v-for="list in customSonglists"
                        :key="list.id"
                        @click="switchSonglist(list.id)"
                        :class="{active: list.id === currentSongId}"
                      >
                        <span>{{ list.name }}</span
                        ><button
                          @click.stop="removeCustomSonglist(list.id)"
                          class="remove-btn"
                          title="删除这个歌单"
                        >
                          <i class="ph ph-x"></i>
                        </button>
                      </li>
                    </ul>
                    <div class="songlist-input-group">
                      <div class="songlist-input-row">
                        <input
                          type="text"
                          name="songlist-id"
                          v-model="newSongIdInput"
                          placeholder="歌单ID (纯数字)"
                          @keydown.enter.prevent="addAndSwitchSonglist"
                        /><input
                          type="text"
                          name="songlist-name"
                          v-model="newSongNameInput"
                          placeholder="歌单名称 (可选)"
                          @keydown.enter.prevent="addAndSwitchSonglist"
                        />
                      </div>
                      <button @click="addAndSwitchSonglist">添加并播放</button>
                    </div>
                  </div>
                </div></transition
              >
              <div id="player-hidden"></div>
            </div>
          </div>
        </section>
        <section id="about" class="content-section" data-section="about">
          <article
            class="about-us-card content-card glass-effect anim-fade-in-up"
          >
            <div class="about-sidebar">
              <div class="sidebar-text">MAY YOU ALWAYS SHINE</div>
              <div class="sidebar-line"></div>
            </div>
            <div class="about-main-content">
              <div v-html="aboutContent"></div>
            </div>
          </article>
        </section>
        <section id="interactive-journey" data-section="hub">
          <transition name="panel-fade" mode="out-in">
            <div
              class="journey-hub"
              v-if="!activeJourneyPanel"
              key="journey-hub"
            >
              <div class="hub-intro">
                <h2>关于我</h2>
                <blockquote>
                  「
                  <strong
                    >May you, the beauty of this world, always shine.</strong
                  >
                  」
                </blockquote>
              </div>
              <transition-group
                tag="div"
                class="hub-grid"
                appear
                @before-enter="onBeforeEnter"
                @enter="onEnter"
                ><article
                  class="hub-node"
                  v-for="(node, index) in hubNodes"
                  :key="node.id"
                  :data-index="index"
                  @click="openJourneyPanel(node.id)"
                  tabindex="0"
                  @keydown.enter="openJourneyPanel(node.id)"
                >
                  <i :class="node.icon"></i>
                  <h3>{{ node.title }}</h3>
                  <p>{{ node.text }}</p>
                </article></transition-group
              >
            </div>
            <div v-else key="journey-panels">
              <div
                id="resume-panel"
                class="journey-panel"
                v-if="activeJourneyPanel === 'resume'"
              >
                <article class="content-card glass-effect" ref="activePanelRef">
                  <button
                    @click="closeJourneyPanel"
                    class="close-panel-btn"
                    aria-label="关闭面板"
                    title="关闭"
                  >
                    <i class="ph ph-x"></i>
                  </button>

                  <div
                    class="creations-tabs"
                    style="justify-content: center; margin-bottom: 2rem"
                  >
                    <button
                      v-for="resume in resumesList"
                      :key="resume.id"
                      class="tab-button"
                      :class="{ active: resume.id === activeResumeId }"
                      @click="switchResume(resume)"
                    >
                      <span>{{ resume.label }}</span>
                    </button>
                  </div>

                  <transition name="content-fade" mode="out-in">
                    <div
                      v-if="!resumeData.name"
                      key="loading"
                      class="loading-placeholder"
                      aria-busy="true"
                      style="text-align: center; padding: 4rem 0"
                    >
                      正在加载简历...
                    </div>
                    <div v-else key="content">
                      <div class="resume-header">
                        <h1>{{ resumeData.name }}</h1>
                        <div class="resume-contact">
                          <span class="resume-contact-item"
                            ><i class="ph-fill ph-phone"></i> {{
                            resumeData.phone }}</span
                          ><span class="resume-contact-item"
                            ><i class="ph-fill ph-envelope-simple"></i> {{
                            resumeData.email }}</span
                          ><span class="resume-contact-item"
                            ><i class="ph-fill ph-map-pin"></i> {{
                            resumeData.location }}</span
                          ><span class="resume-contact-item"
                            ><i class="ph-fill ph-flag"></i> {{
                            resumeData.politicalStatus }}</span
                          >
                        </div>
                      </div>
                      <div class="resume-section">
                        <h3>
                          <i class="ph-fill ph-graduation-cap"></i> 教育背景
                        </h3>
                        <div class="education-grid">
                          <div
                            class="education-item"
                            v-for="edu in resumeData.education"
                          >
                            <div class="item-header">
                              <h4>{{ edu.institution }}</h4>
                              <span class="date">{{ edu.duration }}</span>
                            </div>
                            <p class="item-subheader">
                              {{ edu.major }} | 辅修: {{ edu.minor }}
                            </p>
                            <div class="item-details">
                              <ul>
                                <li>
                                  GPA: {{ edu.gpa }} | 专业成绩: {{
                                  edu.majorScore }} (排名 {{ edu.ranking }})
                                </li>
                                <li>
                                  主修课程: {{ edu.courses.major.join('、') }}
                                </li>
                                <li>
                                  辅修课程: {{ edu.courses.minor.join('、') }}
                                </li>
                              </ul>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="resume-section">
                        <h3><i class="ph-fill ph-kanban"></i> 项目经历</h3>
                        <div class="experience-grid">
                          <div
                            class="project-item"
                            v-for="proj in resumeData.projects"
                          >
                            <div class="item-header">
                              <h4>{{ proj.name }}</h4>
                              <span class="date">{{ proj.duration }}</span>
                            </div>
                            <p class="item-subheader">角色: {{ proj.role }}</p>
                            <div class="item-details">
                              <p><strong>任务:</strong> {{ proj.task }}</p>
                              <p><strong>行动:</strong> {{ proj.action }}</p>
                              <p><strong>结果:</strong> {{ proj.result }}</p>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="resume-section">
                        <h3><i class="ph-fill ph-users"></i> 在校经历</h3>
                        <div class="experience-grid">
                          <div
                            class="experience-item"
                            v-for="exp in resumeData.campusExperience"
                          >
                            <div class="item-header">
                              <h4>{{ exp.role }}</h4>
                              <span class="date">{{ exp.duration }}</span>
                            </div>
                            <div class="item-details">
                              <p>{{ exp.description }}</p>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="resume-section">
                        <h3><i class="ph-fill ph-brain"></i> 相关技能</h3>
                        <div class="skills-container">
                          <div
                            class="skill-category"
                            v-for="cat in resumeData.skills"
                          >
                            <h4>{{ cat.category }}</h4>
                            <div class="skill-list">
                              <span class="skill-tag" v-for="skill in cat.items"
                                >{{ skill }}</span
                              >
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="resume-section">
                        <h3><i class="ph-fill ph-trophy"></i> 荣誉证书</h3>
                        <div class="honors-list">
                          <div
                            class="honor-item"
                            v-for="honor in resumeData.honors"
                          >
                            <i class="ph-fill ph-seal-check"></i
                            ><span>{{ honor }}</span>
                          </div>
                        </div>
                      </div>
                    </div>
                  </transition>
                </article>
              </div>
              <div
                id="creations-panel"
                class="journey-panel"
                v-if="activeJourneyPanel === 'creations'"
              >
                <article class="content-card glass-effect" ref="activePanelRef">
                  <button
                    @click="closeJourneyPanel"
                    class="close-panel-btn"
                    aria-label="关闭面板"
                    title="关闭"
                  >
                    <i class="ph ph-x"></i>
                  </button>
                  <h2>创造与知识</h2>
                  <div class="creations-tabs">
                    <button
                      class="tab-button"
                      :class="{ active: creationsTabActive === 'github' }"
                      @click="creationsTabActive = 'github'"
                    >
                      <i class="ph-fill ph-github-logo"></i><span>GitHub</span>
                    </button>
                    <button
                      class="tab-button"
                      :class="{ active: creationsTabActive === 'bookshelf' }"
                      @click="creationsTabActive = 'bookshelf'"
                    >
                      <i class="ph-fill ph-books"></i><span>我的书架</span>
                    </button>
                    <button
                      class="tab-button"
                      :class="{ active: creationsTabActive === 'growth' }"
                      @click="creationsTabActive = 'growth'"
                    >
                      <i class="ph-fill ph-trend-up"></i><span>成长与动态</span>
                    </button>
                  </div>
                  <div class="tab-content">
                    <transition
                      name="content-fade"
                      mode="out-in"
                      @after-enter="onTabTransitionEnd"
                      @before-leave="onTabTransitionStart"
                    >
                      <div v-if="creationsTabActive === 'github'" key="github">
                        <div class="github-overview">
                          <div class="stat-card">
                            <div class="stat-value">
                              {{ github.stats.contributions }}
                            </div>
                            <div class="stat-label">年度贡献数</div>
                          </div>
                          <div class="stat-card">
                            <div class="stat-value">
                              {{ github.stats.repos }}
                            </div>
                            <div class="stat-label">公开仓库数</div>
                          </div>
                          <div class="stat-card">
                            <div class="stat-value">
                              {{ github.stats.stars }}
                            </div>
                            <div class="stat-label">总 Star 数</div>
                          </div>
                          <div class="stat-card">
                            <div class="stat-value">
                              {{ github.stats.forks }}
                            </div>
                            <div class="stat-label">总 Fork 数</div>
                          </div>
                        </div>
                        <div class="filters-container">
                          <div class="filter-group">
                            <label for="sort-repos">排序:</label
                            ><select id="sort-repos" v-model="github.sortKey">
                              <option value="pushed_at">最近更新</option>
                              <option value="stargazers_count">
                                最多 Star
                              </option>
                              <option value="forks_count">最多 Fork</option>
                            </select>
                          </div>
                          <div class="filter-group">
                            <label for="filter-lang">语言:</label
                            ><input
                              id="filter-lang"
                              type="text"
                              v-model="github.filterLanguage"
                              placeholder="e.g., JavaScript"
                            />
                          </div>
                        </div>
                        <div v-if="github.error" class="error-message">
                          {{ github.error }}
                        </div>
                        <div class="repo-grid" v-if="!github.isLoading">
                          <a
                            v-for="repo in github.pinnedRepos"
                            :key="repo.name"
                            :href="repo.link"
                            target="_blank"
                            class="repo-card pinned-repo-card"
                            ><h3>{{ repo.repo }}</h3>
                            <p>{{ repo.description || '暂无描述' }}</p>
                            <div class="repo-stats">
                              <span
                                ><svg
                                  xmlns="http://www.w3.org/2000/svg"
                                  viewBox="0 0 20 20"
                                  fill="currentColor"
                                >
                                  <path
                                    fill-rule="evenodd"
                                    d="M10.868 2.884c.321.64.321 1.393 0 2.034a.985.985 0 01-1.737 0c.321-.64.321-1.393 0-2.034a.985.985 0 011.737 0zM12 12.5a.5.5 0 01.5.5v1a.5.5 0 01-1 0v-1a.5.5 0 01.5-.5zM10.5 6a.5.5 0 00-1 0v6a.5.5 0 001 0V6z"
                                    clip-rule="evenodd"
                                  />
                                  <path
                                    d="M10 18a8 8 0 100-16 8 8 0 000 16zm0-1.5a6.5 6.5 0 110-13 6.5 6.5 0 010 13z"
                                  />
                                </svg>
                                {{ repo.language || 'Text' }}</span
                              ><span
                                ><svg
                                  xmlns="http://www.w3.org/2000/svg"
                                  viewBox="0 0 20 20"
                                  fill="currentColor"
                                >
                                  <path
                                    d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"
                                  />
                                </svg>
                                {{ repo.stars }}</span
                              ><span
                                ><svg
                                  xmlns="http://www.w3.org/2000/svg"
                                  viewBox="0 0 20 20"
                                  fill="currentColor"
                                >
                                  <path
                                    fill-rule="evenodd"
                                    d="M15.312 5.312l-1.422 1.422L12 8.156l-1.89-1.89a.75.75 0 00-1.06 1.061l1.89 1.89-1.422 1.422-1.89-1.89a.75.75 0 10-1.06 1.06l1.89 1.89-1.422 1.422-1.89-1.89a.75.75 0 10-1.06 1.06l1.89 1.89-1.422 1.422a.75.75 0 101.06 1.06L9.89 13.94l1.422-1.422 1.89 1.89a.75.75 0 101.06-1.06l-1.89-1.89 1.422-1.422 1.89 1.89a.75.75 0 101.06-1.06l-1.89-1.89 1.422-1.422a.75.75 0 10-1.06-1.06z"
                                    clip-rule="evenodd"
                                  />
                                </svg>
                                {{ repo.forks }}</span
                              >
                            </div></a
                          >
                          <a
                            v-for="repo in filteredAndSortedRepos"
                            :key="repo.id"
                            :href="repo.html_url"
                            target="_blank"
                            class="repo-card"
                            ><h3>{{ repo.name }}</h3>
                            <p>{{ repo.description || '暂无描述' }}</p>
                            <div class="repo-stats">
                              <span
                                ><svg
                                  xmlns="http://www.w3.org/2000/svg"
                                  viewBox="0 0 20 20"
                                  fill="currentColor"
                                >
                                  <path
                                    fill-rule="evenodd"
                                    d="M10.868 2.884c.321.64.321 1.393 0 2.034a.985.985 0 01-1.737 0c.321-.64.321-1.393 0-2.034a.985.985 0 011.737 0zM12 12.5a.5.5 0 01.5.5v1a.5.5 0 01-1 0v-1a.5.5 0 01.5-.5zM10.5 6a.5.5 0 00-1 0v6a.5.5 0 001 0V6z"
                                    clip-rule="evenodd"
                                  />
                                  <path
                                    d="M10 18a8 8 0 100-16 8 8 0 000 16zm0-1.5a6.5 6.5 0 110-13 6.5 6.5 0 010 13z"
                                  />
                                </svg>
                                {{ repo.language || 'Text' }}</span
                              ><span
                                ><svg
                                  xmlns="http://www.w3.org/2000/svg"
                                  viewBox="0 0 20 20"
                                  fill="currentColor"
                                >
                                  <path
                                    d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"
                                  />
                                </svg>
                                {{ repo.stargazers_count }}</span
                              ><span
                                ><svg
                                  xmlns="http://www.w3.org/2000/svg"
                                  viewBox="0 0 20 20"
                                  fill="currentColor"
                                >
                                  <path
                                    fill-rule="evenodd"
                                    d="M15.312 5.312l-1.422 1.422L12 8.156l-1.89-1.89a.75.75 0 00-1.06 1.061l1.89 1.89-1.422 1.422-1.89-1.89a.75.75 0 10-1.06 1.06l1.89 1.89-1.422 1.422-1.89-1.89a.75.75 0 10-1.06 1.06l1.89 1.89-1.422 1.422a.75.75 0 101.06 1.06L9.89 13.94l1.422-1.422 1.89 1.89a.75.75 0 101.06-1.06l-1.89-1.89 1.422-1.422 1.89 1.89a.75.75 0 101.06-1.06l-1.89-1.89 1.422-1.422a.75.75 0 10-1.06-1.06z"
                                    clip-rule="evenodd"
                                  />
                                </svg>
                                {{ repo.forks_count }}</span
                              >
                            </div></a
                          >
                        </div>
                        <div class="repo-grid" v-else>
                          <div v-for="n in 6" class="skeleton-card">
                            <div class="skeleton-line h-6"></div>
                            <div class="skeleton-line h-4 w-full"></div>
                            <div class="skeleton-line h-4 w-80"></div>
                            <div class="skeleton-footer">
                              <div class="skeleton-line h-4 w-40"></div>
                              <div class="skeleton-line h-4 w-40"></div>
                            </div>
                          </div>
                        </div>
                        <button
                          v-if="github.canLoadMore"
                          @click="loadMoreRepos"
                          class="load-more-btn"
                          :disabled="github.isLoadingMore"
                        >
                          <i
                            v-if="github.isLoadingMore"
                            class="ph ph-spinner-gap animate-spin"
                          ></i
                          ><span
                            >{{ github.isLoadingMore ? '加载中...' : '加载更多'
                            }}</span
                          >
                        </button>
                      </div>
                      <div
                        v-else-if="creationsTabActive === 'bookshelf'"
                        key="bookshelf"
                      >
                        <div class="filters-container book-category-pills">
                          <button
                            v-for="category in bookCategories"
                            :key="category"
                            @click="bookshelf.activeCategory = category"
                            :class="{ active: bookshelf.activeCategory === category }"
                          >
                            {{ category }}
                          </button>
                        </div>
                        <div class="book-grid">
                          <div
                            v-for="book in filteredBooks"
                            :key="book.title"
                            @click="openBookModal(book)"
                            class="book-card"
                          >
                            <span
                              v-if="book.status"
                              class="book-status-tag"
                              :class="book.status"
                              >{{ book.status === 'reading' ? '在读' : '已读'
                              }}</span
                            ><img
                              :src="book.coverUrl"
                              :alt="book.title"
                              class="book-cover"
                              @error="handleImgError"
                              loading="lazy"
                            />
                            <h3>{{ book.title }}</h3>
                            <p>{{ book.author }}</p>
                          </div>
                        </div>
                      </div>
                      <div
                        v-else-if="creationsTabActive === 'growth'"
                        key="growth"
                      >
                        <div class="growth-grid">
                          <div class="growth-card">
                            <h3>
                              <i class="ph-fill ph-calendar-blank"></i> 时光
                            </h3>
                            <div class="timeline">
                              <div
                                class="timeline-item"
                                v-for="item in timeline"
                                :key="item.date"
                              >
                                <div class="timeline-date">{{ item.date }}</div>
                                <p class="timeline-desc">{{ item.event }}</p>
                              </div>
                            </div>
                          </div>
                          <div class="growth-right-column">
                            <div class="growth-card">
                              <h3>
                                <i class="ph-fill ph-flag-checkered"></i>
                                目标进度
                              </h3>
                              <div class="target-list">
                                <div
                                  v-for="(target, index) in targets"
                                  :key="target.name"
                                  class="target-item"
                                >
                                  <div class="target-info">
                                    <span class="target-name"
                                      >{{ target.name }}</span
                                    ><span class="target-progress-text"
                                      >{{ animatedTargetValues[index] || 0 }} /
                                      {{ target.total }}</span
                                    >
                                  </div>
                                  <div class="progress-bar-container">
                                    <div class="progress-bar"></div>
                                  </div>
                                </div>
                              </div>
                            </div>
                            <div class="growth-card">
                              <h3>
                                <i class="ph-fill ph-chart-line"></i> 知识动态
                              </h3>
                              <div class="activity-feed">
                                <div
                                  v-if="activityStream.length === 0 && !github.isLoading"
                                >
                                  暂无动态
                                </div>
                                <div
                                  v-for="(item, index) in activityStream"
                                  :key="index"
                                  class="activity-item"
                                >
                                  <div class="activity-icon">
                                    <i
                                      class="ph-fill"
                                      :class="item.type === 'github' ? 'ph-git-commit' : 'ph-book-open'"
                                    ></i>
                                  </div>
                                  <div class="activity-content">
                                    <p
                                      class="activity-text"
                                      v-html="item.content"
                                    ></p>
                                    <p class="activity-date">{{ item.date }}</p>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </transition>
                  </div>
                </article>
              </div>
              <div
                id="blog-panel"
                class="journey-panel"
                v-if="activeJourneyPanel === 'blog'"
              >
                <article class="content-card glass-effect" ref="activePanelRef">
                  <button
                    @click="closeJourneyPanel"
                    class="close-panel-btn"
                    aria-label="关闭面板"
                    title="关闭"
                  >
                    <i class="ph ph-x"></i>
                  </button>
                  <h2>我的文章</h2>
                  <div class="blog-panel-content">
                    <div class="blog-sidebar">
                      <div class="blog-category-filter">
                        <button
                          v-for="category in blogCategories"
                          :key="category"
                          @click="activeCategory = category"
                          :class="{ active: activeCategory === category }"
                        >
                          {{ category }}
                        </button>
                      </div>
                      <div class="blog-post-list-container">
                        <transition-group name="list-fade" tag="div"
                          ><div
                            v-for="post in filteredBlogPosts"
                            :key="post.id"
                            @click="activePostId = post.id"
                            class="blog-post-item"
                            :class="{ active: post.id === activePostId }"
                            tabindex="0"
                            @keydown.enter="activePostId = post.id"
                          >
                            <h4>{{ post.title }}</h4>
                            <p>{{ post.date }}</p>
                          </div></transition-group
                        >
                      </div>
                    </div>
                    <div class="blog-main">
                      <transition name="post-fade" mode="out-in"
                        ><div
                          v-if="activePost"
                          class="blog-post-content"
                          :key="activePost.id"
                        >
                          <h2>{{ activePost.title }}</h2>
                          <p class="blog-post-meta">
                            发布于 {{ activePost.date }} | 分类: {{
                            activePost.category }}
                          </p>
                          <div
                            class="blog-post-body"
                            v-html="renderMarkdown(activePost.content)"
                          ></div></div
                      ></transition>
                    </div>
                  </div>
                </article>
              </div>
              <div
                id="interests-panel"
                class="journey-panel"
                v-if="activeJourneyPanel === 'interests'"
              >
                <article class="content-card glass-effect" ref="activePanelRef">
                  <button
                    @click="closeJourneyPanel"
                    class="close-panel-btn"
                    aria-label="关闭面板"
                    title="关闭"
                  >
                    <i class="ph ph-x"></i>
                  </button>
                  <h2>兴趣星系</h2>
                  <div class="interest-pills-container">
                    <button
                      v-for="interest in interests"
                      :key="interest.id"
                      class="interest-pill"
                      :class="{ 'is-active': openInterestId === interest.id }"
                      @click="openInterestId = interest.id"
                    >
                      <i :class="interest.icon"></i
                      ><span>{{ interest.title }}</span>
                    </button>
                  </div>
                  <transition name="content-fade" mode="out-in"
                    ><div
                      v-if="activeInterest"
                      :key="activeInterest.id"
                      class="interest-details-container"
                    >
                      <div class="interest-details-content">
                        <div
                          v-if="activeInterest.hasVideo && activeInterest.videoUrl"
                          class="video-container"
                        >
                          <iframe
                            :src="activeInterest.videoUrl"
                            scrolling="no"
                            border="0"
                            frameborder="no"
                            framespacing="0"
                            allowfullscreen="true"
                          ></iframe>
                        </div>
                        <div
                          class="interest-markdown-content"
                          v-html="interestMarkdownContent"
                        ></div>
                      </div></div
                  ></transition>
                </article>
              </div>
              <div
                id="chatbot-panel"
                class="journey-panel"
                v-if="activeJourneyPanel === 'chatbot'"
              >
                <article
                  class="content-card glass-effect chatbot-card"
                  ref="activePanelRef"
                >
                  <button
                    @click="closeJourneyPanel"
                    class="close-panel-btn"
                    aria-label="关闭面板"
                    title="关闭"
                  >
                    <i class="ph ph-x"></i>
                  </button>
                  <h2>AI 对话</h2>
                  <div class="chatbot-settings">
                    <div class="setting-item api-key-group">
                      <label for="apiKey"
                        ><span>API Key</span
                        ><a
                          href="https://platform.deepseek.com/api_keys"
                          target="_blank"
                          class="get-api-key-link"
                          >获取API Key</a
                        ></label
                      ><input
                        id="apiKey"
                        type="password"
                        v-model="chatbot.apiKey"
                        placeholder="输入你的 DeepSeek API Key"
                      />
                    </div>
                    <div class="setting-item">
                      <label for="temperature"
                        ><span>温度: {{ chatbot.temperature }}</span
                        ><i
                          class="ph ph-info tooltip-icon"
                          title="仅在关闭深度思考时有效。&#10;代码生成/数学解题: 0.0&#10;数据抽取/分析: 1.0&#10;通用对话/翻译: 1.3&#10;创意类写作: 1.5"
                        ></i></label
                      ><input
                        id="temperature"
                        type="range"
                        v-model="chatbot.temperature"
                        min="0"
                        max="2"
                        step="0.1"
                        :disabled="chatbot.use_deep_thinking"
                      />
                    </div>
                    <div class="setting-item custom-toggle">
                      <label for="deepThinking">深度思考</label>
                      <div
                        class="toggle-switch"
                        :class="{ active: chatbot.use_deep_thinking }"
                        @click="chatbot.use_deep_thinking = !chatbot.use_deep_thinking"
                        role="switch"
                        :aria-checked="chatbot.use_deep_thinking"
                        id="deepThinking"
                        tabindex="0"
                      >
                        <div class="toggle-knob"></div>
                      </div>
                    </div>
                    <div class="setting-item chat-history-group">
                      <label>对话历史</label>
                      <div class="history-controls">
                        <div class="chat-history-dropdown" ref="dropdownRef">
                          <button
                            @click="isHistoryDropdownOpen = !isHistoryDropdownOpen"
                            class="dropdown-trigger"
                            aria-haspopup="true"
                            :aria-expanded="isHistoryDropdownOpen"
                          >
                            <span
                              >{{ activeChat ? activeChat.title : '选择对话'
                              }}</span
                            ><i class="ph-fill ph-caret-down"></i></button
                          ><transition name="dropdown-fade"
                            ><ul
                              v-if="isHistoryDropdownOpen"
                              class="dropdown-menu glass-effect"
                              role="menu"
                            >
                              <li
                                v-for="chat in chatHistories"
                                :key="chat.id"
                                @click="selectChat(chat.id)"
                                class="dropdown-item"
                                role="menuitem"
                                :class="{ active: chat.id === activeChatId }"
                              >
                                {{ chat.title }}
                              </li>
                            </ul></transition
                          >
                        </div>
                        <button
                          @click="createNewChat"
                          class="history-btn"
                          aria-label="新建对话"
                          title="新建对话"
                        >
                          <i class="ph ph-plus"></i></button
                        ><button
                          @click="deleteActiveChat"
                          class="history-btn"
                          aria-label="删除当前对话"
                          title="删除当前对话"
                        >
                          <i class="ph ph-trash"></i>
                        </button>
                      </div>
                    </div>
                  </div>
                  <div class="chat-window" ref="chatWindow">
                    <div v-if="activeChat">
                      <div
                        v-for="message in activeChat.messages"
                        :key="message.id"
                        class="message"
                        :class="message.role"
                      >
                        <div
                          v-if="message.role !== 'system'"
                          class="message-content"
                        >
                          <div
                            v-if="message.thinking"
                            class="thinking-process-container"
                          >
                            <button
                              class="toggle-thinking-btn"
                              @click="message.isThinkingVisible = !message.isThinkingVisible"
                            >
                              <i
                                class="ph-fill"
                                :class="message.isThinkingVisible ? 'ph-caret-down' : 'ph-caret-right'"
                              ></i
                              ><span>思考过程</span>
                            </button>
                            <div
                              v-show="message.isThinkingVisible"
                              class="thinking-process-content"
                              v-html="renderMarkdown(message.thinking)"
                            ></div>
                          </div>
                          <div
                            v-if="chatbot.isLoading && activeChat.messages[activeChat.messages.length - 1].id === message.id && !message.content && !message.thinking"
                            style="
                              display: flex;
                              align-items: center;
                              justify-content: center;
                              height: 1.6em;
                            "
                          >
                            <span
                              class="typing-cursor-hero"
                              style="
                                height: 1.2em;
                                background-color: var(--text-color);
                              "
                            ></span>
                          </div>
                          <div
                            v-else
                            v-html="renderMarkdown(message.content)"
                          ></div>
                          <button
                            v-if="message.content"
                            @click="copyToClipboard(message.content, $event)"
                            class="copy-button"
                            aria-label="复制消息"
                            title="复制"
                          >
                            <i class="ph ph-copy"></i>
                          </button>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div
                    v-if="chatbot.status"
                    class="chat-status"
                    aria-live="polite"
                  >
                    <i class="ph ph-spinner-gap animate-spin"></i
                    ><span>{{ chatbot.status }}</span>
                  </div>
                  <form @submit.prevent="sendMessage" class="chat-input-area">
                    <textarea
                      v-model="chatbot.currentMessage"
                      @keydown.enter.exact.prevent="sendMessage"
                      placeholder="输入消息..."
                      aria-label="聊天输入框"
                    ></textarea
                    ><button
                      type="submit"
                      class="send-button"
                      :disabled="chatbot.isLoading || !chatbot.apiKey"
                    >
                      发送
                    </button>
                  </form>
                </article>
              </div>
            </div>
          </transition>
        </section>
      </main>
      <div
        class="fab-container glass-effect"
        :class="{ 'expanded': guestbook.isExpanded }"
      >
        <form @submit.prevent="submitGuestbookMessage" class="fab-form">
          <h3 class="fab-form-title">发弹幕</h3>
          <p
            class="modal-status-message"
            style="
              text-align: center;
              min-height: 1.2em;
              font-size: 0.9em;
              margin-bottom: 1rem;
              font-weight: 500;
            "
            :class="guestbook.status.type"
            aria-live="polite"
          >
            {{ guestbook.status.message }}
          </p>
          <div class="form-group">
            <input
              type="text"
              id="guestName"
              v-model="guestbook.newName"
              required
              maxlength="20"
              placeholder="怎么称呼？"
            />
          </div>
          <div class="form-group">
            <textarea
              id="guestMessage"
              v-model="guestbook.newMessage"
              required
              maxlength="100"
              placeholder="说点什么吧..."
            ></textarea>
          </div>
          <button
            type="submit"
            class="form-submit-button"
            :disabled="guestbook.isSubmitting"
          >
            <i v-if="guestbook.isSubmitting" class="ph ph-spinner-gap"></i
            ><span
              >{{ guestbook.isSubmitting ? '发射中...' : '发射弹幕' }}</span
            >
          </button>
        </form>
        <button
          @click="toggleGuestbookExpanded"
          class="fab-toggle"
          aria-label="留言"
        >
          <i
            class="ph-fill"
            :class="guestbook.isExpanded ? 'ph-x' : 'ph-chat-centered-dots'"
          ></i>
        </button>
      </div>
      <footer
        class="footer-section glass-effect anim-fade-in-up"
        id="footer"
        data-section="footer"
      >
        <h4 class="footer-title">风向标</h4>
        <p class="footer-subtitle">去到别处看看？</p>
        <div class="icon-links-bar">
          <a
            v-for="link in footerIconLinks"
            :key="link.text"
            :href="link.url"
            class="icon-link"
            ><span v-html="link.icon"></span><span>{{ link.text }}</span></a
          >
        </div>
        <div class="info-links">
          <a href="https://www.bilibili.com/video/BV1Kj411g7Lu"
            >May you,the beauty of this world,always shine.</a
          >
        </div>
        <div class="copyright-info">
          <p>
            Copyright&copy;{{ copyrightYear }} 虚宁<span
              class="site-info-item"
              v-if="siteUptime"
              >| 站点已运行 {{ siteUptime }}</span
            ><span class="site-info-item" v-if="icp"
              >|
              <a href="https://beian.miit.gov.cn/" target="_blank"
                >{{ icp }}</a
              ></span
            >
          </p>
          <div class="theme-switcher">
            <button
              @click="setTheme('dark')"
              :class="{ active: currentTheme === 'dark' }"
              aria-label="切换到深色模式"
              title="深色模式"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 20 20"
                fill="currentColor"
              >
                <path
                  d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"
                ></path>
              </svg></button
            ><button
              @click="setTheme('light')"
              :class="{ active: currentTheme === 'light' }"
              aria-label="切换到浅色模式"
              title="浅色模式"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 20 20"
                fill="currentColor"
              >
                <path
                  fill-rule="evenodd"
                  d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zM3 11a1 1 0 100-2H2a1 1 0 100 2h1z"
                  clip-rule="evenodd"
                ></path>
              </svg>
            </button>
          </div>
        </div>
      </footer>
    </div>

    <script
      src="https://source.xvyin.com/?target=https%3A%2F%2Fcdn.bootcdn.net%2Fajax%2Flibs%2Fvue%2F3.2.47%2Fvue.global.prod.js"
      defer
    ></script>
    <script
      src="https://source.xvyin.com/?target=https%3A%2F%2Fcdn.bootcdn.net%2Fajax%2Flibs%2Fmarked%2F4.3.0%2Fmarked.min.js"
      defer
    ></script>
    <script
      src="https://source.xvyin.com/?target=https%3A%2F%2Fcdn.jsdelivr.net%2Fnpm%2F%40phosphor-icons%2Fweb"
      defer
    ></script>
    <script
      src="https://source.xvyin.com/?target=https%3A%2F%2Fcdn.bootcdn.net%2Fajax%2Flibs%2Faplayer%2F1.10.1%2FAPlayer.min.js"
      defer
    ></script>
    <script
      src="https://source.xvyin.com/?target=https%3A%2F%2Fcdn.bootcdn.net%2Fajax%2Flibs%2Ffetch-jsonp%2F1.3.0%2Ffetch-jsonp.min.js"
      defer
    ></script>
    <script
      src="https://source.xvyin.com/?target=https%3A%2F%2Fcdn.bootcdn.net%2Fajax%2Flibs%2FKaTeX%2F0.16.9%2Fkatex.min.js"
      defer
    ></script>
    <script
      src="https://source.xvyin.com/?target=https%3A%2F%2Fcdn.bootcdn.net%2Fajax%2Flibs%2FKaTeX%2F0.16.9%2Fcontrib%2Fauto-render.min.js"
      defer
    ></script>

    <script>
      (function () {
        const isLightTheme =
          new Date().getHours() >= 6 && new Date().getHours() < 18;
        if (isLightTheme) {
          document.documentElement.classList.add("light-theme");
        }
      })();

      document.addEventListener("DOMContentLoaded", () => {
        (function () {
          const canvas = document.getElementById("particle-canvas");
          if (!canvas) return;
          const ctx = canvas.getContext("2d");
          let particles = [];
          let animationFrameId;
          let isTabVisible = true;
          document.addEventListener("visibilitychange", () => {
            isTabVisible = !document.hidden;
            if (isTabVisible && !animationFrameId) animate();
          });
          function resizeCanvas() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
          }
          class Particle {
            constructor() {
              this.x = Math.random() * canvas.width;
              this.y = Math.random() * canvas.height;
              this.size = Math.random() * 2 + 1;
              this.speedX = Math.random() * 1 - 0.5;
              this.speedY = Math.random() * 1 - 0.5;
            }
            update() {
              const isLightTheme =
                document.documentElement.classList.contains("light-theme");
              if (!isLightTheme) {
                const centerX = canvas.width / 2;
                const centerY = canvas.height / 2;
                const dx = this.x - centerX;
                const dy = this.y - centerY;
                const distance = Math.sqrt(dx * dx + dy * dy);
                if (distance > 1) {
                  const swirlStrength = 0.01;
                  this.speedX += (-dy / distance) * swirlStrength;
                  this.speedY += (dx / distance) * swirlStrength;
                }
                this.speedX *= 0.99;
                this.speedY *= 0.99;
              }
              this.x += this.speedX;
              this.y += this.speedY;
              if (
                this.x < 0 ||
                this.x > canvas.width ||
                this.y < 0 ||
                this.y > canvas.height
              ) {
                Object.assign(this, new Particle());
              }
            }
            draw() {
              ctx.fillStyle = document.documentElement.classList.contains(
                "light-theme"
              )
                ? "rgba(0, 0, 0, 0.4)"
                : "rgba(255, 255, 255, 0.4)";
              ctx.beginPath();
              ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
              ctx.fill();
            }
          }
          function initParticles() {
            const particleCount = Math.floor(
              (canvas.width * canvas.height) / 15000
            );
            particles = Array.from(
              { length: particleCount },
              () => new Particle()
            );
          }
          function handleParticles() {
            const isLightTheme =
              document.documentElement.classList.contains("light-theme");
            const lineBaseColor = isLightTheme ? "0, 0, 0" : "255, 255, 255";
            for (let i = 0; i < particles.length; i++) {
              particles[i].update();
              particles[i].draw();
              if (isLightTheme) {
                for (let j = i + 1; j < particles.length; j++) {
                  const dx = particles[i].x - particles[j].x;
                  const dy = particles[i].y - particles[j].y;
                  const distance = Math.sqrt(dx * dx + dy * dy);
                  if (distance < 100) {
                    ctx.beginPath();
                    ctx.strokeStyle = `rgba(${lineBaseColor}, ${
                      1 - distance / 100
                    })`;
                    ctx.lineWidth = 0.5;
                    ctx.moveTo(particles[i].x, particles[i].y);
                    ctx.lineTo(particles[j].x, particles[j].y);
                    ctx.stroke();
                  }
                }
              }
            }
          }
          function animate() {
            if (!isTabVisible) {
              animationFrameId = null;
              return;
            }
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            handleParticles();
            animationFrameId = requestAnimationFrame(animate);
          }
          function startAnimation() {
            resizeCanvas();
            initParticles();
            if (animationFrameId) cancelAnimationFrame(animationFrameId);
            animate();
          }
          window.addEventListener("resize", startAnimation);
          startAnimation();
        })();

        const loader = document.getElementById("loader-wrapper");
        const appElement = document.getElementById("app");
        if (appElement) appElement.style.visibility = "hidden";

        if (!window.Vue) {
          console.error("Vue.js未能加载。应用无法启动。");
          return;
        }
        const {
          createApp,
          ref,
          onMounted,
          onUnmounted,
          nextTick,
          watch,
          computed,
        } = Vue;

        const config = {
          guestbookApiUrl: "https://firebase.xvyin.com/messages",
          siteStartDate: "2024-03-02",
          icpNumber: "渝ICP备2025053763号-1",
          github: {
            username: "jimmyshuixin",
            spaceUrl: "https://github.com/jimmyshuixin",
          },
          music: {
            api: "https://music.xvyin.com/",
            server: "tencent",
            type: "playlist",
          },
          contentPaths: {
            about: "./content/about.md",
            blogManifest: "./content/blog/manifest.json",
            resumeManifest: "./content/resume/resumes.json",
            interests: "./content/interests/interests.json",
            growth: "./content/growth.json",
            bookshelf: "./content/bookshelf/bookshelf.json",
            footerLinks: "./content/footer-links.json",
            localPlaylistsManifest: "./content/music/local_playlists.json",
          },
        };

        const apiService = {
          cache: {
            get(key) {
              const itemStr = sessionStorage.getItem(key);
              if (!itemStr) return null;
              try {
                const item = JSON.parse(itemStr);
                const isExpired = new Date().getTime() > item.expiry;
                if (isExpired) {
                  sessionStorage.removeItem(key);
                  return null;
                }
                return item.value;
              } catch (e) {
                sessionStorage.removeItem(key);
                return null;
              }
            },
            set(key, value, ttlMinutes = 15) {
              const now = new Date();
              const item = {
                value: value,
                expiry: now.getTime() + ttlMinutes * 60 * 1000,
              };
              try {
                sessionStorage.setItem(key, JSON.stringify(item));
              } catch (e) {
                console.error("设置缓存失败:", e);
              }
            },
          },

          async getGithubData(endpoint, params = {}) {
            const workerUrl = "https://github.xvyin.com/";
            const url = new URL(workerUrl);
            url.searchParams.append("endpoint", endpoint);
            url.searchParams.append("username", config.github.username);
            for (const key in params) {
              if (params.hasOwnProperty(key)) {
                url.searchParams.append(key, params[key]);
              }
            }

            const cacheKey = `github_${endpoint}_${JSON.stringify(params)}`;
            const cachedData = this.cache.get(cacheKey);

            if (cachedData) {
              return cachedData;
            }

            const response = await fetch(url.toString());

            if (!response.ok) {
              const errorText = await response.text();
              throw new Error(
                `获取 GitHub 数据失败 (${endpoint}): ${response.status} - ${errorText}`
              );
            }

            const data = await response.json();
            this.cache.set(cacheKey, data);
            return data;
          },
          async getMusicPlaylist(songId) {
            if (!songId) throw new Error("必须提供歌单ID。");
            const apiUrl = `${config.music.api}?server=${config.music.server}&type=${config.music.type}&id=${songId}`;
            const response = await fetch(apiUrl);
            if (!response.ok)
              throw new Error(`音乐API请求失败: ${response.status}`);
            const data = await response.json();
            if (data.error) throw new Error(data.error);
            if (!Array.isArray(data) || data.length === 0) {
              console.error("API响应无效或播放列表为空:", data);
              throw new Error("播放列表为空或加载失败。");
            }
            return data;
          },
        };

        const dataLoaderService = {
          async fetchJSON(path) {
            try {
              const response = await fetch(path);
              if (!response.ok) throw new Error(`无法加载 ${path}`);
              return await response.json();
            } catch (error) {
              console.error(`加载JSON文件失败: ${path}`, error);
              return null;
            }
          },
          async fetchMarkdown(path) {
            try {
              const response = await fetch(path);
              if (!response.ok) throw new Error(`无法加载 ${path}`);
              return await response.text();
            } catch (error) {
              console.error(`加载Markdown文件失败: ${path}`, error);
              return `### 内容加载失败\n抱歉，无法加载此部分的内容: ${path}`;
            }
          },
        };

        const useTheme = () => {
          const currentTheme = ref("dark");
          let themeCheckInterval = null;
          const autoSetThemeByTime = () => {
            const newTheme =
              new Date().getHours() >= 6 && new Date().getHours() < 18
                ? "light"
                : "dark";
            if (newTheme !== currentTheme.value) {
              currentTheme.value = newTheme;
              document.documentElement.classList.toggle(
                "light-theme",
                newTheme === "light"
              );
            }
          };
          const setTheme = (theme) => {
            currentTheme.value = theme;
            document.documentElement.classList.toggle(
              "light-theme",
              theme === "light"
            );
          };
          const initTheme = () => {
            autoSetThemeByTime();
            if (themeCheckInterval) clearInterval(themeCheckInterval);
            themeCheckInterval = setInterval(autoSetThemeByTime, 60000);
          };
          onUnmounted(() => {
            if (themeCheckInterval) clearInterval(themeCheckInterval);
          });
          return { currentTheme, setTheme, initTheme };
        };
        const useScroll = () => {
          const isScrolling = ref(false),
            scrollProgress = ref(0),
            isHeaderVisible = ref(false),
            isHeaderExpanded = ref(false),
            lastScrollY = ref(0);
          let scrollTimeout = null;
          const handleScroll = () => {
            const scrollTop = window.scrollY,
              docHeight =
                document.documentElement.scrollHeight - window.innerHeight;
            scrollProgress.value = docHeight > 0 ? scrollTop / docHeight : 0;
            isScrolling.value = true;
            if (scrollTimeout) clearTimeout(scrollTimeout);
            scrollTimeout = setTimeout(() => {
              isScrolling.value = false;
            }, 1500);
            isHeaderVisible.value = scrollTop > 100;
            isHeaderExpanded.value =
              scrollTop > lastScrollY.value && scrollTop > 100;
            lastScrollY.value = scrollTop <= 0 ? 0 : scrollTop;
          };
          return {
            isScrolling,
            scrollProgress,
            isHeaderVisible,
            isHeaderExpanded,
            handleScroll,
          };
        };
        const useHeroTypewriter = () => {
          const heroLine1 = ref(""),
            heroLine2 = ref(""),
            heroLine3 = ref(""),
            heroLine4 = ref("");
          const heroLine1Active = ref(false),
            heroLine2Active = ref(false),
            heroLine3Active = ref(false),
            heroLine4Active = ref(false);
          const showHeroButtons = ref(false);
          function typeLine(targetRef, text, speed = 120) {
            return new Promise((resolve) => {
              let i = 0;
              targetRef.value = "";
              const interval = setInterval(() => {
                if (i < text.length) targetRef.value += text[i++];
                else {
                  clearInterval(interval);
                  resolve();
                }
              }, speed);
            });
          }
          async function start() {
            const lines = [
              { ref: heroLine1, text: "Hi! ", activeRef: heroLine1Active },
              { ref: heroLine2, text: "I'm 虚宁", activeRef: heroLine2Active },
              {
                ref: heroLine3,
                text: "A Developer",
                activeRef: heroLine3Active,
              },
              {
                ref: heroLine4,
                text: "For Anything!",
                activeRef: heroLine4Active,
              },
            ];
            for (const line of lines) {
              line.activeRef.value = true;
              await typeLine(line.ref, line.text);
              line.activeRef.value = false;
              if (line.ref === heroLine1) heroLine1Active.value = true;
            }
            showHeroButtons.value = true;
          }
          return {
            heroLine1,
            heroLine2,
            heroLine3,
            heroLine4,
            heroLine1Active,
            heroLine2Active,
            heroLine3Active,
            heroLine4Active,
            showHeroButtons,
            start,
          };
        };
        const useMusicPlayer = () => {
          const player = ref({
            aplayer: null,
            playlist: [],
            isInitialized: false,
            isLoading: false,
            isPlaying: false,
            isPlaylistVisible: false,
            isSongSwitcherVisible: false,
            currentSong: {},
            progress: 0,
            volume: 0.7,
            error: null,
            isShuffle: false,
            playbackRate: 1.0,
          });
          const lrcContainer = ref(null);
          const originalPlaylist = ref([]);

          const lrcAnimation = {
            rafId: null,
            currentY: 0,
            targetY: 0,
            isRunning: false,
          };

          const smoothScrollLrc = () => {
            if (!lrcAnimation.isRunning) {
              lrcAnimation.rafId = null;
              return;
            }

            const lrcContents = lrcContainer.value?.querySelector(
              ".aplayer-lrc-contents"
            );
            if (lrcContents) {
              const diff = lrcAnimation.targetY - lrcAnimation.currentY;
              if (Math.abs(diff) > 0.1) {
                lrcAnimation.currentY += diff * 0.1;
              } else {
                lrcAnimation.currentY = lrcAnimation.targetY;
              }
              lrcContents.style.transform = `translateY(-${lrcAnimation.currentY}px)`;
            }

            lrcAnimation.rafId = requestAnimationFrame(smoothScrollLrc);
          };

          const switchPlaylist = async (playlistSource) => {
            if (player.value.isLoading) return;
            player.value.isLoading = true;
            player.value.error = null;
            try {
              let audioList;
              if (typeof playlistSource === "string") {
                audioList = await apiService.getMusicPlaylist(playlistSource);
              } else if (Array.isArray(playlistSource)) {
                audioList = playlistSource;
              } else {
                throw new Error("无效的播放列表源。");
              }
              if (!Array.isArray(audioList) || audioList.length === 0) {
                console.error("API响应无效或播放列表为空:", audioList);
                throw new Error("播放列表为空或加载失败。");
              }
              originalPlaylist.value = [...audioList];
              player.value.isShuffle = false;

              if (!player.value.aplayer) {
                await nextTick();
                const ap = new APlayer({
                  container: document.getElementById("player-hidden"),
                  audio: audioList,
                  lrcType: 3,
                  loop: "all",
                });
                player.value.aplayer = ap;
                player.value.isInitialized = true;

                if (!lrcAnimation.isRunning) {
                  lrcAnimation.isRunning = true;
                  smoothScrollLrc();
                }

                ap.on("play", () => (player.value.isPlaying = true));
                ap.on("pause", () => (player.value.isPlaying = false));
                ap.on(
                  "volumechange",
                  () => (player.value.volume = ap.audio.volume)
                );
                ap.on("timeupdate", () => {
                  player.value.progress = ap.audio.duration
                    ? (ap.audio.currentTime / ap.audio.duration) * 100
                    : 0;
                  const lrcContainerEl = lrcContainer.value;
                  if (lrcContainerEl) {
                    const currentLrc = lrcContainerEl.querySelector(
                      ".aplayer-lrc-current"
                    );
                    if (currentLrc) {
                      const containerHeight = lrcContainerEl.offsetHeight;
                      lrcAnimation.targetY =
                        currentLrc.offsetTop -
                        containerHeight / 2 +
                        currentLrc.offsetHeight / 2;
                    }
                  }
                });
                ap.on("listswitch", (data) => {
                  player.value.currentSong = player.value.playlist[data.index];
                  lrcAnimation.currentY = 0;
                  lrcAnimation.targetY = 0;
                  moveLrcElement();
                });
              } else {
                lrcAnimation.currentY = 0;
                lrcAnimation.targetY = 0;
                player.value.aplayer.list.clear();
                player.value.aplayer.list.add(audioList);
                player.value.aplayer.list.switch(0);
              }
              player.value.playlist = audioList;
              player.value.currentSong = audioList[0];
              player.value.aplayer.volume(player.value.volume, true);
              player.value.aplayer.audio.playbackRate =
                player.value.playbackRate;
              player.value.aplayer.play();
              moveLrcElement();
            } catch (error) {
              console.error("音乐播放器操作失败:", error);
              player.value.error = "音乐加载失败，请刷新或切换歌单。";
              lrcAnimation.isRunning = false;
              if (lrcAnimation.rafId) cancelAnimationFrame(lrcAnimation.rafId);
              if (player.value.aplayer) {
                player.value.aplayer.destroy();
                player.value.aplayer = null;
                player.value.isInitialized = false;
              }
            } finally {
              player.value.isLoading = false;
            }
          };
          const moveLrcElement = () =>
            nextTick(() => {
              const lrc = document.querySelector("#player-hidden .aplayer-lrc");
              if (lrc && lrcContainer.value) {
                lrcContainer.value.innerHTML = "";
                lrcContainer.value.appendChild(lrc);
              }
            });
          const toggleShuffle = () => {
            const ap = player.value.aplayer;
            if (!ap || originalPlaylist.value.length <= 1) return;
            player.value.isShuffle = !player.value.isShuffle;
            const currentAudio = ap.list.audios[ap.list.index];
            const wasPlaying = player.value.isPlaying;
            let newPlaylist;
            if (player.value.isShuffle) {
              const others = originalPlaylist.value.filter(
                (s) => s.url !== currentAudio.url
              );
              for (let i = others.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [others[i], others[j]] = [others[j], others[i]];
              }
              newPlaylist = [currentAudio, ...others];
            } else {
              newPlaylist = [...originalPlaylist.value];
            }
            player.value.playlist = newPlaylist;
            ap.list.clear();
            ap.list.add(newPlaylist);
            ap.list.switch(
              newPlaylist.findIndex((s) => s.url === currentAudio.url)
            );
            if (wasPlaying) ap.play();
            else ap.pause();
          };
          const cyclePlaybackRate = () => {
            if (!player.value.aplayer) return;
            const rates = [1.0, 1.25, 1.5, 2.0, 0.5, 0.75];
            const nextIndex =
              (rates.indexOf(player.value.playbackRate) + 1) % rates.length;
            player.value.playbackRate = rates[nextIndex];
            player.value.aplayer.audio.playbackRate = rates[nextIndex];
          };
          const seek = (e) => {
            const p = e.currentTarget;
            player.value.aplayer.seek(
              player.value.aplayer.audio.duration *
                ((e.clientX - p.getBoundingClientRect().left) / p.offsetWidth)
            );
          };
          const setVolume = (e) => {
            const vol = parseFloat(e.target.value);
            player.value.volume = vol;
            player.value.aplayer.volume(vol, true);
            e.target.style.setProperty("--volume-percent", `${vol * 100}%`);
          };

          onUnmounted(() => {
            lrcAnimation.isRunning = false;
            if (lrcAnimation.rafId) {
              cancelAnimationFrame(lrcAnimation.rafId);
            }
          });

          return {
            player,
            lrcContainer,
            switchPlaylist,
            seek,
            setVolume,
            togglePlaylist: () =>
              (player.value.isPlaylistVisible =
                !player.value.isPlaylistVisible),
            toggleSonglistSwitcher: () =>
              (player.value.isSongSwitcherVisible =
                !player.value.isSongSwitcherVisible),
            toggleShuffle,
            cyclePlaybackRate,
          };
        };
        const useChatbot = (utils) => {
          const chatbot = ref({
            apiKey: "",
            temperature: 1.3,
            use_deep_thinking: false,
            status: "",
            currentMessage: "",
            isLoading: false,
          });
          const chatHistories = ref([]),
            activeChatId = ref(null),
            isHistoryDropdownOpen = ref(false),
            dropdownRef = ref(null),
            chatWindow = ref(null);
          const activeChat = computed(() =>
            chatHistories.value.find((c) => c.id === activeChatId.value)
          );
          const sendMessage = async () => {
            const messageText = chatbot.value.currentMessage.trim();
            if (
              !messageText ||
              chatbot.value.isLoading ||
              !chatbot.value.apiKey
            )
              return;
            chatbot.value.isLoading = true;
            chatbot.value.status = "正在准备请求...";
            activeChat.value.messages.push({
              id: `user-${Date.now()}`,
              role: "user",
              content: messageText,
            });
            if (activeChat.value.messages.length === 2)
              activeChat.value.title =
                messageText.substring(0, 30) +
                (messageText.length > 30 ? "..." : "");
            chatbot.value.currentMessage = "";
            const assistantMsg = {
              id: `assistant-${Date.now()}`,
              role: "assistant",
              content: "",
              thinking: "",
              isThinkingVisible: false,
            };
            activeChat.value.messages.push(assistantMsg);
            await nextTick();
            if (chatWindow.value)
              chatWindow.value.scrollTop = chatWindow.value.scrollHeight;
            const messagesForApi = activeChat.value.messages
              .slice(0, -1)
              .map(({ role, content }) => ({ role, content }));
            try {
              chatbot.value.status = "正在与 DeepSeek 通信...";
              const payload = {
                messages: messagesForApi,
                stream: true,
                model: chatbot.value.use_deep_thinking
                  ? "deepseek-reasoner"
                  : "deepseek-chat",
                max_tokens: chatbot.value.use_deep_thinking ? 65536 : 8192,
              };
              if (!chatbot.value.use_deep_thinking)
                payload.temperature = parseFloat(chatbot.value.temperature);
              const response = await fetch(
                "https://api.deepseek.com/chat/completions",
                {
                  method: "POST",
                  headers: {
                    "Content-Type": "application/json",
                    Authorization: `Bearer ${chatbot.value.apiKey}`,
                  },
                  body: JSON.stringify(payload),
                }
              );
              if (!response.ok) {
                const err = await response.json();
                throw new Error(
                  err.error?.message || `API 请求失败: ${response.status}`
                );
              }
              const reader = response.body.getReader(),
                decoder = new TextDecoder();
              let buffer = "";
              while (true) {
                const { value, done } = await reader.read();
                if (done) break;
                buffer += decoder.decode(value, { stream: true });
                const lines = buffer.split("\n");
                buffer = lines.pop();
                for (const line of lines) {
                  if (line.startsWith("data: ")) {
                    const jsonStr = line.substring(6);
                    if (jsonStr === "[DONE]") break;
                    try {
                      const chunk = JSON.parse(jsonStr),
                        delta = chunk.choices[0]?.delta;
                      if (delta) {
                        if (delta.reasoning_content)
                          assistantMsg.thinking += delta.reasoning_content;
                        if (delta.content)
                          assistantMsg.content += delta.content;
                      }
                    } catch (e) {
                      console.error("解析流JSON错误:", e, jsonStr);
                    }
                  }
                }
              }
            } catch (error) {
              assistantMsg.content = `**错误:** ${error.message}`;
            } finally {
              chatbot.value.isLoading = false;
              chatbot.value.status = "";
            }
          };
          const saveChats = () => {
            localStorage.setItem(
              "deepseek_chat_histories_v2",
              JSON.stringify(chatHistories.value)
            );
            localStorage.setItem(
              "deepseek_active_chat_id_v2",
              activeChatId.value
            );
          };
          const loadChats = () => {
            const saved = localStorage.getItem("deepseek_chat_histories_v2"),
              savedId = localStorage.getItem("deepseek_active_chat_id_v2");
            if (saved) {
              chatHistories.value = JSON.parse(saved);
              activeChatId.value = savedId
                ? parseInt(savedId)
                : chatHistories.value[0]?.id || null;
            }
            if (chatHistories.value.length === 0) createNewChat();
          };
          const createNewChat = () => {
            const newChat = {
              id: Date.now(),
              title: "新的对话",
              messages: [
                {
                  id: "initial-message",
                  role: "assistant",
                  content: "你好！有什么可以帮助你的吗？",
                },
              ],
            };
            chatHistories.value.push(newChat);
            activeChatId.value = newChat.id;
          };
          const deleteActiveChat = () => {
            if (!activeChat.value) return;
            const idx = chatHistories.value.findIndex(
              (c) => c.id === activeChatId.value
            );
            if (chatHistories.value.length <= 1) {
              createNewChat();
              chatHistories.value.splice(0, 1);
              return;
            }
            chatHistories.value.splice(idx, 1);
            activeChatId.value = chatHistories.value[idx > 0 ? idx - 1 : 0].id;
          };
          const selectChat = (id) => {
            activeChatId.value = id;
            isHistoryDropdownOpen.value = false;
          };
          const handleClickOutside = (e) => {
            if (dropdownRef.value && !dropdownRef.value.contains(e.target))
              isHistoryDropdownOpen.value = false;
          };
          watch(chatHistories, saveChats, { deep: true });
          watch(activeChatId, saveChats);
          watch(
            () => chatbot.value.apiKey,
            (key) => localStorage.setItem("deepseek_api_key", key)
          );
          watch(
            () => activeChat.value?.messages,
            () =>
              utils.triggerMathRendering(
                ".message:last-child .message-content"
              ),
            { deep: true }
          );
          return {
            chatbot,
            chatWindow,
            dropdownRef,
            chatHistories,
            activeChatId,
            activeChat,
            isHistoryDropdownOpen,
            sendMessage,
            createNewChat,
            deleteActiveChat,
            selectChat,
            loadChats,
            handleClickOutside,
          };
        };
        const useDataService = (utils) => {
          const aboutContent = ref("加载中..."),
            resumeData = ref({}),
            resumesList = ref([]),
            activeResumeId = ref(null),
            interests = ref([]),
            timeline = ref([]),
            targets = ref([]),
            bookshelf = ref([]),
            blogPosts = ref([]),
            footerIconLinks = ref([]),
            localPlaylistsManifest = ref([]);
          const loadResumeContent = async (path) => {
            if (!path) return;
            // 开始加载时清空当前数据，以显示“加载中”状态
            const resumeContent = await dataLoaderService.fetchJSON(path);
            resumeData.value = resumeContent || { name: "简历加载失败" };
          };
          const loadedLocalPlaylists = ref({});
          const loadAllData = async () => {
            const [
              aboutMd,
              resumeManifest,
              interestsData,
              growth,
              books,
              blogManifest,
              footerLinks,
              localManifest,
            ] = await Promise.all([
              dataLoaderService.fetchMarkdown(config.contentPaths.about),
              dataLoaderService.fetchJSON(config.contentPaths.resumeManifest),
              dataLoaderService.fetchJSON(config.contentPaths.interests),
              dataLoaderService.fetchJSON(config.contentPaths.growth),
              dataLoaderService.fetchJSON(config.contentPaths.bookshelf),
              dataLoaderService.fetchJSON(config.contentPaths.blogManifest),
              dataLoaderService.fetchJSON(config.contentPaths.footerLinks),
              dataLoaderService.fetchJSON(
                config.contentPaths.localPlaylistsManifest
              ),
            ]);
            aboutContent.value = utils.renderMarkdown(aboutMd || "");
            if (resumeManifest && resumeManifest.length > 0) {
              resumesList.value = resumeManifest;
              activeResumeId.value = resumeManifest[0].id; // 默认选中第一个
              await loadResumeContent(resumeManifest[0].location); // 加载默认简历
            } else {
              resumeData.value = { name: "未找到简历清单" };
            }
            interests.value = interestsData || [];
            if (growth) {
              timeline.value = growth.timeline;
              targets.value = growth.targets;
            }
            bookshelf.value = books || [];
            blogPosts.value = blogManifest || [];
            footerIconLinks.value = footerLinks || [];
            localPlaylistsManifest.value = localManifest || [];
          };
          return {
            aboutContent,
            resumeData,
            resumesList,
            activeResumeId,
            loadResumeContent,
            interests,
            timeline,
            targets,
            bookshelf,
            blogPosts,
            footerIconLinks,
            localPlaylistsManifest,
            loadedLocalPlaylists,
            loadAllData,
          };
        };
        const useGuestbook = () => {
          const guestbook = ref({
            isReady: false,
            error: null,
            isSubmitting: false,
            newName: "",
            newMessage: "",
            messages: [],
            isExpanded: false,
            status: { message: "", type: "" },
          });
          const activeDanmaku = ref([]);
          let danmakuQueue = [],
            pollInterval = null;
          let animationFrameId = null;
          let lastDanmakuTime = 0;
          const danmakuIntervalMs = 3000;
          const fetchMessages = async () => {
            try {
              const response = await fetch(config.guestbookApiUrl);
              if (!response.ok) {
                const errorData = await response.json();
                throw new Error(
                  errorData.error || `代理服务器响应错误: ${response.status}`
                );
              }
              const freshMessages = await response.json();
              guestbook.value.messages = freshMessages;
              danmakuQueue = [...freshMessages].reverse();
              guestbook.value.isReady = true;
            } catch (err) {
              console.error("获取弹幕失败:", err);
              guestbook.value.error = err.message || "无法加载弹幕。";
            }
          };
          const submitMessage = async () => {
            if (guestbook.value.isSubmitting) return;
            const name = guestbook.value.newName.trim(),
              message = guestbook.value.newMessage.trim();
            if (!name || !message) {
              guestbook.value.status = {
                message: "昵称和内容不能为空。",
                type: "error",
              };
              return;
            }
            guestbook.value.isSubmitting = true;
            guestbook.value.status = { message: "", type: "" };
            try {
              const response = await fetch(config.guestbookApiUrl, {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ name, message }),
              });
              if (!response.ok) {
                const errorData = await response.json();
                throw new Error(
                  errorData.error || `代理服务器提交错误: ${response.status}`
                );
              }
              const latestMessages = await response.json();
              guestbook.value.messages = latestMessages;
              danmakuQueue = [...latestMessages].reverse();
              guestbook.value.newName = "";
              guestbook.value.newMessage = "";
              guestbook.value.status = {
                message: "发射成功！",
                type: "success",
              };
              setTimeout(() => {
                guestbook.value.isExpanded = false;
                guestbook.value.status = { message: "", type: "" };
              }, 1500);
            } catch (e) {
              console.error("提交弹幕失败:", e);
              guestbook.value.status = {
                message: e.message || "发射失败，请稍后再试。",
                type: "error",
              };
            } finally {
              guestbook.value.isSubmitting = false;
            }
          };
          const danmakuLoop = (timestamp) => {
            if (!lastDanmakuTime) {
              lastDanmakuTime = timestamp;
            }
            const elapsed = timestamp - lastDanmakuTime;
            if (elapsed > danmakuIntervalMs) {
              lastDanmakuTime = timestamp;
              if (danmakuQueue.length > 0 && activeDanmaku.value.length <= 10) {
                const msg = danmakuQueue.shift();
                danmakuQueue.push(msg);
                const duration = Math.random() * 8 + 12;
                const danmaku = {
                  id: Date.now() + Math.random(),
                  name: msg.name,
                  message: msg.message,
                  style: {
                    top: `${Math.random() * 80 + 5}%`,
                    animationDuration: `${duration}s`,
                    color: `hsl(${Math.random() * 360}, 80%, 85%)`,
                  },
                };
                activeDanmaku.value.push(danmaku);
                setTimeout(() => {
                  const index = activeDanmaku.value.findIndex(
                    (d) => d.id === danmaku.id
                  );
                  if (index > -1) {
                    activeDanmaku.value.splice(index, 1);
                  }
                }, duration * 1000 + 100);
              }
            }
            animationFrameId = requestAnimationFrame(danmakuLoop);
          };
          const startDanmakuStream = () => {
            stopDanmakuStream();
            lastDanmakuTime = 0;
            animationFrameId = requestAnimationFrame(danmakuLoop);
          };
          const stopDanmakuStream = () => {
            if (animationFrameId) {
              cancelAnimationFrame(animationFrameId);
              animationFrameId = null;
            }
          };
          const handleVisibilityChange = () => {
            if (document.hidden) {
              stopDanmakuStream();
            } else {
              startDanmakuStream();
            }
          };
          const init = async () => {
            await fetchMessages();
            startDanmakuStream();
            document.addEventListener(
              "visibilitychange",
              handleVisibilityChange
            );
            if (pollInterval) clearInterval(pollInterval);
            pollInterval = setInterval(fetchMessages, 60000);
          };
          onUnmounted(() => {
            stopDanmakuStream();
            document.removeEventListener(
              "visibilitychange",
              handleVisibilityChange
            );
            if (pollInterval) clearInterval(pollInterval);
          });
          return { guestbook, activeDanmaku, init, submitMessage };
        };

        createApp({
          setup() {
            const utils = {
              renderMarkdown(content) {
                if (!window.marked)
                  return (content || "").replace(/\n/g, "<br>");
                const mathPlaceholders = [];
                let i = 0;
                const text = (content || "").replace(
                  /(\$\$[\s\S]*?\$\$|\$[^$]*?\$|\\\[[\s\S]*?\\\]|\\\(.*?\\\))/g,
                  (match) => {
                    const p = `<!--MATH_${i++}-->`;
                    mathPlaceholders.push(match);
                    return p;
                  }
                );
                let html = window.marked.parse(text, {
                  gfm: true,
                  breaks: true,
                });
                return html.replace(
                  /<!--MATH_(\d+)-->/g,
                  (m, idx) => mathPlaceholders[parseInt(idx)]
                );
              },
              triggerMathRendering(selector) {
                nextTick(() => {
                  if (window.renderMathInElement) {
                    const el = document.querySelector(selector);
                    if (el)
                      try {
                        window.renderMathInElement(el, {
                          delimiters: [
                            { left: "$$", right: "$$", display: true },
                            { left: "$", right: "$", display: false },
                            { left: "\\[", right: "\\]", display: true },
                          ],
                          throwOnError: false,
                        });
                      } catch (e) {
                        console.error("KaTeX渲染错误", e);
                      }
                  }
                });
              },
              handleImgError(event) {
                event.target.src =
                  "https://placehold.co/400x600/1a1a1a/ffffff?text=Image+Failed";
              },
            };
            const {
              guestbook,
              activeDanmaku,
              init: initGuestbook,
              submitMessage: submitGuestbookMessage,
            } = useGuestbook();
            const toggleGuestbookExpanded = () => {
              guestbook.value.isExpanded = !guestbook.value.isExpanded;
            };
            const { currentTheme, setTheme, initTheme } = useTheme();
            const {
              isScrolling,
              scrollProgress,
              isHeaderVisible,
              isHeaderExpanded,
              handleScroll,
            } = useScroll();
            const hero = useHeroTypewriter();
            const music = useMusicPlayer();
            const chatbot = useChatbot(utils);
            const data = useDataService(utils);
            const switchResume = async (resume) => {
              if (resume.id === data.activeResumeId.value) return;
              data.activeResumeId.value = resume.id;
              data.resumeData.value = {};
              await data.loadResumeContent(resume.location);
            };
            const isLoginModalVisible = ref(false),
              isBookModalVisible = ref(false),
              selectedBook = ref(null);
            const github = ref({
              repos: [],
              pinnedRepos: [],
              events: [],
              page: 1,
              canLoadMore: true,
              isLoading: true,
              isLoadingMore: false,
              sortKey: "pushed_at",
              filterLanguage: "",
              stats: { stars: 0, forks: 0, repos: 0, contributions: 0 },
              error: null,
              spaceUrl: config.github.spaceUrl,
            });

            const siteUptime = ref(""),
              icp = ref(config.icpNumber),
              username = ref(""),
              password = ref(""),
              loginStatus = ref({ message: "", type: "" }),
              isLoggingIn = ref(false),
              activeSection = ref("hero"),
              activeJourneyPanel = ref(null),
              openInterestId = ref(null),
              activePostId = ref(null),
              activeCategory = ref("全部分类"),
              lastFocusedElement = ref(null),
              activePanelRef = ref(null);
            const interestMarkdownContent = ref(""),
              creationsTabActive = ref("github"),
              bookshelf = ref({ activeCategory: "全部" });

            const copyrightYear = computed(() => {
              const startYear = 2022;
              const currentYear = new Date().getFullYear();
              if (currentYear > startYear) {
                return `${startYear}-${currentYear}`;
              } else {
                return startYear;
              }
            });

            const filteredAndSortedRepos = computed(() => {
              if (!github.value.repos) return [];
              const pinnedNames = github.value.pinnedRepos.map((p) => p.repo);
              let normalRepos = github.value.repos.filter(
                (repo) => !pinnedNames.includes(repo.name)
              );
              if (github.value.filterLanguage) {
                normalRepos = normalRepos.filter((repo) =>
                  (repo.language || "")
                    .toLowerCase()
                    .includes(github.value.filterLanguage.toLowerCase())
                );
              }
              const key = github.value.sortKey;
              return normalRepos.sort((a, b) => {
                return key === "pushed_at"
                  ? new Date(b[key]) - new Date(a[key])
                  : b[key] - a[key];
              });
            });
            const bookCategories = computed(() => [
              "全部",
              ...new Set(data.bookshelf.value.map((b) => b.category)),
            ]);
            const filteredBooks = computed(() =>
              bookshelf.value.activeCategory === "全部"
                ? data.bookshelf.value
                : data.bookshelf.value.filter(
                    (b) => b.category === bookshelf.value.activeCategory
                  )
            );
            const activityStream = computed(() => {
              const bookActivities = data.bookshelf.value.flatMap((book) => {
                const activities = [];
                if (book.startDate)
                  activities.push({
                    date: book.startDate,
                    type: "book",
                    content: `开始阅读 <strong>${book.title}</strong>`,
                  });
                if (book.finishDate)
                  activities.push({
                    date: book.finishDate,
                    type: "book",
                    content: `读完了 <strong>${book.title}</strong>`,
                  });
                return activities;
              });
              const githubActivities = (github.value.events || [])
                .filter((e) => e.type === "PushEvent")
                .map((e) => ({
                  date: e.created_at.split("T")[0],
                  type: "github",
                  content: `向 <strong>${e.repo.name}</strong> 推送了 ${e.payload.commits.length} 个提交`,
                }));
              return [...bookActivities, ...githubActivities].sort(
                (a, b) => new Date(b.date) - new Date(a.date)
              );
            });
            const activePost = computed(() =>
              data.blogPosts.value.find((p) => p.id === activePostId.value)
            );
            const blogCategories = computed(() => [
              "全部分类",
              ...new Set(data.blogPosts.value.map((p) => p.category)),
            ]);
            const filteredBlogPosts = computed(() =>
              activeCategory.value === "全部分类"
                ? data.blogPosts.value
                : data.blogPosts.value.filter(
                    (p) => p.category === activeCategory.value
                  )
            );
            const hubNodes = ref([
              {
                id: "resume",
                icon: "ph-fill ph-user-list",
                title: "我的简历",
                text: "教育背景、项目经验与专业技能",
              },
              {
                id: "creations",
                icon: "ph-fill ph-brain",
                title: "创造与知识",
                text: "代码仓库、阅读书单与个人成长动态",
              },
              {
                id: "blog",
                icon: "ph-fill ph-pencil-line",
                title: "我的文章",
                text: "思考、分享与技术沉淀",
              },
              {
                id: "interests",
                icon: "ph-fill ph-game-controller",
                title: "个人兴趣",
                text: "探索我工作之外的热情所在",
              },
              {
                id: "chatbot",
                icon: "ph-fill ph-robot",
                title: "AI 助手",
                text: "与我的智能助手进行对话",
              },
            ]);
            const allNavLinks = ref([
              { id: "hub", text: "主页", priority: 1 },
              { id: "resume", text: "简历", priority: 2 },
              { id: "creations", text: "创造", priority: 3 },
              { id: "blog", text: "文章", priority: 4 },
              { id: "interests", text: "兴趣", priority: 6 },
              { id: "chatbot", text: "AI", priority: 7 },
              { id: "footer", text: "更多", priority: 99 },
            ]);
            const windowWidth = ref(window.innerWidth);
            const visibleNavLinks = computed(() => {
              const w = windowWidth.value,
                c =
                  w > 1024
                    ? 7
                    : w > 900
                    ? 6
                    : w > 768
                    ? 5
                    : w > 640
                    ? 4
                    : w > 500
                    ? 3
                    : 2,
                s = [...allNavLinks.value].sort(
                  (a, b) => a.priority - b.priority
                );
              if (c >= allNavLinks.value.length) return s;
              const v = s.slice(0, c - 1),
                m = allNavLinks.value.find((l) => l.id === "footer");
              if (m && !v.some((l) => l.id === "footer")) v.push(m);
              return v;
            });
            const activeInterest = computed(() => {
              if (!openInterestId.value || !data.interests.value) return null;
              return data.interests.value.find(
                (i) => i.id === openInterestId.value
              );
            });

            const toggleLoginModal = () => {
              isLoginModalVisible.value = !isLoginModalVisible.value;
              loginStatus.value = { message: "", type: "" };
            };
            const handleLogin = () => {
              if (isLoggingIn.value) return;
              isLoggingIn.value = true;
              loginStatus.value = { message: "登录中...", type: "" };
              setTimeout(() => {
                if (
                  username.value === "admin" &&
                  password.value === "password"
                ) {
                  loginStatus.value = { message: "登录成功!", type: "success" };
                  setTimeout(() => {
                    toggleLoginModal();
                    username.value = "";
                    password.value = "";
                  }, 1000);
                } else {
                  loginStatus.value = {
                    message: "用户名或密码错误。",
                    type: "error",
                  };
                }
                isLoggingIn.value = false;
              }, 1500);
            };
            const onBeforeEnter = (el) => {
              el.style.opacity = 0;
              el.style.transform = "translateY(30px)";
            };
            const onEnter = (el, done) => {
              const delay = (el.dataset.index || 0) * 100;
              setTimeout(() => {
                el.style.transition = "opacity 0.6s ease, transform 0.6s ease";
                el.style.opacity = 1;
                el.style.transform = "translateY(0)";
                el.addEventListener("transitionend", done, { once: true });
              }, delay);
            };
            const openJourneyPanel = (panelId) => {
              if (activeJourneyPanel.value === panelId) return;
              lastFocusedElement.value = document.activeElement;
              activeJourneyPanel.value = panelId;
              activeSection.value = panelId;
              nextTick(() => {
                const el = document.getElementById("interactive-journey");
                if (el)
                  window.scrollTo({
                    top:
                      el.getBoundingClientRect().top + window.pageYOffset - 80,
                    behavior: "smooth",
                  });
                setTimeout(() => {
                  const newPanel = activePanelRef.value;
                  if (newPanel) {
                    const focusable = newPanel.querySelector(
                      'button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'
                    );
                    if (focusable) focusable.focus();
                    else newPanel.focus();
                  }
                }, 400);
              });
            };
            const closeJourneyPanel = () => {
              document
                .getElementById("interactive-journey")
                ?.scrollIntoView({ behavior: "smooth", block: "center" });
              activeJourneyPanel.value = null;
              activeSection.value = "hub";
              if (lastFocusedElement.value) {
                lastFocusedElement.value.focus();
              }
            };
            const handleNavClick = (id) => {
              if (id === "hub" || id === "footer") {
                closeJourneyPanel();
                document
                  .getElementById(
                    id === "hub" ? "interactive-journey" : "footer"
                  )
                  ?.scrollIntoView({ behavior: "smooth" });
              } else {
                openJourneyPanel(id);
              }
            };
            const currentSongId = ref(null),
              newSongIdInput = ref(""),
              newSongNameInput = ref("");
            const presetSonglists = ref([]),
              customSonglists = ref([]);
            const playFromLocalFolder = async () => {
              if (!("showDirectoryPicker" in window)) {
                alert(
                  "您的浏览器不支持此功能，请使用最新版的 Chrome 或 Edge 浏览器。"
                );
                return;
              }
              try {
                const dirHandle = await window.showDirectoryPicker();
                const audioFiles = [];
                const supportedTypes = [
                  ".mp3",
                  ".flac",
                  ".wav",
                  ".ogg",
                  ".m4a",
                ];
                for await (const entry of dirHandle.values()) {
                  if (
                    entry.kind === "file" &&
                    supportedTypes.some((ext) =>
                      entry.name.toLowerCase().endsWith(ext)
                    )
                  ) {
                    const file = await entry.getFile();
                    audioFiles.push({
                      name: file.name.replace(/\.[^/.]+$/, ""),
                      artist: "本地文件",
                      url: URL.createObjectURL(file),
                      cover: "./content/icon/128.png",
                    });
                  }
                }
                if (audioFiles.length === 0) {
                  alert("选择的文件夹中没有找到支持的音乐文件。");
                  return;
                }
                if (
                  music.player.value.playlist &&
                  currentSongId.value === "local_folder"
                ) {
                  music.player.value.playlist.forEach((song) => {
                    if (song.url.startsWith("blob:")) {
                      URL.revokeObjectURL(song.url);
                    }
                  });
                }
                currentSongId.value = "local_folder";
                await music.switchPlaylist(audioFiles);
              } catch (err) {
                if (err.name !== "AbortError") {
                  console.error("播放本地文件夹时出错:", err);
                  alert("无法读取文件夹。");
                }
              }
            };
            const switchSonglist = async (id) => {
              if (music.player.value.isLoading || !id) return;
              if (id === "local_folder_picker") {
                await playFromLocalFolder();
                return;
              }
              if (
                !id.startsWith("local_") &&
                id === currentSongId.value &&
                music.player.value.isInitialized
              )
                return;
              currentSongId.value = id;
              if (id.startsWith("local_")) {
                let playlistData = data.loadedLocalPlaylists.value[id];
                if (!playlistData) {
                  const playlistInfo = data.localPlaylistsManifest.value.find(
                    (p) => p.id === id
                  );
                  if (playlistInfo) {
                    playlistData = await dataLoaderService.fetchJSON(
                      playlistInfo.file
                    );
                    if (playlistData) {
                      data.loadedLocalPlaylists.value[id] = playlistData;
                    }
                  }
                }
                await music.switchPlaylist(playlistData || []);
              } else {
                await music.switchPlaylist(id);
              }
            };
            const addAndSwitchSonglist = () => {
              const newId = newSongIdInput.value.trim();
              if (!newId || !/^\d+$/.test(newId)) {
                alert("请输入纯数字的歌单ID。");
                return;
              }
              const newName = newSongNameInput.value.trim() || `歌单 ${newId}`;
              if (!customSonglists.value.some((l) => l.id === newId)) {
                customSonglists.value.unshift({ id: newId, name: newName });
                localStorage.setItem(
                  "custom_songlists_v2",
                  JSON.stringify(customSonglists.value)
                );
              }
              newSongIdInput.value = "";
              newSongNameInput.value = "";
              switchSonglist(newId);
            };
            const removeCustomSonglist = (id) => {
              customSonglists.value = customSonglists.value.filter(
                (l) => l.id !== id
              );
              localStorage.setItem(
                "custom_songlists_v2",
                JSON.stringify(customSonglists.value)
              );
            };
            const loadCustomSonglists = () => {
              const saved = localStorage.getItem("custom_songlists_v2");
              if (saved) customSonglists.value = JSON.parse(saved);
            };

            const animatedTargetValues = ref({});
            const useGrowthAnimations = (data, panelRef) => {
              let animationFrameId = null;

              const animateValue = (start, end, duration, onUpdate) => {
                let startTime = null;
                const step = (timestamp) => {
                  if (!startTime) startTime = timestamp;
                  const progress = Math.min(
                    (timestamp - startTime) / duration,
                    1
                  );
                  const currentValue = Math.floor(
                    start + (end - start) * progress
                  );
                  onUpdate(currentValue);
                  if (progress < 1) {
                    animationFrameId = requestAnimationFrame(step);
                  }
                };
                animationFrameId = requestAnimationFrame(step);
              };

              const trigger = () => {
                const panel = panelRef.value;
                if (!panel) return;

                if (animationFrameId) {
                  cancelAnimationFrame(animationFrameId);
                }

                // 1. Reset styles INSTANTLY
                const timeline = panel.querySelector(".timeline");
                const timelineItems = panel.querySelectorAll(".timeline-item");
                const progressBars = panel.querySelectorAll(".progress-bar");

                timeline?.classList.remove("is-visible");
                timelineItems.forEach((item) =>
                  item.classList.remove("is-visible")
                );

                data.targets.value.forEach((_, index) => {
                  animatedTargetValues.value[index] = 0;
                });

                progressBars.forEach((bar) => {
                  bar.style.transition = "none";
                  bar.style.width = "0%";
                });

                // 2. Force repaint and then start animations
                requestAnimationFrame(() => {
                  requestAnimationFrame(() => {
                    if (!panelRef.value) return; // Guard against component unmount

                    timeline?.classList.add("is-visible");
                    timelineItems.forEach((item, index) => {
                      setTimeout(
                        () => item.classList.add("is-visible"),
                        index * 150 + 200
                      );
                    });

                    progressBars.forEach((bar, index) => {
                      bar.style.transition = "";
                      const target = data.targets.value[index];
                      if (target) {
                        bar.style.width = `${
                          (target.current / target.total) * 100
                        }%`;
                      }
                    });

                    data.targets.value.forEach((target, index) => {
                      setTimeout(() => {
                        animateValue(0, target.current, 1000, (val) => {
                          animatedTargetValues.value[index] = val;
                        });
                      }, 300);
                    });
                  });
                });
              };
              return { trigger };
            };

            const { trigger: triggerGrowthAnimations } = useGrowthAnimations(
              data,
              activePanelRef
            );

            const isTabTransitioning = ref(false);

            const onTabTransitionStart = () => {
              isTabTransitioning.value = true;
            };

            const onTabTransitionEnd = () => {
              isTabTransitioning.value = false;
              if (creationsTabActive.value === "growth") {
                triggerGrowthAnimations();
              }
            };
            const throttle = (func, limit) => {
              let inThrottle;
              return function (...args) {
                if (!inThrottle) {
                  func.apply(this, args);
                  inThrottle = true;
                  setTimeout(() => (inThrottle = false), limit);
                }
              };
            };
            const throttledScrollHandler = throttle(handleScroll, 100);
            const openBookModal = (book) => {
              selectedBook.value = book;
              isBookModalVisible.value = true;
            };
            const closeBookModal = () => {
              isBookModalVisible.value = false;
            };
            const loadMoreRepos = async () => {
              if (github.value.isLoadingMore) return;
              github.value.isLoadingMore = true;
              try {
                const newRepos = await apiService.getGithubData("repos", {
                  page: github.value.page + 1,
                  per_page: 30,
                });
                if (newRepos.length > 0) {
                  github.value.repos.push(...newRepos);
                  github.value.page++;
                } else {
                  github.value.canLoadMore = false;
                }
              } catch (e) {
                console.error("加载更多仓库失败:", e);
              } finally {
                github.value.isLoadingMore = false;
              }
            };

            const isGrowthTabVisible = computed(
              () =>
                activeJourneyPanel.value === "creations" &&
                creationsTabActive.value === "growth"
            );

            watch(isGrowthTabVisible, (isVisible) => {
              if (isVisible && !isTabTransitioning.value) {
                nextTick(() => {
                  triggerGrowthAnimations();
                });
              }
            });

            watch(activePostId, async (newId) => {
              if (newId === null) return;
              const post = data.blogPosts.value.find((p) => p.id === newId);
              if (post && !post.content) {
                post.content = await dataLoaderService.fetchMarkdown(
                  post.filePath
                );
              }
              utils.triggerMathRendering(".blog-post-body");
            });
            watch(activeInterest, async (newInterest) => {
              if (newInterest && newInterest.mdFilePath) {
                interestMarkdownContent.value = "加载中...";
                try {
                  const markdown = await dataLoaderService.fetchMarkdown(
                    newInterest.mdFilePath
                  );
                  interestMarkdownContent.value =
                    utils.renderMarkdown(markdown);
                  utils.triggerMathRendering(".interest-markdown-content");
                } catch (error) {
                  console.error(
                    `Failed to load interest content for ${newInterest.id}:`,
                    error
                  );
                  interestMarkdownContent.value = "<p>内容加载失败。</p>";
                }
              } else {
                interestMarkdownContent.value = "";
              }
            });

            onMounted(async () => {
              initTheme();
              loadCustomSonglists();
              initGuestbook();
              siteUptime.value = `${Math.ceil(
                Math.abs(new Date() - new Date(config.siteStartDate)) / 864e5
              )} 天`;
              chatbot.loadChats();
              await data.loadAllData();

              presetSonglists.value = [
                { id: "9206816111", name: "「 BGM 」净尘拂人心" },
                { id: "8886500589", name: "『纯音乐』美到窒息的旋律" },
                ...data.localPlaylistsManifest.value,
                { id: "local_folder_picker", name: "📂 从本地文件夹播放" },
              ];
              if (presetSonglists.value.length > 0) {
                currentSongId.value = presetSonglists.value[0].id;
              }
              if (data.blogPosts.value.length > 0)
                activePostId.value = data.blogPosts.value[0].id;
              if (data.interests.value.length > 0)
                openInterestId.value = data.interests.value[0].id;

              github.value.isLoading = true;
              const results = await Promise.allSettled([
                apiService.getGithubData("stats"),
                apiService.getGithubData("repos", { page: 1, per_page: 30 }),
                apiService.getGithubData("pinned"),
                apiService.getGithubData("events", { per_page: 30 }),
              ]);

              const [statsResult, reposResult, pinnedResult, eventsResult] =
                results;

              if (statsResult.status === "fulfilled") {
                const statsData = statsResult.value;
                github.value.stats.repos = statsData.publicRepos;
                github.value.stats.contributions = statsData.contributions;
              } else {
                console.error("获取 GitHub 统计信息失败:", statsResult.reason);
                github.value.error =
                  (github.value.error || "") + " 统计信息加载失败.";
              }

              if (reposResult.status === "fulfilled") {
                const reposData = reposResult.value;
                github.value.repos = reposData;
                github.value.canLoadMore = reposData.length === 30;
                github.value.stats.stars = reposData.reduce(
                  (acc, r) => acc + r.stargazers_count,
                  0
                );
                github.value.stats.forks = reposData.reduce(
                  (acc, r) => acc + r.forks_count,
                  0
                );
              } else {
                console.error("获取 GitHub 仓库列表失败:", reposResult.reason);
                github.value.error =
                  (github.value.error || "") + " 仓库列表加载失败.";
              }

              if (pinnedResult.status === "fulfilled") {
                github.value.pinnedRepos = pinnedResult.value;
              } else {
                console.error("获取 GitHub 置顶仓库失败:", pinnedResult.reason);
              }

              if (eventsResult.status === "fulfilled") {
                github.value.events = eventsResult.value;
              } else {
                console.error("获取 GitHub 动态失败:", eventsResult.reason);
              }

              github.value.isLoading = false;

              const loader = document.getElementById("loader-wrapper");

              if (loader) {
                loader.classList.add("is-hidden");
              }

              if (appElement) {
                setTimeout(() => {
                  if (loader) {
                    loader.style.display = "none";
                  }
                  appElement.style.visibility = "visible";
                  hero.start();
                }, 800);
              }

              const observer = new IntersectionObserver(
                (entries) => {
                  entries.forEach((entry) => {
                    if (entry.isIntersecting && !activeJourneyPanel.value)
                      activeSection.value =
                        entry.target.getAttribute("data-section");
                  });
                },
                { threshold: 0.1 }
              );
              document
                .querySelectorAll("[data-section]")
                .forEach((el) => observer.observe(el));
              const animObserver = new IntersectionObserver(
                (entries, obs) => {
                  entries.forEach((e) => {
                    if (e.isIntersecting) {
                      e.target.classList.add("is-visible");
                      obs.unobserve(e.target);
                    }
                  });
                },
                { threshold: 0.1 }
              );
              document
                .querySelectorAll(".anim-fade-in-up")
                .forEach((el) => animObserver.observe(el));
              document.addEventListener("click", chatbot.handleClickOutside);
              window.addEventListener(
                "resize",
                () => (windowWidth.value = window.innerWidth)
              );
              window.addEventListener("scroll", throttledScrollHandler);
              const savedApiKey = localStorage.getItem("deepseek_api_key");
              if (savedApiKey) chatbot.chatbot.value.apiKey = savedApiKey;
            });
            onUnmounted(() => {
              window.removeEventListener("scroll", throttledScrollHandler);
              window.removeEventListener(
                "resize",
                () => (windowWidth.value = window.innerWidth)
              );
              document.removeEventListener("click", chatbot.handleClickOutside);
              if (music.player.value.aplayer)
                music.player.value.aplayer.destroy();
            });

            return {
              ...utils,
              ...hero,
              ...data,
              ...chatbot,
              ...music,
              switchResume,
              guestbook,
              activeDanmaku,
              submitGuestbookMessage,
              toggleGuestbookExpanded,
              github,
              copyrightYear,
              icp,
              siteUptime,
              hubNodes,
              visibleNavLinks,
              currentTheme,
              isScrolling,
              scrollProgress,
              isHeaderVisible,
              isHeaderExpanded,
              isLoginModalVisible,
              username,
              password,
              loginStatus,
              isLoggingIn,
              activeSection,
              activeJourneyPanel,
              activePostId,
              activePost,
              activeCategory,
              blogCategories,
              filteredBlogPosts,
              openInterestId,
              currentSongId,
              presetSonglists,
              customSonglists,
              newSongIdInput,
              newSongNameInput,
              activePanelRef,
              animatedTargetValues,
              activeInterest,
              interestMarkdownContent,
              creationsTabActive,
              bookshelf,
              filteredAndSortedRepos,
              bookCategories,
              filteredBooks,
              activityStream,
              isBookModalVisible,
              selectedBook,
              openBookModal,
              closeBookModal,
              loadMoreRepos,
              setTheme,
              toggleLoginModal,
              handleLogin,
              onBeforeEnter,
              onEnter,
              openJourneyPanel,
              closeJourneyPanel,
              handleNavClick,
              switchSonglist,
              addAndSwitchSonglist,
              removeCustomSonglist,
              onTabTransitionEnd,
              onTabTransitionStart,
            };
          },
        }).mount("#app");
      });
    </script>
  </body>
</html>
